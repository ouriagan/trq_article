---
title: 'TRQ : structures factorielles'
author: "Louis De Page et Benjamin Thiry"
date: "2023-01-16"
output:
  pdf_document:
    toc: yes
    toc_depth: 3
    df_print: kable
  html_document:
    df_print: paged
    toc: yes
  word_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(psych)
library(Hmisc)
library(see)
library(GPArotation)
library(nFactors)
library(FactoMineR)
library(DiagrammeR)
library(factoextra)
library(parameters)
library(kableExtra)
library(ggplot2)
library(openxlsx)
library(corrplot)
library(haven)
library(readr)
authors <- read_delim("C:/Users/Ouriagan/OneDrive/TRQ_article/authors.csv", delim = ";", escape_double = FALSE, na = "empty", trim_ws = TRUE)
items <- read_sav("C:/Users/Ouriagan/OneDrive/TRQ_article/ct_14_12_2022.sav")
items.df <- data.frame(items)
# attach(ct_14_12_2022)
# items.df <- data.frame(trq1,trq2,trq3,trq4,trq5,trq6,trq7,trq8,trq9,trq10,trq11,trq12,trq13,trq14,trq15,trq16,trq17,trq18,trq19,trq20,trq21,trq22,trq23,trq24,trq25,trq26,trq27,trq28,trq29,trq30,trq31,trq32,trq33,trq34,trq35,trq36,trq37,trq38,trq39,trq40,trq41,trq42,trq43,trq44,trq45,trq46,trq47,trq48,trq49,trq50,trq51,trq52,trq53,trq54,trq55,trq56,trq57,trq58,trq59,trq60,trq61,trq62,trq63,trq64,trq65,trq66,trq67,trq68,trq69,trq70,trq71,trq72,trq73,trq74,trq75,trq76,trq77,trq78,trq79)
# detach(ct_14_12_2022)
itemscomplete.df <- items.df[complete.cases(items.df), ]
attach(items.df)


N <- length(trq1)

#Items mabels and the fonction to find them
labels_items <- label(items.df)
labels.df <- data.frame(Item=1:79, Label=labels_items)
find_label <- function(x) {
  label <- labels.df[labels.df$Item == x, "Label"]
  return(label)
}
```

# Nombre de facteurs dans la littérature précédente

```{r authors, paged.print=TRUE}
kable(authors)
```

# No rotation

N = `r N`

## Very Simple Structure

```{r}
vssmodelesfa <- vss(items.df, rotate = "none", use="pairwise")
```

Le Very Simple Structure criterion propose une solution à 3 voire 4 facteurs.


## Method Agreement Procedure

[n_factors](https://easystats.github.io/parameters/reference/n_factors.html) utilise 14 méthodes pour proposer la solution factorielle la plus fréquemment proposée :

```{r}
n_factors_none_results <- n_factors(items.df, type = "FA", rotation = "none")
plot(n_factors_none_results)
```


## 1 facteur

```{r}
facto1none <- fa(items.df, nfactors=1, rotate="none", use="pairwise")
# print(facto1none$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto1none)
facto1noneRMSEA <- round(facto1none$RMSEA[["RMSEA"]],2) 
facto1nonermsr <- round(facto1none$rms,2)
facto1noneTLI <- round(facto1none$TLI,2)
facto1_1none_variance <- round(facto1none[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1


# Distinguer les facteurs

facto1none_1 <- which(abs(facto1none$loadings[,1]) > .30)
facto1none_1.df <- data.frame(facto1none_1)
facto1none_1vect <- round(as.vector(facto1none$loadings[,1][facto1none_1]),2)
facto1none_1_labels <- apply(facto1none_1.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto1none_1table <- data.frame(Item=facto1none_1, Label=facto1none_1_labels, Loading=facto1none_1vect)
facto1none_1table_ord <- facto1none_1table[order(facto1none_1vect, decreasing = TRUE),]

# nombre d'items par facteurs
n1_none_1 <- length(facto1none_1)

# Créer les scores factoriels
scores1_none_1 <- facto1none$scores[,1]
```

Le RMSEA est égal à `r facto1noneRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto1nonermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto1noneTLI`.
Le premier facteur explique `r facto1_1none_variance` %.
Le premier facteur compte `r n1_none_1` items.

### Facteur 1 : negative emotions

```{r}
facto1none_1table_ord
```


## 2 facteurs

```{r}
facto2none <- fa(items.df, nfactors=2, rotate="none", use="pairwise")
# print(facto2none$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto2none)
facto2noneRMSEA <- round(facto2none$RMSEA[["RMSEA"]],2) 
facto2nonermsr <- round(facto2none$rms,2)
facto2noneTLI <- round(facto2none$TLI,2)
facto2_1none_variance <- round(facto2none[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto2_2none_variance <- round(facto2none[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto2none_variancecum <- facto2_1none_variance+facto2_2none_variance

# Distinguer les facteurs

facto2none_1 <- which(abs(facto2none$loadings[,1]) > .30)
facto2none_2 <- which(abs(facto2none$loadings[,2]) > .30)
facto2none_1.df <- data.frame(facto2none_1)
facto2none_2.df <- data.frame(facto2none_2)
facto2none_1vect <- round(as.vector(facto2none$loadings[,1][facto2none_1]),2)
facto2none_2vect <- round(as.vector(facto2none$loadings[,2][facto2none_2]),2)
facto2none_1_labels <- apply(facto2none_1.df, 1, find_label)
facto2none_2_labels <- apply(facto2none_2.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto2none_1table <- data.frame(Item=facto2none_1, Label=facto2none_1_labels, Loading=facto2none_1vect)
facto2none_1table_ord <- facto2none_1table[order(facto2none_1vect, decreasing = TRUE),]
#2
facto2none_2table <- data.frame(Item=facto2none_2, Label=facto2none_2_labels, Loading=facto2none_2vect)
facto2none_2table_ord <- facto2none_2table[order(facto2none_2vect, decreasing = TRUE),]

# nombre d'items par facteurs
n2_none_1 <- length(facto2none_1)
n2_none_2 <- length(facto2none_2)
n2_none <- n2_none_1+n2_none_2

# Créer les scores factoriels
scores2_none_1 <- facto2none$scores[,1]
scores2_none_2 <- facto2none$scores[,2]
```

Le RMSEA est égal à `r facto2noneRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto2nonermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto2noneTLI`.
Le premier facteur explique `r facto2_1none_variance` %, le deuxième explique `r facto2_2none_variance` % de la variance totale pour une variance cumulée égale à `r facto2none_variancecum` %.
Le premier facteur compte `r n2_none_1` items, le deuxième `r n2_none_2` items pour un total de `r n2_none` items.

### Facteur 1 : negative emotions

```{r}
kable(facto2none_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2none_1)$total$std.alpha, 2)`
```

### Facteur 2 : clinical implication

```{r}
kable(facto2none_2table_ord)
```

## 3 facteurs

```{r}
facto3none <- fa(items.df, nfactors=3, rotate="none", use="pairwise")
# print(facto3none$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto3none)
facto3noneRMSEA <- round(facto3none$RMSEA[["RMSEA"]],2) 
facto3nonermsr <- round(facto3none$rms,2)
facto3noneTLI <- round(facto3none$TLI,2)
facto3_1none_variance <- round(facto3none[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto3_2none_variance <- round(facto3none[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto3_3none_variance <- round(facto3none[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto3none_variancecum <- facto3_1none_variance+facto3_2none_variance+facto3_3none_variance

# Distinguer les facteurs

facto3none_1 <- which(abs(facto3none$loadings[,1]) > .30)
facto3none_2 <- which(abs(facto3none$loadings[,2]) > .30)
facto3none_3 <- which(abs(facto3none$loadings[,3]) > .30)
facto3none_1.df <- data.frame(facto3none_1)
facto3none_2.df <- data.frame(facto3none_2)
facto3none_3.df <- data.frame(facto3none_3)
facto3none_1vect <- round(as.vector(facto3none$loadings[,1][facto3none_1]),2)
facto3none_2vect <- round(as.vector(facto3none$loadings[,2][facto3none_2]),2)
facto3none_3vect <- round(as.vector(facto3none$loadings[,3][facto3none_3]),2)
facto3none_1_labels <- apply(facto3none_1.df, 1, find_label)
facto3none_2_labels <- apply(facto3none_2.df, 1, find_label)
facto3none_3_labels <- apply(facto3none_3.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto3none_1table <- data.frame(Item=facto3none_1, Label=facto3none_1_labels, Loading=facto3none_1vect)
facto3none_1table_ord <- facto3none_1table[order(facto3none_1vect, decreasing = TRUE),]
#2
facto3none_2table <- data.frame(Item=facto3none_2, Label=facto3none_2_labels, Loading=facto3none_2vect)
facto3none_2table_ord <- facto3none_2table[order(facto3none_2vect, decreasing = TRUE),]
#3
facto3none_3table <- data.frame(Item=facto3none_3, Label=facto3none_3_labels, Loading=facto3none_3vect)
facto3none_3table_ord <- facto3none_3table[order(facto3none_3vect, decreasing = TRUE),]

# nombre d'items par facteurs
n3_none_1 <- length(facto3none_1)
n3_none_2 <- length(facto3none_2)
n3_none_3 <- length(facto3none_3)
n3_none <- n3_none_1+n3_none_2+n3_none_3

# Créer les scores factoriels
scores3_none_1 <- facto3none$scores[,1]
scores3_none_2 <- facto3none$scores[,2]
scores3_none_3 <- facto3none$scores[,3]
```

Le RMSEA est égal à `r facto3noneRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto3nonermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto3noneTLI`.
Le premier facteur explique `r facto3_1none_variance` %, le deuxième explique `r facto3_2none_variance` %, le troisième `r facto3_3none_variance` % de la variance totale pour une variance cumulée égale à `r facto3none_variancecum` %.
Le premier facteur compte `r n3_none_1` items, le deuxième `r n3_none_2` items le troisième `r n3_none_3`  pour un total de `r n3_none` items.

### Facteur 1 : negative emotions

```{r}
kable(facto3none_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2none_1)$total$std.alpha, 2)`
```

### Facteur 2 : clinical implication

```{r}
kable(facto3none_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto3none_3table_ord)
```

## 4 facteurs

```{r}
facto4none <- fa(items.df, nfactors=4, rotate="none", use="pairwise")
# print(facto4none$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto4none)
facto4noneRMSEA <- round(facto4none$RMSEA[["RMSEA"]],2) 
facto4nonermsr <- round(facto4none$rms,2)
facto4noneTLI <- round(facto4none$TLI,2)
facto4_1none_variance <- round(facto4none[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto4_2none_variance <- round(facto4none[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto4_3none_variance <- round(facto4none[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto4_4none_variance <- round(facto4none[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4

facto4none_variancecum <- facto4_1none_variance+facto4_2none_variance+facto4_3none_variance+ facto4_4none_variance

# Distinguer les facteurs

facto4none_1 <- which(abs(facto4none$loadings[,1]) > .30)
facto4none_2 <- which(abs(facto4none$loadings[,2]) > .30)
facto4none_3 <- which(abs(facto4none$loadings[,3]) > .30)
facto4none_4 <- which(abs(facto4none$loadings[,4]) > .30)

facto4none_1.df <- data.frame(facto4none_1)
facto4none_2.df <- data.frame(facto4none_2)
facto4none_3.df <- data.frame(facto4none_3)
facto4none_4.df <- data.frame(facto4none_4)

facto4none_1vect <- round(as.vector(facto4none$loadings[,1][facto4none_1]),2)
facto4none_2vect <- round(as.vector(facto4none$loadings[,2][facto4none_2]),2)
facto4none_3vect <- round(as.vector(facto4none$loadings[,3][facto4none_3]),2)
facto4none_4vect <- round(as.vector(facto4none$loadings[,4][facto4none_4]),2)

facto4none_1_labels <- apply(facto4none_1.df, 1, find_label)
facto4none_2_labels <- apply(facto4none_2.df, 1, find_label)
facto4none_3_labels <- apply(facto4none_3.df, 1, find_label)
facto4none_4_labels <- apply(facto4none_4.df, 1, find_label)


# Tableaux pour chaque facteur
# 1
facto4none_1table <- data.frame(Item=facto4none_1, Label=facto4none_1_labels, Loading=facto4none_1vect)
facto4none_1table_ord <- facto4none_1table[order(facto4none_1vect, decreasing = TRUE),]
#2
facto4none_2table <- data.frame(Item=facto4none_2, Label=facto4none_2_labels, Loading=facto4none_2vect)
facto4none_2table_ord <- facto4none_2table[order(facto4none_2vect, decreasing = TRUE),]
#3
facto4none_3table <- data.frame(Item=facto4none_3, Label=facto4none_3_labels, Loading=facto4none_3vect)
facto4none_3table_ord <- facto4none_3table[order(facto4none_3vect, decreasing = TRUE),]
#4
facto4none_4table <- data.frame(Item=facto4none_4, Label=facto4none_4_labels, Loading=facto4none_4vect)
facto4none_4table_ord <- facto4none_4table[order(facto4none_4vect, decreasing = TRUE),]

# nombre d'items par facteurs
n4_none_1 <- length(facto4none_1)
n4_none_2 <- length(facto4none_2)
n4_none_3 <- length(facto4none_3)
n4_none_4 <- length(facto4none_4)

n4_none <- n4_none_1+n4_none_2+n4_none_3+n4_none_4

# Créer les scores factoriels
scores4_none_1 <- facto4none$scores[,1]
scores4_none_2 <- facto4none$scores[,2]
scores4_none_3 <- facto4none$scores[,3]
scores4_none_4 <- facto4none$scores[,4]

```

Le RMSEA est égal à `r facto4noneRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto4nonermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto4noneTLI`.
Le premier facteur explique `r facto4_1none_variance` %, le deuxième explique `r facto4_2none_variance` %, le troisième `r facto4_3none_variance` % de la variance totale pour une variance cumulée égale à `r facto4none_variancecum` %.
Le premier facteur compte `r n4_none_1` items, le deuxième `r n4_none_2` items le troisième `r n4_none_3` , le quatrième `r n4_none_4` pour un total de `r n4_none` items.

### Facteur 1 : negative emotions

```{r}
kable(facto4none_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2none_1)$total$std.alpha, 2)`
```

### Facteur 2 : clinical implication

```{r}
kable(facto4none_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto4none_3table_ord)
```

### Facteur 4 : none

```{r}
kable(facto4none_4table_ord)
```


# Rotation promax

N = `r N`

## Very Simple Structure

```{r}
# itemscentres <- scale(items.df, center = TRUE) #Centre les variables sur 0
vssmodelesfa <- vss(items.df, rotate = "promax", use="pairwise")
```

Le Very Simple Structure criterion propose une solution à 3 voire 4 facteurs.


## Method Agreement Procedure

[n_factors](https://easystats.github.io/parameters/reference/n_factors.html) utilise 14 méthodes pour proposer la solution factorielle la plus fréquemment proposée :

```{r}
n_factors_promax_results <- n_factors(items.df, type = "FA", rotation = "promax")
plot(n_factors_promax_results)
```

## 1 facteur

```{r}
facto1promax <- fa(items.df, nfactors=1, rotate="promax", use="pairwise")
# print(facto1promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto1promax)
facto1promaxRMSEA <- round(facto1promax$RMSEA[["RMSEA"]],2) 
facto1promaxrmsr <- round(facto1promax$rms,2)
facto1promaxTLI <- round(facto1promax$TLI,2)
facto1_1promax_variance <- round(facto1promax[["Vaccounted"]][2,1]*100,0) #obtenir la 

# Distinguer les facteurs

factor1promax_1 <- which(abs(facto1promax$loadings[,1]) > .30)
factor1promax_1.df <- data.frame(factor1promax_1)
facto1promax_1vect <- round(as.vector(facto1promax$loadings[,1][factor1promax_1]),2)
facto1promax_1_labels <- apply(factor1promax_1.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto1promax_1table <- data.frame(Item=factor1promax_1, Label=facto1promax_1_labels, Loading=facto1promax_1vect)
facto1promax_1table_ord <- facto1promax_1table[order(facto1promax_1vect, decreasing = TRUE),]


# nombre d'items par facteurs
n1_promax_1 <- length(factor1promax_1)


# Créer les scores factoriels
scores1_promax_1 <- facto1promax$scores[,1]
```

Le RMSEA est égal à `r facto1promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto1promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto1promaxTLI`.
Le premier facteur explique `r facto1_1promax_variance` %.
Le premier facteur compte `r n1_promax_1` items.

### Facteur 1 : negative emotions

```{r}
kable(facto1promax_1table_ord)
```

## 2 facteurs

```{r}
facto2promax <- fa(items.df, nfactors=2, rotate="promax", use="pairwise")
# print(facto2promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto2promax)
facto2promaxRMSEA <- round(facto2promax$RMSEA[["RMSEA"]],2) 
facto2promaxrmsr <- round(facto2promax$rms,2)
facto2promaxTLI <- round(facto2promax$TLI,2)
facto2_1promax_variance <- round(facto2promax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto2_2promax_variance <- round(facto2promax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto2_2promax_variancecum <- facto2_1promax_variance+facto2_2promax_variance

# Distinguer les facteurs

factor2promax_1 <- which(abs(facto2promax$loadings[,1]) > .30)
factor2promax_2 <- which(abs(facto2promax$loadings[,2]) > .30)
factor2promax_1.df <- data.frame(factor2promax_1)
factor2promax_2.df <- data.frame(factor2promax_2)
facto2promax_1vect <- round(as.vector(facto2promax$loadings[,1][factor2promax_1]),2)
facto2promax_2vect <- round(as.vector(facto2promax$loadings[,2][factor2promax_2]),2)
facto2promax_1_labels <- apply(factor2promax_1.df, 1, find_label)
facto2promax_2_labels <- apply(factor2promax_2.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto2promax_1table <- data.frame(Item=factor2promax_1, Label=facto2promax_1_labels, Loading=facto2promax_1vect)
facto2promax_1table_ord <- facto2promax_1table[order(facto2promax_1vect, decreasing = TRUE),]
#2
facto2promax_2table <- data.frame(Item=factor2promax_2, Label=facto2promax_2_labels, Loading=facto2promax_2vect)
facto2promax_2table_ord <- facto2promax_2table[order(facto2promax_2vect, decreasing = TRUE),]

# nombre d'items par facteurs
n2_promax_1 <- length(factor2promax_1)
n2_promax_2 <- length(factor2promax_2)
n2_promax <- n2_promax_1+n2_promax_2

# Créer les scores factoriels
scores2_promax_1 <- facto2promax$scores[,1]
scores2_promax_2 <- facto2promax$scores[,2]
```

Le RMSEA est égal à `r facto2promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto2promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto2promaxTLI`.
Le premier facteur explique `r facto2_1promax_variance` %, le deuxième explique `r facto2_2promax_variance` % de la variance totale pour une variance cumulée égale à `r facto2_2promax_variancecum` %.
Le premier facteur compte `r n2_promax_1` items, le deuxième `r n2_promax_2` items pour un total de `r n2_promax` items.

### Facteur 1 : negative emotions

```{r}
kable(facto2promax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2promax_1)$total$std.alpha, 2)`
```

### Facteur 2 : clinical implication

```{r}
kable(facto2promax_2table_ord)
```



## 3 facteurs

```{r}
facto3promax <- fa(items.df, nfactors=3, rotate="promax", use="pairwise")
# print(facto3promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto3promax)
facto3promaxRMSEA <- round(facto3promax$RMSEA[["RMSEA"]],2) 
facto3promaxrmsr <- round(facto3promax$rms,2)
facto3promaxTLI <- round(facto3promax$TLI,2)
facto3_1promax_variance <- round(facto3promax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto3_2promax_variance <- round(facto3promax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto3_3promax_variance <- round(facto3promax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto3promax_variancecum <- facto3_1promax_variance+facto3_2promax_variance+facto3_3promax_variance

# Distinguer les facteurs

facto3promax_1 <- which(abs(facto3promax$loadings[,1]) > .30)
facto3promax_2 <- which(abs(facto3promax$loadings[,2]) > .30)
facto3promax_3 <- which(abs(facto3promax$loadings[,3]) > .30)
facto3promax_1.df <- data.frame(facto3promax_1)
facto3promax_2.df <- data.frame(facto3promax_2)
facto3promax_3.df <- data.frame(facto3promax_3)
facto3promax_1vect <- round(as.vector(facto3promax$loadings[,1][facto3promax_1]),2)
facto3promax_2vect <- round(as.vector(facto3promax$loadings[,2][facto3promax_2]),2)
facto3promax_3vect <- round(as.vector(facto3promax$loadings[,3][facto3promax_3]),2)
facto3promax_1_labels <- apply(facto3promax_1.df, 1, find_label)
facto3promax_2_labels <- apply(facto3promax_2.df, 1, find_label)
facto3promax_3_labels <- apply(facto3promax_3.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto3promax_1table <- data.frame(Item=facto3promax_1, Label=facto3promax_1_labels, Loading=facto3promax_1vect)
facto3promax_1table_ord <- facto3promax_1table[order(facto3promax_1vect, decreasing = TRUE),]
#2
facto3promax_2table <- data.frame(Item=facto3promax_2, Label=facto3promax_2_labels, Loading=facto3promax_2vect)
facto3promax_2table_ord <- facto3promax_2table[order(facto3promax_2vect, decreasing = TRUE),]
#3
facto3promax_3table <- data.frame(Item=facto3promax_3, Label=facto3promax_3_labels, Loading=facto3promax_3vect)
facto3promax_3table_ord <- facto3promax_3table[order(facto3promax_3vect, decreasing = TRUE),]

# nombre d'items par facteurs
n3_promax_1 <- length(facto3promax_1)
n3_promax_2 <- length(facto3promax_2)
n3_promax_3 <- length(facto3promax_3)
n3_promax <- n3_promax_1+n3_promax_2+n3_promax_3

# Créer les scores factoriels
scores3_promax_1 <- facto3promax$scores[,1]
scores3_promax_2 <- facto3promax$scores[,2]
scores3_promax_3 <- facto3promax$scores[,3]
```

Le RMSEA est égal à `r facto3promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto3promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto3promaxTLI`.
Le premier facteur explique `r facto3_1promax_variance` %, le deuxième explique `r facto3_2promax_variance` %, le troisième `r facto3_3promax_variance` % de la variance totale pour une variance cumulée égale à `r facto3promax_variancecum` %.
Le premier facteur compte `r n3_promax_1` items, le deuxième `r n3_promax_2` items le troisième `r n3_promax_3` pour un total de `r n3_promax` items.

### Facteur 1 : incompetence

```{r}
kable(facto3promax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2promax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto3promax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto3promax_3table_ord)
```

## 4 facteurs

```{r}
facto4promax <- fa(items.df, nfactors=4, rotate="promax", use="pairwise")
# print(facto4promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto4promax)
facto4promaxRMSEA <- round(facto4promax$RMSEA[["RMSEA"]],2) 
facto4promaxrmsr <- round(facto4promax$rms,2)
facto4promaxTLI <- round(facto4promax$TLI,2)
facto4_1promax_variance <- round(facto4promax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto4_2promax_variance <- round(facto4promax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto4_3promax_variance <- round(facto4promax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto4_4promax_variance <- round(facto4promax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4

facto4promax_variancecum <- facto4_1promax_variance+facto4_2promax_variance+facto4_3promax_variance+ facto4_4promax_variance

# Distinguer les facteurs

facto4promax_1 <- which(abs(facto4promax$loadings[,1]) > .30)
facto4promax_2 <- which(abs(facto4promax$loadings[,2]) > .30)
facto4promax_3 <- which(abs(facto4promax$loadings[,3]) > .30)
facto4promax_4 <- which(abs(facto4promax$loadings[,4]) > .30)

facto4promax_1.df <- data.frame(facto4promax_1)
facto4promax_2.df <- data.frame(facto4promax_2)
facto4promax_3.df <- data.frame(facto4promax_3)
facto4promax_4.df <- data.frame(facto4promax_4)

facto4promax_1vect <- round(as.vector(facto4promax$loadings[,1][facto4promax_1]),2)
facto4promax_2vect <- round(as.vector(facto4promax$loadings[,2][facto4promax_2]),2)
facto4promax_3vect <- round(as.vector(facto4promax$loadings[,3][facto4promax_3]),2)
facto4promax_4vect <- round(as.vector(facto4promax$loadings[,4][facto4promax_4]),2)

facto4promax_1_labels <- apply(facto4promax_1.df, 1, find_label)
facto4promax_2_labels <- apply(facto4promax_2.df, 1, find_label)
facto4promax_3_labels <- apply(facto4promax_3.df, 1, find_label)
facto4promax_4_labels <- apply(facto4promax_4.df, 1, find_label)


# Tableaux pour chaque facteur
# 1
facto4promax_1table <- data.frame(Item=facto4promax_1, Label=facto4promax_1_labels, Loading=facto4promax_1vect)
facto4promax_1table_ord <- facto4promax_1table[order(facto4promax_1vect, decreasing = TRUE),]
#2
facto4promax_2table <- data.frame(Item=facto4promax_2, Label=facto4promax_2_labels, Loading=facto4promax_2vect)
facto4promax_2table_ord <- facto4promax_2table[order(facto4promax_2vect, decreasing = TRUE),]
#3
facto4promax_3table <- data.frame(Item=facto4promax_3, Label=facto4promax_3_labels, Loading=facto4promax_3vect)
facto4promax_3table_ord <- facto4promax_3table[order(facto4promax_3vect, decreasing = TRUE),]
#4
facto4promax_4table <- data.frame(Item=facto4promax_4, Label=facto4promax_4_labels, Loading=facto4promax_4vect)
facto4promax_4table_ord <- facto4promax_4table[order(facto4promax_4vect, decreasing = TRUE),]

# nombre d'items par facteurs
n4_promax_1 <- length(facto4promax_1)
n4_promax_2 <- length(facto4promax_2)
n4_promax_3 <- length(facto4promax_3)
n4_promax_4 <- length(facto4promax_4)

n4_promax <- n4_promax_1+n4_promax_2+n4_promax_3+n4_promax_4

# Créer les scores factoriels
scores4_promax_1 <- facto4promax$scores[,1]
scores4_promax_2 <- facto4promax$scores[,2]
scores4_promax_3 <- facto4promax$scores[,3]
scores4_promax_4 <- facto4promax$scores[,4]

```

Le RMSEA est égal à `r facto4promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto4promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto4promaxTLI`.
Le premier facteur explique `r facto4_1promax_variance` %, le deuxième explique `r facto4_2promax_variance` %, le troisième `r facto4_3promax_variance` %, le quatrième `r facto4_4promax_variance` % de la variance totale pour une variance cumulée égale à `r facto4promax_variancecum` %.
Le premier facteur compte `r n4_promax_1` items, le deuxième `r n4_promax_2` items le troisième `r n4_promax_3`, le quatrième `r n4_promax_4` pour un total de `r n4_promax` items.

### Facteur 1 : incompetence

```{r}
kable(facto4promax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2promax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto4promax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto4promax_3table_ord)
```

### Facteur 4 : loss of professionnal distance

```{r}
kable(facto4promax_4table_ord)
```


## 5 facteurs

```{r}
facto5promax <- fa(items.df, nfactors=5, rotate="promax", use="pairwise")
# print(facto5promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto5promax)
facto5promaxRMSEA <- round(facto5promax$RMSEA[["RMSEA"]],2) 
facto5promaxrmsr <- round(facto5promax$rms,2)
facto5promaxTLI <- round(facto5promax$TLI,2)
facto5_1promax_variance <- round(facto5promax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto5_2promax_variance <- round(facto5promax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto5_3promax_variance <- round(facto5promax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto5_4promax_variance <- round(facto5promax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto5_5promax_variance <- round(facto5promax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5

facto5promax_variancecum <- facto5_1promax_variance+facto5_2promax_variance+facto5_3promax_variance+ facto5_4promax_variance+facto5_5promax_variance

# Distinguer les facteurs

facto5promax_1 <- which(abs(facto5promax$loadings[,1]) > .30)
facto5promax_2 <- which(abs(facto5promax$loadings[,2]) > .30)
facto5promax_3 <- which(abs(facto5promax$loadings[,3]) > .30)
facto5promax_4 <- which(abs(facto5promax$loadings[,4]) > .30)
facto5promax_5 <- which(abs(facto5promax$loadings[,5]) > .30)

facto5promax_1.df <- data.frame(facto5promax_1)
facto5promax_2.df <- data.frame(facto5promax_2)
facto5promax_3.df <- data.frame(facto5promax_3)
facto5promax_4.df <- data.frame(facto5promax_4)
facto5promax_5.df <- data.frame(facto5promax_5)

facto5promax_1vect <- round(as.vector(facto5promax$loadings[,1][facto5promax_1]),2)
facto5promax_2vect <- round(as.vector(facto5promax$loadings[,2][facto5promax_2]),2)
facto5promax_3vect <- round(as.vector(facto5promax$loadings[,3][facto5promax_3]),2)
facto5promax_4vect <- round(as.vector(facto5promax$loadings[,4][facto5promax_4]),2)
facto5promax_5vect <- round(as.vector(facto5promax$loadings[,5][facto5promax_5]),2)

facto5promax_1_labels <- apply(facto5promax_1.df, 1, find_label)
facto5promax_2_labels <- apply(facto5promax_2.df, 1, find_label)
facto5promax_3_labels <- apply(facto5promax_3.df, 1, find_label)
facto5promax_4_labels <- apply(facto5promax_4.df, 1, find_label)
facto5promax_5_labels <- apply(facto5promax_5.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto5promax_1table <- data.frame(Item=facto5promax_1, Label=facto5promax_1_labels, Loading=facto5promax_1vect)
facto5promax_1table_ord <- facto5promax_1table[order(facto5promax_1vect, decreasing = TRUE),]
#2
facto5promax_2table <- data.frame(Item=facto5promax_2, Label=facto5promax_2_labels, Loading=facto5promax_2vect)
facto5promax_2table_ord <- facto5promax_2table[order(facto5promax_2vect, decreasing = TRUE),]
#3
facto5promax_3table <- data.frame(Item=facto5promax_3, Label=facto5promax_3_labels, Loading=facto5promax_3vect)
facto5promax_3table_ord <- facto5promax_3table[order(facto5promax_3vect, decreasing = TRUE),]
#4
facto5promax_4table <- data.frame(Item=facto5promax_4, Label=facto5promax_4_labels, Loading=facto5promax_4vect)
facto5promax_4table_ord <- facto5promax_4table[order(facto5promax_4vect, decreasing = TRUE),]
#5
facto5promax_5table <- data.frame(Item=facto5promax_5, Label=facto5promax_5_labels, Loading=facto5promax_5vect)
facto5promax_5table_ord <- facto5promax_5table[order(facto5promax_5vect, decreasing = TRUE),]

# nombre d'items par facteurs
n5_promax_1 <- length(facto5promax_1)
n5_promax_2 <- length(facto5promax_2)
n5_promax_3 <- length(facto5promax_3)
n5_promax_4 <- length(facto5promax_4)
n5_promax_5 <- length(facto5promax_5)

n5_promax <- n4_promax_1+n4_promax_2+n4_promax_3+n4_promax_4+n5_promax_5

# Créer les scores factoriels
scores5_promax_1 <- facto5promax$scores[,1]
scores5_promax_2 <- facto5promax$scores[,2]
scores5_promax_3 <- facto5promax$scores[,3]
scores5_promax_4 <- facto5promax$scores[,4]
scores5_promax_5 <- facto5promax$scores[,5]

```

Le RMSEA est égal à `r facto5promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto5promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto5promaxTLI`.
Le premier facteur explique `r facto5_1promax_variance` %, le deuxième explique `r facto5_2promax_variance` %, le troisième `r facto5_3promax_variance` %, la quatrième `r facto5_4promax_variance` %, le cinquième `r facto5_5promax_variance` % de la variance totale pour une variance cumulée égale à `r facto5promax_variancecum` %.
Le premier facteur compte `r n5_promax_1` items, le deuxième `r n5_promax_2` items le troisième `r n5_promax_3` items, le quatrième `r n5_promax_4` items, le cinquième `r n5_promax_5` items, pour un total de `r n5_promax` items.

### Facteur 1 : overwhelmed

```{r}
kable(facto5promax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2promax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto5promax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto5promax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto5promax_4table_ord)
```

### Facteur 5 : seduction

```{r}
kable(facto5promax_5table_ord)
```

## 6 facteurs

```{r}
facto6promax <- fa(items.df, nfactors=6, rotate="promax", use="pairwise")
# print(facto6promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto6promax)
facto6promaxRMSEA <- round(facto6promax$RMSEA[["RMSEA"]],2) 
facto6promaxrmsr <- round(facto6promax$rms,2)
facto6promaxTLI <- round(facto6promax$TLI,2)
facto6_1promax_variance <- round(facto6promax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto6_2promax_variance <- round(facto6promax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto6_3promax_variance <- round(facto6promax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto6_4promax_variance <- round(facto6promax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto6_5promax_variance <- round(facto6promax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto6_6promax_variance <- round(facto6promax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6

facto6promax_variancecum <- facto6_1promax_variance+facto6_2promax_variance+facto6_3promax_variance+ facto6_4promax_variance+facto6_5promax_variance+facto6_6promax_variance

# Distinguer les facteurs

facto6promax_1 <- which(abs(facto6promax$loadings[,1]) > .30)
facto6promax_2 <- which(abs(facto6promax$loadings[,2]) > .30)
facto6promax_3 <- which(abs(facto6promax$loadings[,3]) > .30)
facto6promax_4 <- which(abs(facto6promax$loadings[,4]) > .30)
facto6promax_5 <- which(abs(facto6promax$loadings[,5]) > .30)
facto6promax_6 <- which(abs(facto6promax$loadings[,6]) > .30)

facto6promax_1.df <- data.frame(facto6promax_1)
facto6promax_2.df <- data.frame(facto6promax_2)
facto6promax_3.df <- data.frame(facto6promax_3)
facto6promax_4.df <- data.frame(facto6promax_4)
facto6promax_5.df <- data.frame(facto6promax_5)
facto6promax_6.df <- data.frame(facto6promax_6)

facto6promax_1vect <- round(as.vector(facto6promax$loadings[,1][facto6promax_1]),2)
facto6promax_2vect <- round(as.vector(facto6promax$loadings[,2][facto6promax_2]),2)
facto6promax_3vect <- round(as.vector(facto6promax$loadings[,3][facto6promax_3]),2)
facto6promax_4vect <- round(as.vector(facto6promax$loadings[,4][facto6promax_4]),2)
facto6promax_5vect <- round(as.vector(facto6promax$loadings[,5][facto6promax_5]),2)
facto6promax_6vect <- round(as.vector(facto6promax$loadings[,6][facto6promax_6]),2)

facto6promax_1_labels <- apply(facto6promax_1.df, 1, find_label)
facto6promax_2_labels <- apply(facto6promax_2.df, 1, find_label)
facto6promax_3_labels <- apply(facto6promax_3.df, 1, find_label)
facto6promax_4_labels <- apply(facto6promax_4.df, 1, find_label)
facto6promax_5_labels <- apply(facto6promax_5.df, 1, find_label)
facto6promax_6_labels <- apply(facto6promax_6.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto6promax_1table <- data.frame(Item=facto6promax_1, Label=facto6promax_1_labels, Loading=facto6promax_1vect)
facto6promax_1table_ord <- facto6promax_1table[order(facto6promax_1vect, decreasing = TRUE),]
#2
facto6promax_2table <- data.frame(Item=facto6promax_2, Label=facto6promax_2_labels, Loading=facto6promax_2vect)
facto6promax_2table_ord <- facto6promax_2table[order(facto6promax_2vect, decreasing = TRUE),]
#3
facto6promax_3table <- data.frame(Item=facto6promax_3, Label=facto6promax_3_labels, Loading=facto6promax_3vect)
facto6promax_3table_ord <- facto6promax_3table[order(facto6promax_3vect, decreasing = TRUE),]
#4
facto6promax_4table <- data.frame(Item=facto6promax_4, Label=facto6promax_4_labels, Loading=facto6promax_4vect)
facto6promax_4table_ord <- facto6promax_4table[order(facto6promax_4vect, decreasing = TRUE),]
#5
facto6promax_5table <- data.frame(Item=facto6promax_5, Label=facto6promax_5_labels, Loading=facto6promax_5vect)
facto6promax_5table_ord <- facto6promax_5table[order(facto6promax_5vect, decreasing = TRUE),]
#6
facto6promax_6table <- data.frame(Item=facto6promax_6, Label=facto6promax_6_labels, Loading=facto6promax_6vect)
facto6promax_6table_ord <- facto6promax_6table[order(facto6promax_6vect, decreasing = TRUE),]


# nombre d'items par facteurs
n6_promax_1 <- length(facto6promax_1)
n6_promax_2 <- length(facto6promax_2)
n6_promax_3 <- length(facto6promax_3)
n6_promax_4 <- length(facto6promax_4)
n6_promax_5 <- length(facto6promax_5)
n6_promax_6 <- length(facto6promax_6)

n6_promax <- n4_promax_1+n4_promax_2+n4_promax_3+n4_promax_4+n6_promax_5+n6_promax_6

# Créer les scores factoriels
scores6_promax_1 <- facto6promax$scores[,1]
scores6_promax_2 <- facto6promax$scores[,2]
scores6_promax_3 <- facto6promax$scores[,3]
scores6_promax_4 <- facto6promax$scores[,4]
scores6_promax_5 <- facto6promax$scores[,5]
scores6_promax_6 <- facto6promax$scores[,6]
```

Le RMSEA est égal à `r facto6promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto6promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto6promaxTLI`.
Le premier facteur explique `r facto6_1promax_variance` %, le deuxième explique `r facto6_2promax_variance` %, le troisième `r facto6_3promax_variance` %, le quatrième `r facto6_4promax_variance` %, le cinquième `r facto6_5promax_variance` % , le sixième `r facto6_6promax_variance` % de la variance totale pour une variance cumulée égale à `r facto6promax_variancecum` %.
Le premier facteur compte `r n6_promax_1` items, le deuxième `r n6_promax_2` items le troisième `r n6_promax_3` items, le quatrième `r n6_promax_4` items, le cinquième `r n6_promax_5` items, le sixième `r n6_promax_6` items pour un total de `r n6_promax` items.

### Facteur 1 : overwhelmed

```{r}
kable(facto6promax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2promax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto6promax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto6promax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto6promax_4table_ord)
```

### Facteur 5 : sexualized

```{r}
kable(facto6promax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto6promax_6table_ord)
```

## 7 facteurs

```{r}
facto7promax <- fa(items.df, nfactors=7, rotate="promax", use="pairwise")
# print(facto7promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto7promax)
facto7promaxRMSEA <- round(facto7promax$RMSEA[["RMSEA"]],2) 
facto7promaxrmsr <- round(facto7promax$rms,2)
facto7promaxTLI <- round(facto7promax$TLI,2)
facto7_1promax_variance <- round(facto7promax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto7_2promax_variance <- round(facto7promax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto7_3promax_variance <- round(facto7promax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto7_4promax_variance <- round(facto7promax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto7_5promax_variance <- round(facto7promax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto7_6promax_variance <- round(facto7promax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto7_7promax_variance <- round(facto7promax[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7

facto7promax_variancecum <- facto7_1promax_variance+facto7_2promax_variance+facto7_3promax_variance+ facto7_4promax_variance+facto7_5promax_variance+facto7_6promax_variance+facto7_7promax_variance

# Distinguer les facteurs

facto7promax_1 <- which(abs(facto7promax$loadings[,1]) > .30)
facto7promax_2 <- which(abs(facto7promax$loadings[,2]) > .30)
facto7promax_3 <- which(abs(facto7promax$loadings[,3]) > .30)
facto7promax_4 <- which(abs(facto7promax$loadings[,4]) > .30)
facto7promax_5 <- which(abs(facto7promax$loadings[,5]) > .30)
facto7promax_6 <- which(abs(facto7promax$loadings[,6]) > .30)
facto7promax_7 <- which(abs(facto7promax$loadings[,7]) > .30)

facto7promax_1.df <- data.frame(facto7promax_1)
facto7promax_2.df <- data.frame(facto7promax_2)
facto7promax_3.df <- data.frame(facto7promax_3)
facto7promax_4.df <- data.frame(facto7promax_4)
facto7promax_5.df <- data.frame(facto7promax_5)
facto7promax_6.df <- data.frame(facto7promax_6)
facto7promax_7.df <- data.frame(facto7promax_7)

facto7promax_1vect <- round(as.vector(facto7promax$loadings[,1][facto7promax_1]),2)
facto7promax_2vect <- round(as.vector(facto7promax$loadings[,2][facto7promax_2]),2)
facto7promax_3vect <- round(as.vector(facto7promax$loadings[,3][facto7promax_3]),2)
facto7promax_4vect <- round(as.vector(facto7promax$loadings[,4][facto7promax_4]),2)
facto7promax_5vect <- round(as.vector(facto7promax$loadings[,5][facto7promax_5]),2)
facto7promax_6vect <- round(as.vector(facto7promax$loadings[,6][facto7promax_6]),2)
facto7promax_7vect <- round(as.vector(facto7promax$loadings[,7][facto7promax_7]),2)

facto7promax_1_labels <- apply(facto7promax_1.df, 1, find_label)
facto7promax_2_labels <- apply(facto7promax_2.df, 1, find_label)
facto7promax_3_labels <- apply(facto7promax_3.df, 1, find_label)
facto7promax_4_labels <- apply(facto7promax_4.df, 1, find_label)
facto7promax_5_labels <- apply(facto7promax_5.df, 1, find_label)
facto7promax_6_labels <- apply(facto7promax_6.df, 1, find_label)
facto7promax_7_labels <- apply(facto7promax_7.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto7promax_1table <- data.frame(Item=facto7promax_1, Label=facto7promax_1_labels, Loading=facto7promax_1vect)
facto7promax_1table_ord <- facto7promax_1table[order(facto7promax_1vect, decreasing = TRUE),]
#2
facto7promax_2table <- data.frame(Item=facto7promax_2, Label=facto7promax_2_labels, Loading=facto7promax_2vect)
facto7promax_2table_ord <- facto7promax_2table[order(facto7promax_2vect, decreasing = TRUE),]
#3
facto7promax_3table <- data.frame(Item=facto7promax_3, Label=facto7promax_3_labels, Loading=facto7promax_3vect)
facto7promax_3table_ord <- facto7promax_3table[order(facto7promax_3vect, decreasing = TRUE),]
#4
facto7promax_4table <- data.frame(Item=facto7promax_4, Label=facto7promax_4_labels, Loading=facto7promax_4vect)
facto7promax_4table_ord <- facto7promax_4table[order(facto7promax_4vect, decreasing = TRUE),]
#5
facto7promax_5table <- data.frame(Item=facto7promax_5, Label=facto7promax_5_labels, Loading=facto7promax_5vect)
facto7promax_5table_ord <- facto7promax_5table[order(facto7promax_5vect, decreasing = TRUE),]
#6
facto7promax_6table <- data.frame(Item=facto7promax_6, Label=facto7promax_6_labels, Loading=facto7promax_6vect)
facto7promax_6table_ord <- facto7promax_6table[order(facto7promax_6vect, decreasing = TRUE),]
#7
facto7promax_7table <- data.frame(Item=facto7promax_7, Label=facto7promax_7_labels, Loading=facto7promax_7vect)
facto7promax_7table_ord <- facto7promax_7table[order(facto7promax_7vect, decreasing = TRUE),]


# nombre d'items par facteurs
n7_promax_1 <- length(facto7promax_1)
n7_promax_2 <- length(facto7promax_2)
n7_promax_3 <- length(facto7promax_3)
n7_promax_4 <- length(facto7promax_4)
n7_promax_5 <- length(facto7promax_5)
n7_promax_6 <- length(facto7promax_6)
n7_promax_7 <- length(facto7promax_7)

n7_promax <- n4_promax_1+n4_promax_2+n4_promax_3+n4_promax_4+n7_promax_5+n7_promax_6+n7_promax_7

# Créer les scores factoriels
scores7_promax_1 <- facto7promax$scores[,1]
scores7_promax_2 <- facto7promax$scores[,2]
scores7_promax_3 <- facto7promax$scores[,3]
scores7_promax_4 <- facto7promax$scores[,4]
scores7_promax_5 <- facto7promax$scores[,5]
scores7_promax_6 <- facto7promax$scores[,6]
scores7_promax_7 <- facto7promax$scores[,7]
```

Le RMSEA est égal à `r facto7promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto7promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto7promaxTLI`.
Le premier facteur explique `r facto7_1promax_variance` %, le deuxième explique `r facto7_2promax_variance` %, le troisième `r facto7_3promax_variance` %, le quatrième `r facto7_4promax_variance` %, le cinquième `r facto7_5promax_variance` % , le sixième `r facto7_6promax_variance` %, le septième `r facto7_7promax_variance` % de la variance totale pour une variance cumulée égale à `r facto7promax_variancecum` %.
Le premier facteur compte `r n7_promax_1` items, le deuxième `r n7_promax_2` items le troisième `r n7_promax_3` items, le quatrième `r n7_promax_4` items, le cinquième `r n7_promax_5` items, le sixième `r n7_promax_6` items, le septième `r n7_promax_7` items pour un total de `r n7_promax` items.

### Facteur 1 : mistreated

```{r}
kable(facto7promax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2promax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto7promax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto7promax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto7promax_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto7promax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto7promax_6table_ord)
```

### Facteur 7 : sexualized

```{r}
kable(facto7promax_7table_ord)
```

## 8 facteurs

```{r}
facto8promax <- fa(items.df, nfactors=8, rotate="promax", use="pairwise")
# print(facto8promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto8promax)
facto8promaxRMSEA <- round(facto8promax$RMSEA[["RMSEA"]],2) 
facto8promaxrmsr <- round(facto8promax$rms,2)
facto8promaxTLI <- round(facto8promax$TLI,2)
facto8_1promax_variance <- round(facto8promax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto8_2promax_variance <- round(facto8promax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto8_3promax_variance <- round(facto8promax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto8_4promax_variance <- round(facto8promax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto8_5promax_variance <- round(facto8promax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto8_6promax_variance <- round(facto8promax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto8_7promax_variance <- round(facto8promax[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto8_8promax_variance <- round(facto8promax[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8

facto8promax_variancecum <- facto8_1promax_variance+facto8_2promax_variance+facto8_3promax_variance+ facto8_4promax_variance+facto8_5promax_variance+facto8_6promax_variance+facto8_7promax_variance+facto8_8promax_variance

# Distinguer les facteurs

facto8promax_1 <- which(abs(facto8promax$loadings[,1]) > .30)
facto8promax_2 <- which(abs(facto8promax$loadings[,2]) > .30)
facto8promax_3 <- which(abs(facto8promax$loadings[,3]) > .30)
facto8promax_4 <- which(abs(facto8promax$loadings[,4]) > .30)
facto8promax_5 <- which(abs(facto8promax$loadings[,5]) > .30)
facto8promax_6 <- which(abs(facto8promax$loadings[,6]) > .30)
facto8promax_7 <- which(abs(facto8promax$loadings[,7]) > .30)
facto8promax_8 <- which(abs(facto8promax$loadings[,8]) > .30)

facto8promax_1.df <- data.frame(facto8promax_1)
facto8promax_2.df <- data.frame(facto8promax_2)
facto8promax_3.df <- data.frame(facto8promax_3)
facto8promax_4.df <- data.frame(facto8promax_4)
facto8promax_5.df <- data.frame(facto8promax_5)
facto8promax_6.df <- data.frame(facto8promax_6)
facto8promax_7.df <- data.frame(facto8promax_7)
facto8promax_8.df <- data.frame(facto8promax_8)

facto8promax_1vect <- round(as.vector(facto8promax$loadings[,1][facto8promax_1]),2)
facto8promax_2vect <- round(as.vector(facto8promax$loadings[,2][facto8promax_2]),2)
facto8promax_3vect <- round(as.vector(facto8promax$loadings[,3][facto8promax_3]),2)
facto8promax_4vect <- round(as.vector(facto8promax$loadings[,4][facto8promax_4]),2)
facto8promax_5vect <- round(as.vector(facto8promax$loadings[,5][facto8promax_5]),2)
facto8promax_6vect <- round(as.vector(facto8promax$loadings[,6][facto8promax_6]),2)
facto8promax_7vect <- round(as.vector(facto8promax$loadings[,7][facto8promax_7]),2)
facto8promax_8vect <- round(as.vector(facto8promax$loadings[,8][facto8promax_8]),2)

facto8promax_1_labels <- apply(facto8promax_1.df, 1, find_label)
facto8promax_2_labels <- apply(facto8promax_2.df, 1, find_label)
facto8promax_3_labels <- apply(facto8promax_3.df, 1, find_label)
facto8promax_4_labels <- apply(facto8promax_4.df, 1, find_label)
facto8promax_5_labels <- apply(facto8promax_5.df, 1, find_label)
facto8promax_6_labels <- apply(facto8promax_6.df, 1, find_label)
facto8promax_7_labels <- apply(facto8promax_7.df, 1, find_label)
facto8promax_8_labels <- apply(facto8promax_8.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto8promax_1table <- data.frame(Item=facto8promax_1, Label=facto8promax_1_labels, Loading=facto8promax_1vect)
facto8promax_1table_ord <- facto8promax_1table[order(facto8promax_1vect, decreasing = TRUE),]
#2
facto8promax_2table <- data.frame(Item=facto8promax_2, Label=facto8promax_2_labels, Loading=facto8promax_2vect)
facto8promax_2table_ord <- facto8promax_2table[order(facto8promax_2vect, decreasing = TRUE),]
#3
facto8promax_3table <- data.frame(Item=facto8promax_3, Label=facto8promax_3_labels, Loading=facto8promax_3vect)
facto8promax_3table_ord <- facto8promax_3table[order(facto8promax_3vect, decreasing = TRUE),]
#4
facto8promax_4table <- data.frame(Item=facto8promax_4, Label=facto8promax_4_labels, Loading=facto8promax_4vect)
facto8promax_4table_ord <- facto8promax_4table[order(facto8promax_4vect, decreasing = TRUE),]
#5
facto8promax_5table <- data.frame(Item=facto8promax_5, Label=facto8promax_5_labels, Loading=facto8promax_5vect)
facto8promax_5table_ord <- facto8promax_5table[order(facto8promax_5vect, decreasing = TRUE),]
#6
facto8promax_6table <- data.frame(Item=facto8promax_6, Label=facto8promax_6_labels, Loading=facto8promax_6vect)
facto8promax_6table_ord <- facto8promax_6table[order(facto8promax_6vect, decreasing = TRUE),]
#7
facto8promax_7table <- data.frame(Item=facto8promax_7, Label=facto8promax_7_labels, Loading=facto8promax_7vect)
facto8promax_7table_ord <- facto8promax_7table[order(facto8promax_7vect, decreasing = TRUE),]
#8
facto8promax_8table <- data.frame(Item=facto8promax_8, Label=facto8promax_8_labels, Loading=facto8promax_8vect)
facto8promax_8table_ord <- facto8promax_8table[order(facto8promax_8vect, decreasing = TRUE),]


# nombre d'items par facteurs
n8_promax_1 <- length(facto8promax_1)
n8_promax_2 <- length(facto8promax_2)
n8_promax_3 <- length(facto8promax_3)
n8_promax_4 <- length(facto8promax_4)
n8_promax_5 <- length(facto8promax_5)
n8_promax_6 <- length(facto8promax_6)
n8_promax_7 <- length(facto8promax_7)
n8_promax_8 <- length(facto8promax_8)

n8_promax <- n4_promax_1+n4_promax_2+n4_promax_3+n4_promax_4+n8_promax_5+n8_promax_6+n8_promax_7+n8_promax_8

# Créer les scores factoriels
scores8_promax_1 <- facto8promax$scores[,1]
scores8_promax_2 <- facto8promax$scores[,2]
scores8_promax_3 <- facto8promax$scores[,3]
scores8_promax_4 <- facto8promax$scores[,4]
scores8_promax_5 <- facto8promax$scores[,5]
scores8_promax_6 <- facto8promax$scores[,6]
scores8_promax_7 <- facto8promax$scores[,7]
scores8_promax_8 <- facto8promax$scores[,8]
```

Le RMSEA est égal à `r facto8promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto8promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto8promaxTLI`.
Le premier facteur explique `r facto8_1promax_variance` %, le deuxième explique `r facto8_2promax_variance` %, le troisième `r facto8_3promax_variance` %, le quatrième `r facto8_4promax_variance` %, le cinquième `r facto8_5promax_variance` % , le sixième `r facto8_6promax_variance` %, le septième `r facto8_7promax_variance` %, le huitième `r facto8_8promax_variance` %  de la variance totale pour une variance cumulée égale à `r facto8promax_variancecum` %.
Le premier facteur compte `r n8_promax_1` items, le deuxième `r n8_promax_2` items le troisième `r n8_promax_3` items, le quatrième `r n8_promax_4` items, le cinquième `r n8_promax_5` items, le sixième `r n8_promax_6` items, le septième `r n8_promax_7` items, le huitième `r n8_promax_8` items pour un total de `r n8_promax` items.

### Facteur 1 : mistreated

```{r}
kable(facto8promax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2promax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto8promax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto8promax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto8promax_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto8promax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto8promax_6table_ord)
```

### Facteur 7 : sexualized

```{r}
kable(facto8promax_7table_ord)
```

### Facteur 8 : distrust

```{r}
kable(facto8promax_8table_ord)
```

## 9 facteurs

```{r}
facto9promax <- fa(items.df, nfactors=9, rotate="promax", use="pairwise")
# print(facto9promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto9promax)
facto9promaxRMSEA <- round(facto9promax$RMSEA[["RMSEA"]],2) 
facto9promaxrmsr <- round(facto9promax$rms,2)
facto9promaxTLI <- round(facto9promax$TLI,2)
facto9_1promax_variance <- round(facto9promax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto9_2promax_variance <- round(facto9promax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto9_3promax_variance <- round(facto9promax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto9_4promax_variance <- round(facto9promax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto9_5promax_variance <- round(facto9promax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto9_6promax_variance <- round(facto9promax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto9_7promax_variance <- round(facto9promax[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto9_8promax_variance <- round(facto9promax[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8
facto9_9promax_variance <- round(facto9promax[["Vaccounted"]][2,9]*100,0) #obtenir la variance expliquée pour le facteur 9

facto9promax_variancecum <- facto9_1promax_variance+facto9_2promax_variance+facto9_3promax_variance+ facto9_4promax_variance+facto9_5promax_variance+facto9_6promax_variance+facto9_7promax_variance+facto9_8promax_variance+facto9_9promax_variance 

# Distinguer les facteurs

facto9promax_1 <- which(abs(facto9promax$loadings[,1]) > .30)
facto9promax_2 <- which(abs(facto9promax$loadings[,2]) > .30)
facto9promax_3 <- which(abs(facto9promax$loadings[,3]) > .30)
facto9promax_4 <- which(abs(facto9promax$loadings[,4]) > .30)
facto9promax_5 <- which(abs(facto9promax$loadings[,5]) > .30)
facto9promax_6 <- which(abs(facto9promax$loadings[,6]) > .30)
facto9promax_7 <- which(abs(facto9promax$loadings[,7]) > .30)
facto9promax_8 <- which(abs(facto9promax$loadings[,8]) > .30)
facto9promax_9 <- which(abs(facto9promax$loadings[,9]) > .30)

facto9promax_1.df <- data.frame(facto9promax_1)
facto9promax_2.df <- data.frame(facto9promax_2)
facto9promax_3.df <- data.frame(facto9promax_3)
facto9promax_4.df <- data.frame(facto9promax_4)
facto9promax_5.df <- data.frame(facto9promax_5)
facto9promax_6.df <- data.frame(facto9promax_6)
facto9promax_7.df <- data.frame(facto9promax_7)
facto9promax_8.df <- data.frame(facto9promax_8)
facto9promax_9.df <- data.frame(facto9promax_9)

facto9promax_1vect <- round(as.vector(facto9promax$loadings[,1][facto9promax_1]),2)
facto9promax_2vect <- round(as.vector(facto9promax$loadings[,2][facto9promax_2]),2)
facto9promax_3vect <- round(as.vector(facto9promax$loadings[,3][facto9promax_3]),2)
facto9promax_4vect <- round(as.vector(facto9promax$loadings[,4][facto9promax_4]),2)
facto9promax_5vect <- round(as.vector(facto9promax$loadings[,5][facto9promax_5]),2)
facto9promax_6vect <- round(as.vector(facto9promax$loadings[,6][facto9promax_6]),2)
facto9promax_7vect <- round(as.vector(facto9promax$loadings[,7][facto9promax_7]),2)
facto9promax_8vect <- round(as.vector(facto9promax$loadings[,8][facto9promax_8]),2)
facto9promax_9vect <- round(as.vector(facto9promax$loadings[,9][facto9promax_9]),2)

facto9promax_1_labels <- apply(facto9promax_1.df, 1, find_label)
facto9promax_2_labels <- apply(facto9promax_2.df, 1, find_label)
facto9promax_3_labels <- apply(facto9promax_3.df, 1, find_label)
facto9promax_4_labels <- apply(facto9promax_4.df, 1, find_label)
facto9promax_5_labels <- apply(facto9promax_5.df, 1, find_label)
facto9promax_6_labels <- apply(facto9promax_6.df, 1, find_label)
facto9promax_7_labels <- apply(facto9promax_7.df, 1, find_label)
facto9promax_8_labels <- apply(facto9promax_8.df, 1, find_label)
facto9promax_9_labels <- apply(facto9promax_9.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto9promax_1table <- data.frame(Item=facto9promax_1, Label=facto9promax_1_labels, Loading=facto9promax_1vect)
facto9promax_1table_ord <- facto9promax_1table[order(facto9promax_1vect, decreasing = TRUE),]
#2
facto9promax_2table <- data.frame(Item=facto9promax_2, Label=facto9promax_2_labels, Loading=facto9promax_2vect)
facto9promax_2table_ord <- facto9promax_2table[order(facto9promax_2vect, decreasing = TRUE),]
#3
facto9promax_3table <- data.frame(Item=facto9promax_3, Label=facto9promax_3_labels, Loading=facto9promax_3vect)
facto9promax_3table_ord <- facto9promax_3table[order(facto9promax_3vect, decreasing = TRUE),]
#4
facto9promax_4table <- data.frame(Item=facto9promax_4, Label=facto9promax_4_labels, Loading=facto9promax_4vect)
facto9promax_4table_ord <- facto9promax_4table[order(facto9promax_4vect, decreasing = TRUE),]
#5
facto9promax_5table <- data.frame(Item=facto9promax_5, Label=facto9promax_5_labels, Loading=facto9promax_5vect)
facto9promax_5table_ord <- facto9promax_5table[order(facto9promax_5vect, decreasing = TRUE),]
#6
facto9promax_6table <- data.frame(Item=facto9promax_6, Label=facto9promax_6_labels, Loading=facto9promax_6vect)
facto9promax_6table_ord <- facto9promax_6table[order(facto9promax_6vect, decreasing = TRUE),]
#7
facto9promax_7table <- data.frame(Item=facto9promax_7, Label=facto9promax_7_labels, Loading=facto9promax_7vect)
facto9promax_7table_ord <- facto9promax_7table[order(facto9promax_7vect, decreasing = TRUE),]
#8
facto9promax_8table <- data.frame(Item=facto9promax_8, Label=facto9promax_8_labels, Loading=facto9promax_8vect)
facto9promax_8table_ord <- facto9promax_8table[order(facto9promax_8vect, decreasing = TRUE),]
#9
facto9promax_9table <- data.frame(Item=facto9promax_9, Label=facto9promax_9_labels, Loading=facto9promax_9vect)
facto9promax_9table_ord <- facto9promax_9table[order(facto9promax_9vect, decreasing = TRUE),]


# nombre d'items par facteurs
n9_promax_1 <- length(facto9promax_1)
n9_promax_2 <- length(facto9promax_2)
n9_promax_3 <- length(facto9promax_3)
n9_promax_4 <- length(facto9promax_4)
n9_promax_5 <- length(facto9promax_5)
n9_promax_6 <- length(facto9promax_6)
n9_promax_7 <- length(facto9promax_7)
n9_promax_8 <- length(facto9promax_8)
n9_promax_9 <- length(facto9promax_9)

n9_promax <- n4_promax_1+n4_promax_2+n4_promax_3+n4_promax_4+n9_promax_5+n9_promax_6+n9_promax_7+n9_promax_8+n9_promax_9 

# Créer les scores factoriels
scores9_promax_1 <- facto9promax$scores[,1]
scores9_promax_2 <- facto9promax$scores[,2]
scores9_promax_3 <- facto9promax$scores[,3]
scores9_promax_4 <- facto9promax$scores[,4]
scores9_promax_5 <- facto9promax$scores[,5]
scores9_promax_6 <- facto9promax$scores[,6]
scores9_promax_7 <- facto9promax$scores[,7]
scores9_promax_8 <- facto9promax$scores[,8]
scores9_promax_9 <- facto9promax$scores[,9]
```

Le RMSEA est égal à `r facto9promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto9promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto9promaxTLI`.
Le premier facteur explique `r facto9_1promax_variance` %, le deuxième explique `r facto9_2promax_variance` %, le troisième `r facto9_3promax_variance` %, le quatrième `r facto9_4promax_variance` %, le cinquième `r facto9_5promax_variance` % , le sixième `r facto9_6promax_variance` %, le septième `r facto9_7promax_variance` %, le huitième `r facto9_8promax_variance` %, le neuvième `r facto9_9promax_variance` %  de la variance totale pour une variance cumulée égale à `r facto9promax_variancecum` %.
Le premier facteur compte `r n9_promax_1` items, le deuxième `r n9_promax_2` items le troisième `r n9_promax_3` items, le quatrième `r n9_promax_4` items, le cinquième `r n9_promax_5` items, le sixième `r n9_promax_6` items, le septième `r n9_promax_7` items, le huitième `r n9_promax_8` items, le neuvième `r n9_promax_9` items pour un total de `r n9_promax` items.

### Facteur 1 : mistreated

```{r}
kable(facto9promax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2promax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto9promax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto9promax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto9promax_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto9promax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto9promax_6table_ord)
```

### Facteur 7 : sexualized

```{r}
kable(facto9promax_7table_ord)
```

### Facteur 8 : distrust

```{r}
kable(facto9promax_8table_ord)
```

### Facteur 9 : overwhelmed

```{r}
kable(facto9promax_9table_ord)
```

## 10 facteurs

```{r}
facto10promax <- fa(items.df, nfactors=10, rotate="promax", use="pairwise")
# print(facto10promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto10promax)
facto10promaxRMSEA <- round(facto10promax$RMSEA[["RMSEA"]],2) 
facto10promaxrmsr <- round(facto10promax$rms,2)
facto10promaxTLI <- round(facto10promax$TLI,2)
facto10_1promax_variance <- round(facto10promax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto10_2promax_variance <- round(facto10promax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto10_3promax_variance <- round(facto10promax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto10_4promax_variance <- round(facto10promax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto10_5promax_variance <- round(facto10promax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto10_6promax_variance <- round(facto10promax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto10_7promax_variance <- round(facto10promax[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto10_8promax_variance <- round(facto10promax[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8
facto10_9promax_variance <- round(facto10promax[["Vaccounted"]][2,9]*100,0) #obtenir la variance expliquée pour le facteur 9
facto10_10promax_variance <- round(facto10promax[["Vaccounted"]][2,10]*100,0) #obtenir la variance expliquée pour le facteur 10

facto10promax_variancecum <- facto10_1promax_variance+facto10_2promax_variance+facto10_3promax_variance+ facto10_4promax_variance+facto10_5promax_variance+facto10_6promax_variance+facto10_7promax_variance+facto10_8promax_variance+facto10_9promax_variance+facto10_10promax_variance 

# Distinguer les facteurs

facto10promax_1 <- which(abs(facto10promax$loadings[,1]) > .30)
facto10promax_2 <- which(abs(facto10promax$loadings[,2]) > .30)
facto10promax_3 <- which(abs(facto10promax$loadings[,3]) > .30)
facto10promax_4 <- which(abs(facto10promax$loadings[,4]) > .30)
facto10promax_5 <- which(abs(facto10promax$loadings[,5]) > .30)
facto10promax_6 <- which(abs(facto10promax$loadings[,6]) > .30)
facto10promax_7 <- which(abs(facto10promax$loadings[,7]) > .30)
facto10promax_8 <- which(abs(facto10promax$loadings[,8]) > .30)
facto10promax_9 <- which(abs(facto10promax$loadings[,9]) > .30)
facto10promax_10 <- which(abs(facto10promax$loadings[,10]) > .30)

facto10promax_1.df <- data.frame(facto10promax_1)
facto10promax_2.df <- data.frame(facto10promax_2)
facto10promax_3.df <- data.frame(facto10promax_3)
facto10promax_4.df <- data.frame(facto10promax_4)
facto10promax_5.df <- data.frame(facto10promax_5)
facto10promax_6.df <- data.frame(facto10promax_6)
facto10promax_7.df <- data.frame(facto10promax_7)
facto10promax_8.df <- data.frame(facto10promax_8)
facto10promax_9.df <- data.frame(facto10promax_9)
facto10promax_10.df <- data.frame(facto10promax_10)

facto10promax_1vect <- round(as.vector(facto10promax$loadings[,1][facto10promax_1]),2)
facto10promax_2vect <- round(as.vector(facto10promax$loadings[,2][facto10promax_2]),2)
facto10promax_3vect <- round(as.vector(facto10promax$loadings[,3][facto10promax_3]),2)
facto10promax_4vect <- round(as.vector(facto10promax$loadings[,4][facto10promax_4]),2)
facto10promax_5vect <- round(as.vector(facto10promax$loadings[,5][facto10promax_5]),2)
facto10promax_6vect <- round(as.vector(facto10promax$loadings[,6][facto10promax_6]),2)
facto10promax_7vect <- round(as.vector(facto10promax$loadings[,7][facto10promax_7]),2)
facto10promax_8vect <- round(as.vector(facto10promax$loadings[,8][facto10promax_8]),2)
facto10promax_9vect <- round(as.vector(facto10promax$loadings[,9][facto10promax_9]),2)
facto10promax_10vect <- round(as.vector(facto10promax$loadings[,10][facto10promax_10]),2)

facto10promax_1_labels <- apply(facto10promax_1.df, 1, find_label)
facto10promax_2_labels <- apply(facto10promax_2.df, 1, find_label)
facto10promax_3_labels <- apply(facto10promax_3.df, 1, find_label)
facto10promax_4_labels <- apply(facto10promax_4.df, 1, find_label)
facto10promax_5_labels <- apply(facto10promax_5.df, 1, find_label)
facto10promax_6_labels <- apply(facto10promax_6.df, 1, find_label)
facto10promax_7_labels <- apply(facto10promax_7.df, 1, find_label)
facto10promax_8_labels <- apply(facto10promax_8.df, 1, find_label)
facto10promax_9_labels <- apply(facto10promax_9.df, 1, find_label)
facto10promax_10_labels <- apply(facto10promax_10.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto10promax_1table <- data.frame(Item=facto10promax_1, Label=facto10promax_1_labels, Loading=facto10promax_1vect)
facto10promax_1table_ord <- facto10promax_1table[order(facto10promax_1vect, decreasing = TRUE),]
#2
facto10promax_2table <- data.frame(Item=facto10promax_2, Label=facto10promax_2_labels, Loading=facto10promax_2vect)
facto10promax_2table_ord <- facto10promax_2table[order(facto10promax_2vect, decreasing = TRUE),]
#3
facto10promax_3table <- data.frame(Item=facto10promax_3, Label=facto10promax_3_labels, Loading=facto10promax_3vect)
facto10promax_3table_ord <- facto10promax_3table[order(facto10promax_3vect, decreasing = TRUE),]
#4
facto10promax_4table <- data.frame(Item=facto10promax_4, Label=facto10promax_4_labels, Loading=facto10promax_4vect)
facto10promax_4table_ord <- facto10promax_4table[order(facto10promax_4vect, decreasing = TRUE),]
#5
facto10promax_5table <- data.frame(Item=facto10promax_5, Label=facto10promax_5_labels, Loading=facto10promax_5vect)
facto10promax_5table_ord <- facto10promax_5table[order(facto10promax_5vect, decreasing = TRUE),]
#6
facto10promax_6table <- data.frame(Item=facto10promax_6, Label=facto10promax_6_labels, Loading=facto10promax_6vect)
facto10promax_6table_ord <- facto10promax_6table[order(facto10promax_6vect, decreasing = TRUE),]
#7
facto10promax_7table <- data.frame(Item=facto10promax_7, Label=facto10promax_7_labels, Loading=facto10promax_7vect)
facto10promax_7table_ord <- facto10promax_7table[order(facto10promax_7vect, decreasing = TRUE),]
#8
facto10promax_8table <- data.frame(Item=facto10promax_8, Label=facto10promax_8_labels, Loading=facto10promax_8vect)
facto10promax_8table_ord <- facto10promax_8table[order(facto10promax_8vect, decreasing = TRUE),]
#9
facto10promax_9table <- data.frame(Item=facto10promax_9, Label=facto10promax_9_labels, Loading=facto10promax_9vect)
facto10promax_9table_ord <- facto10promax_9table[order(facto10promax_9vect, decreasing = TRUE),]
#10
facto10promax_10table <- data.frame(Item=facto10promax_10, Label=facto10promax_10_labels, Loading=facto10promax_10vect)
facto10promax_10table_ord <- facto10promax_10table[order(facto10promax_10vect, decreasing = TRUE),]


# nombre d'items par facteurs
n10_promax_1 <- length(facto10promax_1)
n10_promax_2 <- length(facto10promax_2)
n10_promax_3 <- length(facto10promax_3)
n10_promax_4 <- length(facto10promax_4)
n10_promax_5 <- length(facto10promax_5)
n10_promax_6 <- length(facto10promax_6)
n10_promax_7 <- length(facto10promax_7)
n10_promax_8 <- length(facto10promax_8)
n10_promax_9 <- length(facto10promax_9)
n10_promax_10 <- length(facto10promax_10)

n10_promax <- n4_promax_1+n4_promax_2+n4_promax_3+n4_promax_4+n9_promax_5+n9_promax_6+n9_promax_7+n9_promax_8+n9_promax_9+n10_promax_10 

# Créer les scores factoriels
scores10_promax_1 <- facto10promax$scores[,1]
scores10_promax_2 <- facto10promax$scores[,2]
scores10_promax_3 <- facto10promax$scores[,3]
scores10_promax_4 <- facto10promax$scores[,4]
scores10_promax_5 <- facto10promax$scores[,5]
scores10_promax_6 <- facto10promax$scores[,6]
scores10_promax_7 <- facto10promax$scores[,7]
scores10_promax_8 <- facto10promax$scores[,8]
scores10_promax_9 <- facto10promax$scores[,9]
scores10_promax_10 <- facto10promax$scores[,10]
```

Le RMSEA est égal à `r facto10promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto10promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto10promaxTLI`.
Le premier facteur explique `r facto10_1promax_variance` %, le deuxième explique `r facto10_2promax_variance` %, le troisième `r facto10_3promax_variance` %, le quatrième `r facto10_4promax_variance` %, le cinquième `r facto10_5promax_variance` % , le sixième `r facto10_6promax_variance` %, le septième `r facto10_7promax_variance` %, le huitième `r facto10_8promax_variance` %, le neuvième `r facto10_9promax_variance` %  de la variance totale pour une variance cumulée égale à `r facto10promax_variancecum` %.
Le premier facteur compte `r n9_promax_1` items, le deuxième `r n9_promax_2` items le troisième `r n9_promax_3` items, le quatrième `r n9_promax_4` items, le cinquième `r n9_promax_5` items, le sixième `r n9_promax_6` items, le septième `r n9_promax_7` items, le huitième `r n9_promax_8` items, le neuvième `r n9_promax_9` items pour un total de `r n9_promax` items.

### Facteur 1 : mistreated

```{r}
kable(facto10promax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2promax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto10promax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto10promax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto10promax_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto10promax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto10promax_6table_ord)
```

### Facteur 7 : sexualized

```{r}
kable(facto10promax_7table_ord)
```

### Facteur 8 : distrust

```{r}
kable(facto10promax_8table_ord)
```

### Facteur 9 : personal conflict

```{r}
kable(facto10promax_9table_ord)
```

### Facteur 10 : jalousy

```{r}
kable(facto10promax_10table_ord)
```

## 11 facteurs

```{r}
facto11promax <- fa(items.df, nfactors=11, rotate="promax", use="pairwise")
# print(facto11promax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto11promax)
facto11promaxRMSEA <- round(facto11promax$RMSEA[["RMSEA"]],2) 
facto11promaxrmsr <- round(facto11promax$rms,2)
facto11promaxTLI <- round(facto11promax$TLI,2)
facto11_1promax_variance <- round(facto11promax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto11_2promax_variance <- round(facto11promax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto11_3promax_variance <- round(facto11promax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto11_4promax_variance <- round(facto11promax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto11_5promax_variance <- round(facto11promax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto11_6promax_variance <- round(facto11promax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto11_7promax_variance <- round(facto11promax[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto11_8promax_variance <- round(facto11promax[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8
facto11_9promax_variance <- round(facto11promax[["Vaccounted"]][2,9]*100,0) #obtenir la variance expliquée pour le facteur 9
facto11_10promax_variance <- round(facto11promax[["Vaccounted"]][2,10]*100,0) #obtenir la variance expliquée pour le facteur 10
facto11_11promax_variance <- round(facto11promax[["Vaccounted"]][2,11]*100,0) #obtenir la variance expliquée pour le facteur 11

facto11promax_variancecum <- facto11_1promax_variance+facto11_2promax_variance+facto11_3promax_variance+ facto11_4promax_variance+facto11_5promax_variance+facto11_6promax_variance+facto11_7promax_variance+facto11_8promax_variance+facto11_9promax_variance+facto11_10promax_variance+facto11_11promax_variance 

# Distinguer les facteurs

facto11promax_1 <- which(abs(facto11promax$loadings[,1]) > .30)
facto11promax_2 <- which(abs(facto11promax$loadings[,2]) > .30)
facto11promax_3 <- which(abs(facto11promax$loadings[,3]) > .30)
facto11promax_4 <- which(abs(facto11promax$loadings[,4]) > .30)
facto11promax_5 <- which(abs(facto11promax$loadings[,5]) > .30)
facto11promax_6 <- which(abs(facto11promax$loadings[,6]) > .30)
facto11promax_7 <- which(abs(facto11promax$loadings[,7]) > .30)
facto11promax_8 <- which(abs(facto11promax$loadings[,8]) > .30)
facto11promax_9 <- which(abs(facto11promax$loadings[,9]) > .30)
facto11promax_10 <- which(abs(facto11promax$loadings[,10]) > .30)
facto11promax_11 <- which(abs(facto11promax$loadings[,11]) > .30)

facto11promax_1.df <- data.frame(facto11promax_1)
facto11promax_2.df <- data.frame(facto11promax_2)
facto11promax_3.df <- data.frame(facto11promax_3)
facto11promax_4.df <- data.frame(facto11promax_4)
facto11promax_5.df <- data.frame(facto11promax_5)
facto11promax_6.df <- data.frame(facto11promax_6)
facto11promax_7.df <- data.frame(facto11promax_7)
facto11promax_8.df <- data.frame(facto11promax_8)
facto11promax_9.df <- data.frame(facto11promax_9)
facto11promax_10.df <- data.frame(facto11promax_10)
facto11promax_11.df <- data.frame(facto11promax_11)

facto11promax_1vect <- round(as.vector(facto11promax$loadings[,1][facto11promax_1]),2)
facto11promax_2vect <- round(as.vector(facto11promax$loadings[,2][facto11promax_2]),2)
facto11promax_3vect <- round(as.vector(facto11promax$loadings[,3][facto11promax_3]),2)
facto11promax_4vect <- round(as.vector(facto11promax$loadings[,4][facto11promax_4]),2)
facto11promax_5vect <- round(as.vector(facto11promax$loadings[,5][facto11promax_5]),2)
facto11promax_6vect <- round(as.vector(facto11promax$loadings[,6][facto11promax_6]),2)
facto11promax_7vect <- round(as.vector(facto11promax$loadings[,7][facto11promax_7]),2)
facto11promax_8vect <- round(as.vector(facto11promax$loadings[,8][facto11promax_8]),2)
facto11promax_9vect <- round(as.vector(facto11promax$loadings[,9][facto11promax_9]),2)
facto11promax_10vect <- round(as.vector(facto11promax$loadings[,10][facto11promax_10]),2)
facto11promax_11vect <- round(as.vector(facto11promax$loadings[,11][facto11promax_11]),2)

facto11promax_1_labels <- apply(facto11promax_1.df, 1, find_label)
facto11promax_2_labels <- apply(facto11promax_2.df, 1, find_label)
facto11promax_3_labels <- apply(facto11promax_3.df, 1, find_label)
facto11promax_4_labels <- apply(facto11promax_4.df, 1, find_label)
facto11promax_5_labels <- apply(facto11promax_5.df, 1, find_label)
facto11promax_6_labels <- apply(facto11promax_6.df, 1, find_label)
facto11promax_7_labels <- apply(facto11promax_7.df, 1, find_label)
facto11promax_8_labels <- apply(facto11promax_8.df, 1, find_label)
facto11promax_9_labels <- apply(facto11promax_9.df, 1, find_label)
facto11promax_10_labels <- apply(facto11promax_10.df, 1, find_label)
facto11promax_11_labels <- apply(facto11promax_11.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto11promax_1table <- data.frame(Item=facto11promax_1, Label=facto11promax_1_labels, Loading=facto11promax_1vect)
facto11promax_1table_ord <- facto11promax_1table[order(facto11promax_1vect, decreasing = TRUE),]
#2
facto11promax_2table <- data.frame(Item=facto11promax_2, Label=facto11promax_2_labels, Loading=facto11promax_2vect)
facto11promax_2table_ord <- facto11promax_2table[order(facto11promax_2vect, decreasing = TRUE),]
#3
facto11promax_3table <- data.frame(Item=facto11promax_3, Label=facto11promax_3_labels, Loading=facto11promax_3vect)
facto11promax_3table_ord <- facto11promax_3table[order(facto11promax_3vect, decreasing = TRUE),]
#4
facto11promax_4table <- data.frame(Item=facto11promax_4, Label=facto11promax_4_labels, Loading=facto11promax_4vect)
facto11promax_4table_ord <- facto11promax_4table[order(facto11promax_4vect, decreasing = TRUE),]
#5
facto11promax_5table <- data.frame(Item=facto11promax_5, Label=facto11promax_5_labels, Loading=facto11promax_5vect)
facto11promax_5table_ord <- facto11promax_5table[order(facto11promax_5vect, decreasing = TRUE),]
#6
facto11promax_6table <- data.frame(Item=facto11promax_6, Label=facto11promax_6_labels, Loading=facto11promax_6vect)
facto11promax_6table_ord <- facto11promax_6table[order(facto11promax_6vect, decreasing = TRUE),]
#7
facto11promax_7table <- data.frame(Item=facto11promax_7, Label=facto11promax_7_labels, Loading=facto11promax_7vect)
facto11promax_7table_ord <- facto11promax_7table[order(facto11promax_7vect, decreasing = TRUE),]
#8
facto11promax_8table <- data.frame(Item=facto11promax_8, Label=facto11promax_8_labels, Loading=facto11promax_8vect)
facto11promax_8table_ord <- facto11promax_8table[order(facto11promax_8vect, decreasing = TRUE),]
#9
facto11promax_9table <- data.frame(Item=facto11promax_9, Label=facto11promax_9_labels, Loading=facto11promax_9vect)
facto11promax_9table_ord <- facto11promax_9table[order(facto11promax_9vect, decreasing = TRUE),]
#10
facto11promax_10table <- data.frame(Item=facto11promax_10, Label=facto11promax_10_labels, Loading=facto11promax_10vect)
facto11promax_10table_ord <- facto11promax_10table[order(facto11promax_10vect, decreasing = TRUE),]
#11
facto11promax_11table <- data.frame(Item=facto11promax_11, Label=facto11promax_11_labels, Loading=facto11promax_11vect)
facto11promax_11table_ord <- facto11promax_11table[order(facto11promax_11vect, decreasing = TRUE),]


# nombre d'items par facteurs
n11_promax_1 <- length(facto11promax_1)
n11_promax_2 <- length(facto11promax_2)
n11_promax_3 <- length(facto11promax_3)
n11_promax_4 <- length(facto11promax_4)
n11_promax_5 <- length(facto11promax_5)
n11_promax_6 <- length(facto11promax_6)
n11_promax_7 <- length(facto11promax_7)
n11_promax_8 <- length(facto11promax_8)
n11_promax_9 <- length(facto11promax_9)
n11_promax_10 <- length(facto11promax_10)
n11_promax_11 <- length(facto11promax_11)

n11_promax <- n4_promax_1+n4_promax_2+n4_promax_3+n4_promax_4+n9_promax_5+n9_promax_6+n9_promax_7+n9_promax_8+n9_promax_9+n11_promax_10+n11_promax_11  

# Créer les scores factoriels
scores11_promax_1 <- facto11promax$scores[,1]
scores11_promax_2 <- facto11promax$scores[,2]
scores11_promax_3 <- facto11promax$scores[,3]
scores11_promax_4 <- facto11promax$scores[,4]
scores11_promax_5 <- facto11promax$scores[,5]
scores11_promax_6 <- facto11promax$scores[,6]
scores11_promax_7 <- facto11promax$scores[,7]
scores11_promax_8 <- facto11promax$scores[,8]
scores11_promax_9 <- facto11promax$scores[,9]
scores11_promax_10 <- facto11promax$scores[,10]
scores11_promax_11 <- facto11promax$scores[,11]
```

Le RMSEA est égal à `r facto11promaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto11promaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto11promaxTLI`.
Le premier facteur explique `r facto11_1promax_variance` %, le deuxième explique `r facto11_2promax_variance` %, le troisième `r facto11_3promax_variance` %, le quatrième `r facto11_4promax_variance` %, le cinquième `r facto11_5promax_variance` % , le sixième `r facto11_6promax_variance` %, le septième `r facto11_7promax_variance` %, le huitième `r facto11_8promax_variance` %, le neuvième `r facto11_9promax_variance` %  de la variance totale pour une variance cumulée égale à `r facto11promax_variancecum` %.
Le premier facteur compte `r n9_promax_1` items, le deuxième `r n9_promax_2` items le troisième `r n9_promax_3` items, le quatrième `r n9_promax_4` items, le cinquième `r n9_promax_5` items, le sixième `r n9_promax_6` items, le septième `r n9_promax_7` items, le huitième `r n9_promax_8` items, le neuvième `r n9_promax_9` items pour un total de `r n9_promax` items.

### Facteur 1 : mistreated

```{r}
kable(facto11promax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2promax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto11promax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto11promax_3table_ord)
```

### Facteur 4 : incompetence

```{r}
kable(facto11promax_4table_ord)
```

### Facteur 5 : disengaged

```{r}
kable(facto11promax_5table_ord)
```

### Facteur 6 : loss of professional distance

```{r}
kable(facto11promax_6table_ord)
```

### Facteur 7 : distrust

```{r}
kable(facto11promax_7table_ord)
```

### Facteur 8 : sadeness

```{r}
kable(facto11promax_8table_ord)
```

### Facteur 9 : need to disclose

```{r}
kable(facto11promax_9table_ord)
```

### Facteur 10 : sexualized

```{r}
kable(facto11promax_10table_ord)
```

### Facteur 11 : jalousy

```{r}
kable(facto11promax_11table_ord)
```


## Comparaison des onze modèles promax


```{r include=FALSE}
comparaisonpromax.df <- data.frame(
  Facteurs = c(1,2,3,4,5,6,7,8,9,10,11),
  RMSEA= c(facto1promaxRMSEA,facto2promaxRMSEA,facto3promaxRMSEA,facto4promaxRMSEA,facto5promaxRMSEA,facto6promaxRMSEA,facto7promaxRMSEA,facto8promaxRMSEA,facto9promaxRMSEA,facto10promaxRMSEA,facto11promaxRMSEA),
  RMSR = c(facto1promaxrmsr,facto2promaxrmsr,facto3promaxrmsr,facto4promaxrmsr,facto5promaxrmsr,facto6promaxrmsr,facto7promaxrmsr,facto8promaxrmsr,facto9promaxrmsr,facto10promaxrmsr,facto11promaxrmsr),
  TLI = c(facto1promaxTLI,facto2promaxTLI,facto3promaxTLI,facto4promaxTLI,facto5promaxTLI,facto6promaxTLI,facto7promaxTLI,facto8promaxTLI,facto9promaxTLI,facto10promaxTLI,facto11promaxTLI)
)
```

```{r comparaisonpromax-tab, tidy=FALSE, echo = FALSE}
knitr::kable(
  comparaisonpromax.df, caption = 'Comparaison des fits',
  booktabs = TRUE
)
```

```{r}
ggplot(comparaisonpromax.df) +
 aes(x = Facteurs, y = RMSEA) +
 geom_point(shape = "circle", size = 4L, colour = "#112446") +
 labs(x = "Nombre de facteurs", y = "RMSEA", title = "RMSEA par nombre de facteurs") +
 scale_x_continuous(limits = c(0, 11), breaks = c(1,2,3,4,5,6,7,8,9,10,11)) +
 theme_classic() +
 ylim(0, 0.1)
```

```{r}
ggplot(comparaisonpromax.df) +
 aes(x = Facteurs, y = RMSR) +
 geom_point(shape = "circle", size = 4L, colour = "#112446") +
 labs(x = "Nombre de facteurs", y = "RMSR", title = "RMSR par nombre de facteurs") +
 scale_x_continuous(limits = c(0, 11), breaks = c(1,2,3,4,5,6,7,8,9,10,11)) +
 theme_classic() +
 ylim(0, 0.15)
```

```{r}
ggplot(comparaisonpromax.df) +
 aes(x = Facteurs, y = TLI) +
 geom_point(shape = "circle", size = 4L, colour = "#112446") +
 labs(x = "Nombre de facteurs", y = "Tucker Lewis Index", title = "Tucker Lewis Index par nombre de facteurs") +
 scale_x_continuous(limits = c(0, 11), breaks = c(1,2,3,4,5,6,7,8,9,10,11)) +
 theme_classic() +
 ylim(0, 1)
```


## Corrélations entre les scores factoriels des 11 niveaux promax

```{r}
# 8 niveaux

facto8_promax_scores.df <- data.frame(scores1_promax_1, scores2_promax_1, scores2_promax_2, scores3_promax_1, scores3_promax_2, scores3_promax_3, scores4_promax_1, scores4_promax_2, scores4_promax_3, scores4_promax_4, scores5_promax_1, scores5_promax_2, scores5_promax_3, scores5_promax_4, scores5_promax_5, scores6_promax_1, scores6_promax_2, scores6_promax_3, scores6_promax_4, scores6_promax_5, scores6_promax_6, scores7_promax_1, scores7_promax_2, scores7_promax_3, scores7_promax_4, scores7_promax_5, scores7_promax_6, scores7_promax_7, scores8_promax_1, scores8_promax_2, scores8_promax_3, scores8_promax_4, scores8_promax_5, scores8_promax_6, scores8_promax_7, scores8_promax_8)

facto8_promax_cor_scores <- round(cor(facto8_promax_scores.df, use = "complete.obs"),2)

# 11 niveaux

facto11_promax_scores.df <- data.frame(scores1_promax_1, scores2_promax_1, scores2_promax_2, scores3_promax_1, scores3_promax_2, scores3_promax_3, scores4_promax_1, scores4_promax_2, scores4_promax_3, scores4_promax_4, scores5_promax_1, scores5_promax_2, scores5_promax_3, scores5_promax_4, scores5_promax_5, scores6_promax_1, scores6_promax_2, scores6_promax_3, scores6_promax_4, scores6_promax_5, scores6_promax_6, scores7_promax_1, scores7_promax_2, scores7_promax_3, scores7_promax_4, scores7_promax_5, scores7_promax_6, scores7_promax_7, scores8_promax_1, scores8_promax_2, scores8_promax_3, scores8_promax_4, scores8_promax_5, scores8_promax_6, scores8_promax_7, scores8_promax_8, scores9_promax_1, scores9_promax_2, scores9_promax_3, scores9_promax_4, scores9_promax_5, scores9_promax_6, scores9_promax_7, scores9_promax_8,scores9_promax_9,scores10_promax_1, scores10_promax_2, scores10_promax_3, scores10_promax_4, scores10_promax_5, scores10_promax_6, scores10_promax_7, scores10_promax_8,scores10_promax_9,scores10_promax_10,scores11_promax_1, scores11_promax_2, scores11_promax_3, scores11_promax_4, scores11_promax_5, scores11_promax_6, scores11_promax_7, scores11_promax_8,scores11_promax_9,scores11_promax_10,scores11_promax_11)

facto11_promax_cor_scores <- round(cor(facto11_promax_scores.df, use = "complete.obs"),2)

#kable(facto8_promax_cor_scores)
 
# Créer un fichier excel avec les corrélations entre chaque facteur
wb_promax11 <- createWorkbook()
addWorksheet(wb_promax11, "Correlations")
writeData(wb_promax11, "Correlations", facto11_promax_cor_scores, rowNames = TRUE)
# saveWorkbook(wb_promax11, "correlationsfacto11promax.xlsx")
```

Ce [fichier excel](https://1drv.ms/x/s!AsF5FHJubO7zumwSFHx7W9dwDPit?e=ITKcE3) présente la matrice de corrélations de tous les scores factoriels pour les 11 niveaux.

# Rotation varimax

N = `r N`

## Very Simple Structure

```{r}
# itemscentres <- scale(items.df, center = TRUE) #Centre les variables sur 0
vssmodelesfa <- vss(items.df, rotate = "varimax", use="pairwise")
```

Le Very Simple Structure criterion propose une solution à 3 voire 4 facteurs.


## Method Agreement Procedure

[n_factors](https://easystats.github.io/parameters/reference/n_factors.html) utilise 14 méthodes pour proposer la solution factorielle la plus fréquemment proposée :

```{r}
n_factors_varimax_results <- n_factors(items.df, type = "FA", rotation = "varimax")
plot(n_factors_varimax_results)
```

## 1 facteur

```{r}
facto1varimax <- fa(items.df, nfactors=1, rotate="varimax", use="pairwise")
# print(facto1varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto1varimax)
facto1varimaxRMSEA <- round(facto1varimax$RMSEA[["RMSEA"]],2) 
facto1varimaxrmsr <- round(facto1varimax$rms,2)
facto1varimaxTLI <- round(facto1varimax$TLI,2)
facto1_1varimax_variance <- round(facto1varimax[["Vaccounted"]][2,1]*100,0) #obtenir la 

# Distinguer les facteurs

factor1varimax_1 <- which(abs(facto1varimax$loadings[,1]) > .30)
factor1varimax_1.df <- data.frame(factor1varimax_1)
facto1varimax_1vect <- round(as.vector(facto1varimax$loadings[,1][factor1varimax_1]),2)
facto1varimax_1_labels <- apply(factor1varimax_1.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto1varimax_1table <- data.frame(Item=factor1varimax_1, Label=facto1varimax_1_labels, Loading=facto1varimax_1vect)
facto1varimax_1table_ord <- facto1varimax_1table[order(facto1varimax_1vect, decreasing = TRUE),]


# nombre d'items par facteurs
n1_varimax_1 <- length(factor1varimax_1)


# Créer les scores factoriels
scores1_varimax_1 <- facto1varimax$scores[,1]
```

Le RMSEA est égal à `r facto1varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto1varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto1varimaxTLI`.
Le premier facteur explique `r facto1_1varimax_variance` %.
Le premier facteur compte `r n1_varimax_1` items.

### Facteur 1 : negative emotions

```{r}
kable(facto1varimax_1table_ord)
```

## 2 facteurs

```{r}
facto2varimax <- fa(items.df, nfactors=2, rotate="varimax", use="pairwise")
# print(facto2varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto2varimax)
facto2varimaxRMSEA <- round(facto2varimax$RMSEA[["RMSEA"]],2) 
facto2varimaxrmsr <- round(facto2varimax$rms,2)
facto2varimaxTLI <- round(facto2varimax$TLI,2)
facto2_1varimax_variance <- round(facto2varimax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto2_2varimax_variance <- round(facto2varimax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto2_2varimax_variancecum <- facto2_1varimax_variance+facto2_2varimax_variance

# Distinguer les facteurs

factor2varimax_1 <- which(abs(facto2varimax$loadings[,1]) > .30)
factor2varimax_2 <- which(abs(facto2varimax$loadings[,2]) > .30)
factor2varimax_1.df <- data.frame(factor2varimax_1)
factor2varimax_2.df <- data.frame(factor2varimax_2)
facto2varimax_1vect <- round(as.vector(facto2varimax$loadings[,1][factor2varimax_1]),2)
facto2varimax_2vect <- round(as.vector(facto2varimax$loadings[,2][factor2varimax_2]),2)
facto2varimax_1_labels <- apply(factor2varimax_1.df, 1, find_label)
facto2varimax_2_labels <- apply(factor2varimax_2.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto2varimax_1table <- data.frame(Item=factor2varimax_1, Label=facto2varimax_1_labels, Loading=facto2varimax_1vect)
facto2varimax_1table_ord <- facto2varimax_1table[order(facto2varimax_1vect, decreasing = TRUE),]
#2
facto2varimax_2table <- data.frame(Item=factor2varimax_2, Label=facto2varimax_2_labels, Loading=facto2varimax_2vect)
facto2varimax_2table_ord <- facto2varimax_2table[order(facto2varimax_2vect, decreasing = TRUE),]

# nombre d'items par facteurs
n2_varimax_1 <- length(factor2varimax_1)
n2_varimax_2 <- length(factor2varimax_2)
n2_varimax <- n2_varimax_1+n2_varimax_2

# Créer les scores factoriels
scores2_varimax_1 <- facto2varimax$scores[,1]
scores2_varimax_2 <- facto2varimax$scores[,2]
```

Le RMSEA est égal à `r facto2varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto2varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto2varimaxTLI`.
Le premier facteur explique `r facto2_1varimax_variance` %, le deuxième explique `r facto2_2varimax_variance` % de la variance totale pour une variance cumulée égale à `r facto2_2varimax_variancecum` %.
Le premier facteur compte `r n2_varimax_1` items, le deuxième `r n2_varimax_2` items pour un total de `r n2_varimax` items.

### Facteur 1 : negative emotions

```{r}
kable(facto2varimax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2varimax_1)$total$std.alpha, 2)`
```

### Facteur 2 : clinical implication

```{r}
kable(facto2varimax_2table_ord)
```



## 3 facteurs

```{r}
facto3varimax <- fa(items.df, nfactors=3, rotate="varimax", use="pairwise")
# print(facto3varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto3varimax)
facto3varimaxRMSEA <- round(facto3varimax$RMSEA[["RMSEA"]],2) 
facto3varimaxrmsr <- round(facto3varimax$rms,2)
facto3varimaxTLI <- round(facto3varimax$TLI,2)
facto3_1varimax_variance <- round(facto3varimax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto3_2varimax_variance <- round(facto3varimax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto3_3varimax_variance <- round(facto3varimax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto3varimax_variancecum <- facto3_1varimax_variance+facto3_2varimax_variance+facto3_3varimax_variance

# Distinguer les facteurs

facto3varimax_1 <- which(abs(facto3varimax$loadings[,1]) > .30)
facto3varimax_2 <- which(abs(facto3varimax$loadings[,2]) > .30)
facto3varimax_3 <- which(abs(facto3varimax$loadings[,3]) > .30)
facto3varimax_1.df <- data.frame(facto3varimax_1)
facto3varimax_2.df <- data.frame(facto3varimax_2)
facto3varimax_3.df <- data.frame(facto3varimax_3)
facto3varimax_1vect <- round(as.vector(facto3varimax$loadings[,1][facto3varimax_1]),2)
facto3varimax_2vect <- round(as.vector(facto3varimax$loadings[,2][facto3varimax_2]),2)
facto3varimax_3vect <- round(as.vector(facto3varimax$loadings[,3][facto3varimax_3]),2)
facto3varimax_1_labels <- apply(facto3varimax_1.df, 1, find_label)
facto3varimax_2_labels <- apply(facto3varimax_2.df, 1, find_label)
facto3varimax_3_labels <- apply(facto3varimax_3.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto3varimax_1table <- data.frame(Item=facto3varimax_1, Label=facto3varimax_1_labels, Loading=facto3varimax_1vect)
facto3varimax_1table_ord <- facto3varimax_1table[order(facto3varimax_1vect, decreasing = TRUE),]
#2
facto3varimax_2table <- data.frame(Item=facto3varimax_2, Label=facto3varimax_2_labels, Loading=facto3varimax_2vect)
facto3varimax_2table_ord <- facto3varimax_2table[order(facto3varimax_2vect, decreasing = TRUE),]
#3
facto3varimax_3table <- data.frame(Item=facto3varimax_3, Label=facto3varimax_3_labels, Loading=facto3varimax_3vect)
facto3varimax_3table_ord <- facto3varimax_3table[order(facto3varimax_3vect, decreasing = TRUE),]

# nombre d'items par facteurs
n3_varimax_1 <- length(facto3varimax_1)
n3_varimax_2 <- length(facto3varimax_2)
n3_varimax_3 <- length(facto3varimax_3)
n3_varimax <- n3_varimax_1+n3_varimax_2+n3_varimax_3

# Créer les scores factoriels
scores3_varimax_1 <- facto3varimax$scores[,1]
scores3_varimax_2 <- facto3varimax$scores[,2]
scores3_varimax_3 <- facto3varimax$scores[,3]
```

Le RMSEA est égal à `r facto3varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto3varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto3varimaxTLI`.
Le premier facteur explique `r facto3_1varimax_variance` %, le deuxième explique `r facto3_2varimax_variance` %, le troisième `r facto3_3varimax_variance` % de la variance totale pour une variance cumulée égale à `r facto3varimax_variancecum` %.
Le premier facteur compte `r n3_varimax_1` items, le deuxième `r n3_varimax_2` items le troisième `r n3_varimax_3`  pour un total de `r n3_varimax` items.

### Facteur 1 : incompetence

```{r}
kable(facto3varimax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2varimax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto3varimax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto3varimax_3table_ord)
```

## 4 facteurs

```{r}
facto4varimax <- fa(items.df, nfactors=4, rotate="varimax", use="pairwise")
# print(facto4varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto4varimax)
facto4varimaxRMSEA <- round(facto4varimax$RMSEA[["RMSEA"]],2) 
facto4varimaxrmsr <- round(facto4varimax$rms,2)
facto4varimaxTLI <- round(facto4varimax$TLI,2)
facto4_1varimax_variance <- round(facto4varimax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto4_2varimax_variance <- round(facto4varimax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto4_3varimax_variance <- round(facto4varimax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto4_4varimax_variance <- round(facto4varimax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4

facto4varimax_variancecum <- facto4_1varimax_variance+facto4_2varimax_variance+facto4_3varimax_variance+ facto4_4varimax_variance

# Distinguer les facteurs

facto4varimax_1 <- which(abs(facto4varimax$loadings[,1]) > .30)
facto4varimax_2 <- which(abs(facto4varimax$loadings[,2]) > .30)
facto4varimax_3 <- which(abs(facto4varimax$loadings[,3]) > .30)
facto4varimax_4 <- which(abs(facto4varimax$loadings[,4]) > .30)

facto4varimax_1.df <- data.frame(facto4varimax_1)
facto4varimax_2.df <- data.frame(facto4varimax_2)
facto4varimax_3.df <- data.frame(facto4varimax_3)
facto4varimax_4.df <- data.frame(facto4varimax_4)

facto4varimax_1vect <- round(as.vector(facto4varimax$loadings[,1][facto4varimax_1]),2)
facto4varimax_2vect <- round(as.vector(facto4varimax$loadings[,2][facto4varimax_2]),2)
facto4varimax_3vect <- round(as.vector(facto4varimax$loadings[,3][facto4varimax_3]),2)
facto4varimax_4vect <- round(as.vector(facto4varimax$loadings[,4][facto4varimax_4]),2)

facto4varimax_1_labels <- apply(facto4varimax_1.df, 1, find_label)
facto4varimax_2_labels <- apply(facto4varimax_2.df, 1, find_label)
facto4varimax_3_labels <- apply(facto4varimax_3.df, 1, find_label)
facto4varimax_4_labels <- apply(facto4varimax_4.df, 1, find_label)


# Tableaux pour chaque facteur
# 1
facto4varimax_1table <- data.frame(Item=facto4varimax_1, Label=facto4varimax_1_labels, Loading=facto4varimax_1vect)
facto4varimax_1table_ord <- facto4varimax_1table[order(facto4varimax_1vect, decreasing = TRUE),]
#2
facto4varimax_2table <- data.frame(Item=facto4varimax_2, Label=facto4varimax_2_labels, Loading=facto4varimax_2vect)
facto4varimax_2table_ord <- facto4varimax_2table[order(facto4varimax_2vect, decreasing = TRUE),]
#3
facto4varimax_3table <- data.frame(Item=facto4varimax_3, Label=facto4varimax_3_labels, Loading=facto4varimax_3vect)
facto4varimax_3table_ord <- facto4varimax_3table[order(facto4varimax_3vect, decreasing = TRUE),]
#4
facto4varimax_4table <- data.frame(Item=facto4varimax_4, Label=facto4varimax_4_labels, Loading=facto4varimax_4vect)
facto4varimax_4table_ord <- facto4varimax_4table[order(facto4varimax_4vect, decreasing = TRUE),]

# nombre d'items par facteurs
n4_varimax_1 <- length(facto4varimax_1)
n4_varimax_2 <- length(facto4varimax_2)
n4_varimax_3 <- length(facto4varimax_3)
n4_varimax_4 <- length(facto4varimax_4)

n4_varimax <- n4_varimax_1+n4_varimax_2+n4_varimax_3+n4_varimax_4

# Créer les scores factoriels
scores4_varimax_1 <- facto4varimax$scores[,1]
scores4_varimax_2 <- facto4varimax$scores[,2]
scores4_varimax_3 <- facto4varimax$scores[,3]
scores4_varimax_4 <- facto4varimax$scores[,4]

```

Le RMSEA est égal à `r facto4varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto4varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto4varimaxTLI`.
Le premier facteur explique `r facto4_1varimax_variance` %, le deuxième explique `r facto4_2varimax_variance` %, le troisième `r facto4_3varimax_variance` % de la variance totale pour une variance cumulée égale à `r facto4varimax_variancecum` %.
Le premier facteur compte `r n4_varimax_1` items, le deuxième `r n4_varimax_2` items le troisième `r n4_varimax_3` , le quatrième `r n4_varimax_4` pour un total de `r n4_varimax` items.

### Facteur 1 : incompetence

```{r}
kable(facto4varimax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2varimax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto4varimax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto4varimax_3table_ord)
```

### Facteur 4 : loss of professionnal distance

```{r}
kable(facto4varimax_4table_ord)
```


## 5 facteurs

```{r}
facto5varimax <- fa(items.df, nfactors=5, rotate="varimax", use="pairwise")
# print(facto5varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto5varimax)
facto5varimaxRMSEA <- round(facto5varimax$RMSEA[["RMSEA"]],2) 
facto5varimaxrmsr <- round(facto5varimax$rms,2)
facto5varimaxTLI <- round(facto5varimax$TLI,2)
facto5_1varimax_variance <- round(facto5varimax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto5_2varimax_variance <- round(facto5varimax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto5_3varimax_variance <- round(facto5varimax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto5_4varimax_variance <- round(facto5varimax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto5_5varimax_variance <- round(facto5varimax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5

facto5varimax_variancecum <- facto5_1varimax_variance+facto5_2varimax_variance+facto5_3varimax_variance+ facto5_4varimax_variance+facto5_5varimax_variance

# Distinguer les facteurs

facto5varimax_1 <- which(abs(facto5varimax$loadings[,1]) > .30)
facto5varimax_2 <- which(abs(facto5varimax$loadings[,2]) > .30)
facto5varimax_3 <- which(abs(facto5varimax$loadings[,3]) > .30)
facto5varimax_4 <- which(abs(facto5varimax$loadings[,4]) > .30)
facto5varimax_5 <- which(abs(facto5varimax$loadings[,5]) > .30)

facto5varimax_1.df <- data.frame(facto5varimax_1)
facto5varimax_2.df <- data.frame(facto5varimax_2)
facto5varimax_3.df <- data.frame(facto5varimax_3)
facto5varimax_4.df <- data.frame(facto5varimax_4)
facto5varimax_5.df <- data.frame(facto5varimax_5)

facto5varimax_1vect <- round(as.vector(facto5varimax$loadings[,1][facto5varimax_1]),2)
facto5varimax_2vect <- round(as.vector(facto5varimax$loadings[,2][facto5varimax_2]),2)
facto5varimax_3vect <- round(as.vector(facto5varimax$loadings[,3][facto5varimax_3]),2)
facto5varimax_4vect <- round(as.vector(facto5varimax$loadings[,4][facto5varimax_4]),2)
facto5varimax_5vect <- round(as.vector(facto5varimax$loadings[,5][facto5varimax_5]),2)

facto5varimax_1_labels <- apply(facto5varimax_1.df, 1, find_label)
facto5varimax_2_labels <- apply(facto5varimax_2.df, 1, find_label)
facto5varimax_3_labels <- apply(facto5varimax_3.df, 1, find_label)
facto5varimax_4_labels <- apply(facto5varimax_4.df, 1, find_label)
facto5varimax_5_labels <- apply(facto5varimax_5.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto5varimax_1table <- data.frame(Item=facto5varimax_1, Label=facto5varimax_1_labels, Loading=facto5varimax_1vect)
facto5varimax_1table_ord <- facto5varimax_1table[order(facto5varimax_1vect, decreasing = TRUE),]
#2
facto5varimax_2table <- data.frame(Item=facto5varimax_2, Label=facto5varimax_2_labels, Loading=facto5varimax_2vect)
facto5varimax_2table_ord <- facto5varimax_2table[order(facto5varimax_2vect, decreasing = TRUE),]
#3
facto5varimax_3table <- data.frame(Item=facto5varimax_3, Label=facto5varimax_3_labels, Loading=facto5varimax_3vect)
facto5varimax_3table_ord <- facto5varimax_3table[order(facto5varimax_3vect, decreasing = TRUE),]
#4
facto5varimax_4table <- data.frame(Item=facto5varimax_4, Label=facto5varimax_4_labels, Loading=facto5varimax_4vect)
facto5varimax_4table_ord <- facto5varimax_4table[order(facto5varimax_4vect, decreasing = TRUE),]
#5
facto5varimax_5table <- data.frame(Item=facto5varimax_5, Label=facto5varimax_5_labels, Loading=facto5varimax_5vect)
facto5varimax_5table_ord <- facto5varimax_5table[order(facto5varimax_5vect, decreasing = TRUE),]

# nombre d'items par facteurs
n5_varimax_1 <- length(facto5varimax_1)
n5_varimax_2 <- length(facto5varimax_2)
n5_varimax_3 <- length(facto5varimax_3)
n5_varimax_4 <- length(facto5varimax_4)
n5_varimax_5 <- length(facto5varimax_5)

n5_varimax <- n4_varimax_1+n4_varimax_2+n4_varimax_3+n4_varimax_4+n5_varimax_5

# Créer les scores factoriels
scores5_varimax_1 <- facto5varimax$scores[,1]
scores5_varimax_2 <- facto5varimax$scores[,2]
scores5_varimax_3 <- facto5varimax$scores[,3]
scores5_varimax_4 <- facto5varimax$scores[,4]
scores5_varimax_5 <- facto5varimax$scores[,5]

```

Le RMSEA est égal à `r facto5varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto5varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto5varimaxTLI`.
Le premier facteur explique `r facto5_1varimax_variance` %, le deuxième explique `r facto5_2varimax_variance` %, le troisième `r facto5_3varimax_variance` %, la quatrième `r facto5_4varimax_variance` %, le cinquième `r facto5_5varimax_variance` % de la variance totale pour une variance cumulée égale à `r facto5varimax_variancecum` %.
Le premier facteur compte `r n5_varimax_1` items, le deuxième `r n5_varimax_2` items le troisième `r n5_varimax_3` items, le quatrième `r n5_varimax_4` items, le cinquième `r n5_varimax_5` items, pour un total de `r n5_varimax` items.

### Facteur 1 : overwhelmed

```{r}
kable(facto5varimax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2varimax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto5varimax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto5varimax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto5varimax_4table_ord)
```

### Facteur 5 : seduction

```{r}
kable(facto5varimax_5table_ord)
```

## 6 facteurs

```{r}
facto6varimax <- fa(items.df, nfactors=6, rotate="varimax", use="pairwise")
# print(facto6varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto6varimax)
facto6varimaxRMSEA <- round(facto6varimax$RMSEA[["RMSEA"]],2) 
facto6varimaxrmsr <- round(facto6varimax$rms,2)
facto6varimaxTLI <- round(facto6varimax$TLI,2)
facto6_1varimax_variance <- round(facto6varimax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto6_2varimax_variance <- round(facto6varimax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto6_3varimax_variance <- round(facto6varimax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto6_4varimax_variance <- round(facto6varimax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto6_5varimax_variance <- round(facto6varimax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto6_6varimax_variance <- round(facto6varimax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6

facto6varimax_variancecum <- facto6_1varimax_variance+facto6_2varimax_variance+facto6_3varimax_variance+ facto6_4varimax_variance+facto6_5varimax_variance+facto6_6varimax_variance

# Distinguer les facteurs

facto6varimax_1 <- which(abs(facto6varimax$loadings[,1]) > .30)
facto6varimax_2 <- which(abs(facto6varimax$loadings[,2]) > .30)
facto6varimax_3 <- which(abs(facto6varimax$loadings[,3]) > .30)
facto6varimax_4 <- which(abs(facto6varimax$loadings[,4]) > .30)
facto6varimax_5 <- which(abs(facto6varimax$loadings[,5]) > .30)
facto6varimax_6 <- which(abs(facto6varimax$loadings[,6]) > .30)

facto6varimax_1.df <- data.frame(facto6varimax_1)
facto6varimax_2.df <- data.frame(facto6varimax_2)
facto6varimax_3.df <- data.frame(facto6varimax_3)
facto6varimax_4.df <- data.frame(facto6varimax_4)
facto6varimax_5.df <- data.frame(facto6varimax_5)
facto6varimax_6.df <- data.frame(facto6varimax_6)

facto6varimax_1vect <- round(as.vector(facto6varimax$loadings[,1][facto6varimax_1]),2)
facto6varimax_2vect <- round(as.vector(facto6varimax$loadings[,2][facto6varimax_2]),2)
facto6varimax_3vect <- round(as.vector(facto6varimax$loadings[,3][facto6varimax_3]),2)
facto6varimax_4vect <- round(as.vector(facto6varimax$loadings[,4][facto6varimax_4]),2)
facto6varimax_5vect <- round(as.vector(facto6varimax$loadings[,5][facto6varimax_5]),2)
facto6varimax_6vect <- round(as.vector(facto6varimax$loadings[,6][facto6varimax_6]),2)

facto6varimax_1_labels <- apply(facto6varimax_1.df, 1, find_label)
facto6varimax_2_labels <- apply(facto6varimax_2.df, 1, find_label)
facto6varimax_3_labels <- apply(facto6varimax_3.df, 1, find_label)
facto6varimax_4_labels <- apply(facto6varimax_4.df, 1, find_label)
facto6varimax_5_labels <- apply(facto6varimax_5.df, 1, find_label)
facto6varimax_6_labels <- apply(facto6varimax_6.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto6varimax_1table <- data.frame(Item=facto6varimax_1, Label=facto6varimax_1_labels, Loading=facto6varimax_1vect)
facto6varimax_1table_ord <- facto6varimax_1table[order(facto6varimax_1vect, decreasing = TRUE),]
#2
facto6varimax_2table <- data.frame(Item=facto6varimax_2, Label=facto6varimax_2_labels, Loading=facto6varimax_2vect)
facto6varimax_2table_ord <- facto6varimax_2table[order(facto6varimax_2vect, decreasing = TRUE),]
#3
facto6varimax_3table <- data.frame(Item=facto6varimax_3, Label=facto6varimax_3_labels, Loading=facto6varimax_3vect)
facto6varimax_3table_ord <- facto6varimax_3table[order(facto6varimax_3vect, decreasing = TRUE),]
#4
facto6varimax_4table <- data.frame(Item=facto6varimax_4, Label=facto6varimax_4_labels, Loading=facto6varimax_4vect)
facto6varimax_4table_ord <- facto6varimax_4table[order(facto6varimax_4vect, decreasing = TRUE),]
#5
facto6varimax_5table <- data.frame(Item=facto6varimax_5, Label=facto6varimax_5_labels, Loading=facto6varimax_5vect)
facto6varimax_5table_ord <- facto6varimax_5table[order(facto6varimax_5vect, decreasing = TRUE),]
#6
facto6varimax_6table <- data.frame(Item=facto6varimax_6, Label=facto6varimax_6_labels, Loading=facto6varimax_6vect)
facto6varimax_6table_ord <- facto6varimax_6table[order(facto6varimax_6vect, decreasing = TRUE),]


# nombre d'items par facteurs
n6_varimax_1 <- length(facto6varimax_1)
n6_varimax_2 <- length(facto6varimax_2)
n6_varimax_3 <- length(facto6varimax_3)
n6_varimax_4 <- length(facto6varimax_4)
n6_varimax_5 <- length(facto6varimax_5)
n6_varimax_6 <- length(facto6varimax_6)

n6_varimax <- n4_varimax_1+n4_varimax_2+n4_varimax_3+n4_varimax_4+n6_varimax_5+n6_varimax_6

# Créer les scores factoriels
scores6_varimax_1 <- facto6varimax$scores[,1]
scores6_varimax_2 <- facto6varimax$scores[,2]
scores6_varimax_3 <- facto6varimax$scores[,3]
scores6_varimax_4 <- facto6varimax$scores[,4]
scores6_varimax_5 <- facto6varimax$scores[,5]
scores6_varimax_6 <- facto6varimax$scores[,6]
```

Le RMSEA est égal à `r facto6varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto6varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto6varimaxTLI`.
Le premier facteur explique `r facto6_1varimax_variance` %, le deuxième explique `r facto6_2varimax_variance` %, le troisième `r facto6_3varimax_variance` %, le quatrième `r facto6_4varimax_variance` %, le cinquième `r facto6_5varimax_variance` % , le sixième `r facto6_6varimax_variance` % de la variance totale pour une variance cumulée égale à `r facto6varimax_variancecum` %.
Le premier facteur compte `r n6_varimax_1` items, le deuxième `r n6_varimax_2` items le troisième `r n6_varimax_3` items, le quatrième `r n6_varimax_4` items, le cinquième `r n6_varimax_5` items, le sixième `r n6_varimax_6` items pour un total de `r n6_varimax` items.

### Facteur 1 : overwhelmed

```{r}
kable(facto6varimax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2varimax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto6varimax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto6varimax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto6varimax_4table_ord)
```

### Facteur 5 : sexualized

```{r}
kable(facto6varimax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto6varimax_6table_ord)
```

## 7 facteurs

```{r}
facto7varimax <- fa(items.df, nfactors=7, rotate="varimax", use="pairwise")
# print(facto7varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto7varimax)
facto7varimaxRMSEA <- round(facto7varimax$RMSEA[["RMSEA"]],2) 
facto7varimaxrmsr <- round(facto7varimax$rms,2)
facto7varimaxTLI <- round(facto7varimax$TLI,2)
facto7_1varimax_variance <- round(facto7varimax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto7_2varimax_variance <- round(facto7varimax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto7_3varimax_variance <- round(facto7varimax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto7_4varimax_variance <- round(facto7varimax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto7_5varimax_variance <- round(facto7varimax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto7_6varimax_variance <- round(facto7varimax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto7_7varimax_variance <- round(facto7varimax[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7

facto7varimax_variancecum <- facto7_1varimax_variance+facto7_2varimax_variance+facto7_3varimax_variance+ facto7_4varimax_variance+facto7_5varimax_variance+facto7_6varimax_variance+facto7_7varimax_variance

# Distinguer les facteurs

facto7varimax_1 <- which(abs(facto7varimax$loadings[,1]) > .30)
facto7varimax_2 <- which(abs(facto7varimax$loadings[,2]) > .30)
facto7varimax_3 <- which(abs(facto7varimax$loadings[,3]) > .30)
facto7varimax_4 <- which(abs(facto7varimax$loadings[,4]) > .30)
facto7varimax_5 <- which(abs(facto7varimax$loadings[,5]) > .30)
facto7varimax_6 <- which(abs(facto7varimax$loadings[,6]) > .30)
facto7varimax_7 <- which(abs(facto7varimax$loadings[,7]) > .30)

facto7varimax_1.df <- data.frame(facto7varimax_1)
facto7varimax_2.df <- data.frame(facto7varimax_2)
facto7varimax_3.df <- data.frame(facto7varimax_3)
facto7varimax_4.df <- data.frame(facto7varimax_4)
facto7varimax_5.df <- data.frame(facto7varimax_5)
facto7varimax_6.df <- data.frame(facto7varimax_6)
facto7varimax_7.df <- data.frame(facto7varimax_7)

facto7varimax_1vect <- round(as.vector(facto7varimax$loadings[,1][facto7varimax_1]),2)
facto7varimax_2vect <- round(as.vector(facto7varimax$loadings[,2][facto7varimax_2]),2)
facto7varimax_3vect <- round(as.vector(facto7varimax$loadings[,3][facto7varimax_3]),2)
facto7varimax_4vect <- round(as.vector(facto7varimax$loadings[,4][facto7varimax_4]),2)
facto7varimax_5vect <- round(as.vector(facto7varimax$loadings[,5][facto7varimax_5]),2)
facto7varimax_6vect <- round(as.vector(facto7varimax$loadings[,6][facto7varimax_6]),2)
facto7varimax_7vect <- round(as.vector(facto7varimax$loadings[,7][facto7varimax_7]),2)

facto7varimax_1_labels <- apply(facto7varimax_1.df, 1, find_label)
facto7varimax_2_labels <- apply(facto7varimax_2.df, 1, find_label)
facto7varimax_3_labels <- apply(facto7varimax_3.df, 1, find_label)
facto7varimax_4_labels <- apply(facto7varimax_4.df, 1, find_label)
facto7varimax_5_labels <- apply(facto7varimax_5.df, 1, find_label)
facto7varimax_6_labels <- apply(facto7varimax_6.df, 1, find_label)
facto7varimax_7_labels <- apply(facto7varimax_7.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto7varimax_1table <- data.frame(Item=facto7varimax_1, Label=facto7varimax_1_labels, Loading=facto7varimax_1vect)
facto7varimax_1table_ord <- facto7varimax_1table[order(facto7varimax_1vect, decreasing = TRUE),]
#2
facto7varimax_2table <- data.frame(Item=facto7varimax_2, Label=facto7varimax_2_labels, Loading=facto7varimax_2vect)
facto7varimax_2table_ord <- facto7varimax_2table[order(facto7varimax_2vect, decreasing = TRUE),]
#3
facto7varimax_3table <- data.frame(Item=facto7varimax_3, Label=facto7varimax_3_labels, Loading=facto7varimax_3vect)
facto7varimax_3table_ord <- facto7varimax_3table[order(facto7varimax_3vect, decreasing = TRUE),]
#4
facto7varimax_4table <- data.frame(Item=facto7varimax_4, Label=facto7varimax_4_labels, Loading=facto7varimax_4vect)
facto7varimax_4table_ord <- facto7varimax_4table[order(facto7varimax_4vect, decreasing = TRUE),]
#5
facto7varimax_5table <- data.frame(Item=facto7varimax_5, Label=facto7varimax_5_labels, Loading=facto7varimax_5vect)
facto7varimax_5table_ord <- facto7varimax_5table[order(facto7varimax_5vect, decreasing = TRUE),]
#6
facto7varimax_6table <- data.frame(Item=facto7varimax_6, Label=facto7varimax_6_labels, Loading=facto7varimax_6vect)
facto7varimax_6table_ord <- facto7varimax_6table[order(facto7varimax_6vect, decreasing = TRUE),]
#7
facto7varimax_7table <- data.frame(Item=facto7varimax_7, Label=facto7varimax_7_labels, Loading=facto7varimax_7vect)
facto7varimax_7table_ord <- facto7varimax_7table[order(facto7varimax_7vect, decreasing = TRUE),]


# nombre d'items par facteurs
n7_varimax_1 <- length(facto7varimax_1)
n7_varimax_2 <- length(facto7varimax_2)
n7_varimax_3 <- length(facto7varimax_3)
n7_varimax_4 <- length(facto7varimax_4)
n7_varimax_5 <- length(facto7varimax_5)
n7_varimax_6 <- length(facto7varimax_6)
n7_varimax_7 <- length(facto7varimax_7)

n7_varimax <- n4_varimax_1+n4_varimax_2+n4_varimax_3+n4_varimax_4+n7_varimax_5+n7_varimax_6+n7_varimax_7

# Créer les scores factoriels
scores7_varimax_1 <- facto7varimax$scores[,1]
scores7_varimax_2 <- facto7varimax$scores[,2]
scores7_varimax_3 <- facto7varimax$scores[,3]
scores7_varimax_4 <- facto7varimax$scores[,4]
scores7_varimax_5 <- facto7varimax$scores[,5]
scores7_varimax_6 <- facto7varimax$scores[,6]
scores7_varimax_7 <- facto7varimax$scores[,7]
```

Le RMSEA est égal à `r facto7varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto7varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto7varimaxTLI`.
Le premier facteur explique `r facto7_1varimax_variance` %, le deuxième explique `r facto7_2varimax_variance` %, le troisième `r facto7_3varimax_variance` %, le quatrième `r facto7_4varimax_variance` %, le cinquième `r facto7_5varimax_variance` % , le sixième `r facto7_6varimax_variance` %, le septième `r facto7_7varimax_variance` % de la variance totale pour une variance cumulée égale à `r facto7varimax_variancecum` %.
Le premier facteur compte `r n7_varimax_1` items, le deuxième `r n7_varimax_2` items le troisième `r n7_varimax_3` items, le quatrième `r n7_varimax_4` items, le cinquième `r n7_varimax_5` items, le sixième `r n7_varimax_6` items, le septième `r n7_varimax_7` items pour un total de `r n7_varimax` items.

### Facteur 1 : mistreated

```{r}
kable(facto7varimax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2varimax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto7varimax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto7varimax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto7varimax_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto7varimax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto7varimax_6table_ord)
```

### Facteur 7 : sexualized

```{r}
kable(facto7varimax_7table_ord)
```

## 8 facteurs

```{r}
facto8varimax <- fa(items.df, nfactors=8, rotate="varimax", use="pairwise")
# print(facto8varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto8varimax)
facto8varimaxRMSEA <- round(facto8varimax$RMSEA[["RMSEA"]],2) 
facto8varimaxrmsr <- round(facto8varimax$rms,2)
facto8varimaxTLI <- round(facto8varimax$TLI,2)
facto8_1varimax_variance <- round(facto8varimax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto8_2varimax_variance <- round(facto8varimax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto8_3varimax_variance <- round(facto8varimax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto8_4varimax_variance <- round(facto8varimax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto8_5varimax_variance <- round(facto8varimax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto8_6varimax_variance <- round(facto8varimax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto8_7varimax_variance <- round(facto8varimax[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto8_8varimax_variance <- round(facto8varimax[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8

facto8varimax_variancecum <- facto8_1varimax_variance+facto8_2varimax_variance+facto8_3varimax_variance+ facto8_4varimax_variance+facto8_5varimax_variance+facto8_6varimax_variance+facto8_7varimax_variance+facto8_8varimax_variance

# Distinguer les facteurs

facto8varimax_1 <- which(abs(facto8varimax$loadings[,1]) > .30)
facto8varimax_2 <- which(abs(facto8varimax$loadings[,2]) > .30)
facto8varimax_3 <- which(abs(facto8varimax$loadings[,3]) > .30)
facto8varimax_4 <- which(abs(facto8varimax$loadings[,4]) > .30)
facto8varimax_5 <- which(abs(facto8varimax$loadings[,5]) > .30)
facto8varimax_6 <- which(abs(facto8varimax$loadings[,6]) > .30)
facto8varimax_7 <- which(abs(facto8varimax$loadings[,7]) > .30)
facto8varimax_8 <- which(abs(facto8varimax$loadings[,8]) > .30)

facto8varimax_1.df <- data.frame(facto8varimax_1)
facto8varimax_2.df <- data.frame(facto8varimax_2)
facto8varimax_3.df <- data.frame(facto8varimax_3)
facto8varimax_4.df <- data.frame(facto8varimax_4)
facto8varimax_5.df <- data.frame(facto8varimax_5)
facto8varimax_6.df <- data.frame(facto8varimax_6)
facto8varimax_7.df <- data.frame(facto8varimax_7)
facto8varimax_8.df <- data.frame(facto8varimax_8)

facto8varimax_1vect <- round(as.vector(facto8varimax$loadings[,1][facto8varimax_1]),2)
facto8varimax_2vect <- round(as.vector(facto8varimax$loadings[,2][facto8varimax_2]),2)
facto8varimax_3vect <- round(as.vector(facto8varimax$loadings[,3][facto8varimax_3]),2)
facto8varimax_4vect <- round(as.vector(facto8varimax$loadings[,4][facto8varimax_4]),2)
facto8varimax_5vect <- round(as.vector(facto8varimax$loadings[,5][facto8varimax_5]),2)
facto8varimax_6vect <- round(as.vector(facto8varimax$loadings[,6][facto8varimax_6]),2)
facto8varimax_7vect <- round(as.vector(facto8varimax$loadings[,7][facto8varimax_7]),2)
facto8varimax_8vect <- round(as.vector(facto8varimax$loadings[,8][facto8varimax_8]),2)

facto8varimax_1_labels <- apply(facto8varimax_1.df, 1, find_label)
facto8varimax_2_labels <- apply(facto8varimax_2.df, 1, find_label)
facto8varimax_3_labels <- apply(facto8varimax_3.df, 1, find_label)
facto8varimax_4_labels <- apply(facto8varimax_4.df, 1, find_label)
facto8varimax_5_labels <- apply(facto8varimax_5.df, 1, find_label)
facto8varimax_6_labels <- apply(facto8varimax_6.df, 1, find_label)
facto8varimax_7_labels <- apply(facto8varimax_7.df, 1, find_label)
facto8varimax_8_labels <- apply(facto8varimax_8.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto8varimax_1table <- data.frame(Item=facto8varimax_1, Label=facto8varimax_1_labels, Loading=facto8varimax_1vect)
facto8varimax_1table_ord <- facto8varimax_1table[order(facto8varimax_1vect, decreasing = TRUE),]
#2
facto8varimax_2table <- data.frame(Item=facto8varimax_2, Label=facto8varimax_2_labels, Loading=facto8varimax_2vect)
facto8varimax_2table_ord <- facto8varimax_2table[order(facto8varimax_2vect, decreasing = TRUE),]
#3
facto8varimax_3table <- data.frame(Item=facto8varimax_3, Label=facto8varimax_3_labels, Loading=facto8varimax_3vect)
facto8varimax_3table_ord <- facto8varimax_3table[order(facto8varimax_3vect, decreasing = TRUE),]
#4
facto8varimax_4table <- data.frame(Item=facto8varimax_4, Label=facto8varimax_4_labels, Loading=facto8varimax_4vect)
facto8varimax_4table_ord <- facto8varimax_4table[order(facto8varimax_4vect, decreasing = TRUE),]
#5
facto8varimax_5table <- data.frame(Item=facto8varimax_5, Label=facto8varimax_5_labels, Loading=facto8varimax_5vect)
facto8varimax_5table_ord <- facto8varimax_5table[order(facto8varimax_5vect, decreasing = TRUE),]
#6
facto8varimax_6table <- data.frame(Item=facto8varimax_6, Label=facto8varimax_6_labels, Loading=facto8varimax_6vect)
facto8varimax_6table_ord <- facto8varimax_6table[order(facto8varimax_6vect, decreasing = TRUE),]
#7
facto8varimax_7table <- data.frame(Item=facto8varimax_7, Label=facto8varimax_7_labels, Loading=facto8varimax_7vect)
facto8varimax_7table_ord <- facto8varimax_7table[order(facto8varimax_7vect, decreasing = TRUE),]
#8
facto8varimax_8table <- data.frame(Item=facto8varimax_8, Label=facto8varimax_8_labels, Loading=facto8varimax_8vect)
facto8varimax_8table_ord <- facto8varimax_8table[order(facto8varimax_8vect, decreasing = TRUE),]


# nombre d'items par facteurs
n8_varimax_1 <- length(facto8varimax_1)
n8_varimax_2 <- length(facto8varimax_2)
n8_varimax_3 <- length(facto8varimax_3)
n8_varimax_4 <- length(facto8varimax_4)
n8_varimax_5 <- length(facto8varimax_5)
n8_varimax_6 <- length(facto8varimax_6)
n8_varimax_7 <- length(facto8varimax_7)
n8_varimax_8 <- length(facto8varimax_8)

n8_varimax <- n4_varimax_1+n4_varimax_2+n4_varimax_3+n4_varimax_4+n8_varimax_5+n8_varimax_6+n8_varimax_7+n8_varimax_8

# Créer les scores factoriels
scores8_varimax_1 <- facto8varimax$scores[,1]
scores8_varimax_2 <- facto8varimax$scores[,2]
scores8_varimax_3 <- facto8varimax$scores[,3]
scores8_varimax_4 <- facto8varimax$scores[,4]
scores8_varimax_5 <- facto8varimax$scores[,5]
scores8_varimax_6 <- facto8varimax$scores[,6]
scores8_varimax_7 <- facto8varimax$scores[,7]
scores8_varimax_8 <- facto8varimax$scores[,8]
```

Le RMSEA est égal à `r facto8varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto8varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto8varimaxTLI`.
Le premier facteur explique `r facto8_1varimax_variance` %, le deuxième explique `r facto8_2varimax_variance` %, le troisième `r facto8_3varimax_variance` %, le quatrième `r facto8_4varimax_variance` %, le cinquième `r facto8_5varimax_variance` % , le sixième `r facto8_6varimax_variance` %, le septième `r facto8_7varimax_variance` %, le huitième `r facto8_8varimax_variance` %  de la variance totale pour une variance cumulée égale à `r facto8varimax_variancecum` %.
Le premier facteur compte `r n8_varimax_1` items, le deuxième `r n8_varimax_2` items le troisième `r n8_varimax_3` items, le quatrième `r n8_varimax_4` items, le cinquième `r n8_varimax_5` items, le sixième `r n8_varimax_6` items, le septième `r n8_varimax_7` items, le huitième `r n8_varimax_8` items pour un total de `r n8_varimax` items.

### Facteur 1 : mistreated

```{r}
kable(facto8varimax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2varimax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto8varimax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto8varimax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto8varimax_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto8varimax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto8varimax_6table_ord)
```

### Facteur 7 : sexualized

```{r}
kable(facto8varimax_7table_ord)
```

### Facteur 8 : distrust

```{r}
kable(facto8varimax_8table_ord)
```

## 9 facteurs

```{r}
facto9varimax <- fa(items.df, nfactors=9, rotate="varimax", use="pairwise")
# print(facto9varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto9varimax)
facto9varimaxRMSEA <- round(facto9varimax$RMSEA[["RMSEA"]],2) 
facto9varimaxrmsr <- round(facto9varimax$rms,2)
facto9varimaxTLI <- round(facto9varimax$TLI,2)
facto9_1varimax_variance <- round(facto9varimax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto9_2varimax_variance <- round(facto9varimax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto9_3varimax_variance <- round(facto9varimax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto9_4varimax_variance <- round(facto9varimax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto9_5varimax_variance <- round(facto9varimax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto9_6varimax_variance <- round(facto9varimax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto9_7varimax_variance <- round(facto9varimax[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto9_8varimax_variance <- round(facto9varimax[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8
facto9_9varimax_variance <- round(facto9varimax[["Vaccounted"]][2,9]*100,0) #obtenir la variance expliquée pour le facteur 9

facto9varimax_variancecum <- facto9_1varimax_variance+facto9_2varimax_variance+facto9_3varimax_variance+ facto9_4varimax_variance+facto9_5varimax_variance+facto9_6varimax_variance+facto9_7varimax_variance+facto9_8varimax_variance+facto9_9varimax_variance 

# Distinguer les facteurs

facto9varimax_1 <- which(abs(facto9varimax$loadings[,1]) > .30)
facto9varimax_2 <- which(abs(facto9varimax$loadings[,2]) > .30)
facto9varimax_3 <- which(abs(facto9varimax$loadings[,3]) > .30)
facto9varimax_4 <- which(abs(facto9varimax$loadings[,4]) > .30)
facto9varimax_5 <- which(abs(facto9varimax$loadings[,5]) > .30)
facto9varimax_6 <- which(abs(facto9varimax$loadings[,6]) > .30)
facto9varimax_7 <- which(abs(facto9varimax$loadings[,7]) > .30)
facto9varimax_8 <- which(abs(facto9varimax$loadings[,8]) > .30)
facto9varimax_9 <- which(abs(facto9varimax$loadings[,9]) > .30)

facto9varimax_1.df <- data.frame(facto9varimax_1)
facto9varimax_2.df <- data.frame(facto9varimax_2)
facto9varimax_3.df <- data.frame(facto9varimax_3)
facto9varimax_4.df <- data.frame(facto9varimax_4)
facto9varimax_5.df <- data.frame(facto9varimax_5)
facto9varimax_6.df <- data.frame(facto9varimax_6)
facto9varimax_7.df <- data.frame(facto9varimax_7)
facto9varimax_8.df <- data.frame(facto9varimax_8)
facto9varimax_9.df <- data.frame(facto9varimax_9)

facto9varimax_1vect <- round(as.vector(facto9varimax$loadings[,1][facto9varimax_1]),2)
facto9varimax_2vect <- round(as.vector(facto9varimax$loadings[,2][facto9varimax_2]),2)
facto9varimax_3vect <- round(as.vector(facto9varimax$loadings[,3][facto9varimax_3]),2)
facto9varimax_4vect <- round(as.vector(facto9varimax$loadings[,4][facto9varimax_4]),2)
facto9varimax_5vect <- round(as.vector(facto9varimax$loadings[,5][facto9varimax_5]),2)
facto9varimax_6vect <- round(as.vector(facto9varimax$loadings[,6][facto9varimax_6]),2)
facto9varimax_7vect <- round(as.vector(facto9varimax$loadings[,7][facto9varimax_7]),2)
facto9varimax_8vect <- round(as.vector(facto9varimax$loadings[,8][facto9varimax_8]),2)
facto9varimax_9vect <- round(as.vector(facto9varimax$loadings[,9][facto9varimax_9]),2)

facto9varimax_1_labels <- apply(facto9varimax_1.df, 1, find_label)
facto9varimax_2_labels <- apply(facto9varimax_2.df, 1, find_label)
facto9varimax_3_labels <- apply(facto9varimax_3.df, 1, find_label)
facto9varimax_4_labels <- apply(facto9varimax_4.df, 1, find_label)
facto9varimax_5_labels <- apply(facto9varimax_5.df, 1, find_label)
facto9varimax_6_labels <- apply(facto9varimax_6.df, 1, find_label)
facto9varimax_7_labels <- apply(facto9varimax_7.df, 1, find_label)
facto9varimax_8_labels <- apply(facto9varimax_8.df, 1, find_label)
facto9varimax_9_labels <- apply(facto9varimax_9.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto9varimax_1table <- data.frame(Item=facto9varimax_1, Label=facto9varimax_1_labels, Loading=facto9varimax_1vect)
facto9varimax_1table_ord <- facto9varimax_1table[order(facto9varimax_1vect, decreasing = TRUE),]
#2
facto9varimax_2table <- data.frame(Item=facto9varimax_2, Label=facto9varimax_2_labels, Loading=facto9varimax_2vect)
facto9varimax_2table_ord <- facto9varimax_2table[order(facto9varimax_2vect, decreasing = TRUE),]
#3
facto9varimax_3table <- data.frame(Item=facto9varimax_3, Label=facto9varimax_3_labels, Loading=facto9varimax_3vect)
facto9varimax_3table_ord <- facto9varimax_3table[order(facto9varimax_3vect, decreasing = TRUE),]
#4
facto9varimax_4table <- data.frame(Item=facto9varimax_4, Label=facto9varimax_4_labels, Loading=facto9varimax_4vect)
facto9varimax_4table_ord <- facto9varimax_4table[order(facto9varimax_4vect, decreasing = TRUE),]
#5
facto9varimax_5table <- data.frame(Item=facto9varimax_5, Label=facto9varimax_5_labels, Loading=facto9varimax_5vect)
facto9varimax_5table_ord <- facto9varimax_5table[order(facto9varimax_5vect, decreasing = TRUE),]
#6
facto9varimax_6table <- data.frame(Item=facto9varimax_6, Label=facto9varimax_6_labels, Loading=facto9varimax_6vect)
facto9varimax_6table_ord <- facto9varimax_6table[order(facto9varimax_6vect, decreasing = TRUE),]
#7
facto9varimax_7table <- data.frame(Item=facto9varimax_7, Label=facto9varimax_7_labels, Loading=facto9varimax_7vect)
facto9varimax_7table_ord <- facto9varimax_7table[order(facto9varimax_7vect, decreasing = TRUE),]
#8
facto9varimax_8table <- data.frame(Item=facto9varimax_8, Label=facto9varimax_8_labels, Loading=facto9varimax_8vect)
facto9varimax_8table_ord <- facto9varimax_8table[order(facto9varimax_8vect, decreasing = TRUE),]
#9
facto9varimax_9table <- data.frame(Item=facto9varimax_9, Label=facto9varimax_9_labels, Loading=facto9varimax_9vect)
facto9varimax_9table_ord <- facto9varimax_9table[order(facto9varimax_9vect, decreasing = TRUE),]


# nombre d'items par facteurs
n9_varimax_1 <- length(facto9varimax_1)
n9_varimax_2 <- length(facto9varimax_2)
n9_varimax_3 <- length(facto9varimax_3)
n9_varimax_4 <- length(facto9varimax_4)
n9_varimax_5 <- length(facto9varimax_5)
n9_varimax_6 <- length(facto9varimax_6)
n9_varimax_7 <- length(facto9varimax_7)
n9_varimax_8 <- length(facto9varimax_8)
n9_varimax_9 <- length(facto9varimax_9)

n9_varimax <- n4_varimax_1+n4_varimax_2+n4_varimax_3+n4_varimax_4+n9_varimax_5+n9_varimax_6+n9_varimax_7+n9_varimax_8+n9_varimax_9 

# Créer les scores factoriels
scores9_varimax_1 <- facto9varimax$scores[,1]
scores9_varimax_2 <- facto9varimax$scores[,2]
scores9_varimax_3 <- facto9varimax$scores[,3]
scores9_varimax_4 <- facto9varimax$scores[,4]
scores9_varimax_5 <- facto9varimax$scores[,5]
scores9_varimax_6 <- facto9varimax$scores[,6]
scores9_varimax_7 <- facto9varimax$scores[,7]
scores9_varimax_8 <- facto9varimax$scores[,8]
scores9_varimax_9 <- facto9varimax$scores[,9]
```

Le RMSEA est égal à `r facto9varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto9varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto9varimaxTLI`.
Le premier facteur explique `r facto9_1varimax_variance` %, le deuxième explique `r facto9_2varimax_variance` %, le troisième `r facto9_3varimax_variance` %, le quatrième `r facto9_4varimax_variance` %, le cinquième `r facto9_5varimax_variance` % , le sixième `r facto9_6varimax_variance` %, le septième `r facto9_7varimax_variance` %, le huitième `r facto9_8varimax_variance` %, le neuvième `r facto9_9varimax_variance` %  de la variance totale pour une variance cumulée égale à `r facto9varimax_variancecum` %.
Le premier facteur compte `r n9_varimax_1` items, le deuxième `r n9_varimax_2` items le troisième `r n9_varimax_3` items, le quatrième `r n9_varimax_4` items, le cinquième `r n9_varimax_5` items, le sixième `r n9_varimax_6` items, le septième `r n9_varimax_7` items, le huitième `r n9_varimax_8` items, le neuvième `r n9_varimax_9` items pour un total de `r n9_varimax` items.

### Facteur 1 : mistreated

```{r}
kable(facto9varimax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2varimax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto9varimax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto9varimax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto9varimax_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto9varimax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto9varimax_6table_ord)
```

### Facteur 7 : sexualized

```{r}
kable(facto9varimax_7table_ord)
```

### Facteur 8 : distrust

```{r}
kable(facto9varimax_8table_ord)
```

### Facteur 9 : none

```{r}
kable(facto9varimax_9table_ord)
```


## 10 facteurs

```{r}
facto10varimax <- fa(items.df, nfactors=10, rotate="varimax", use="pairwise")
# print(facto10varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto10varimax)
facto10varimaxRMSEA <- round(facto10varimax$RMSEA[["RMSEA"]],2) 
facto10varimaxrmsr <- round(facto10varimax$rms,2)
facto10varimaxTLI <- round(facto10varimax$TLI,2)
facto10_1varimax_variance <- round(facto10varimax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto10_2varimax_variance <- round(facto10varimax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto10_3varimax_variance <- round(facto10varimax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto10_4varimax_variance <- round(facto10varimax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto10_5varimax_variance <- round(facto10varimax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto10_6varimax_variance <- round(facto10varimax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto10_7varimax_variance <- round(facto10varimax[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto10_8varimax_variance <- round(facto10varimax[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8
facto10_9varimax_variance <- round(facto10varimax[["Vaccounted"]][2,9]*100,0) #obtenir la variance expliquée pour le facteur 9
facto10_10varimax_variance <- round(facto10varimax[["Vaccounted"]][2,10]*100,0) #obtenir la variance expliquée pour le facteur 10

facto10varimax_variancecum <- facto10_1varimax_variance+facto10_2varimax_variance+facto10_3varimax_variance+ facto10_4varimax_variance+facto10_5varimax_variance+facto10_6varimax_variance+facto10_7varimax_variance+facto10_8varimax_variance+facto10_9varimax_variance+facto10_10varimax_variance 

# Distinguer les facteurs

facto10varimax_1 <- which(abs(facto10varimax$loadings[,1]) > .30)
facto10varimax_2 <- which(abs(facto10varimax$loadings[,2]) > .30)
facto10varimax_3 <- which(abs(facto10varimax$loadings[,3]) > .30)
facto10varimax_4 <- which(abs(facto10varimax$loadings[,4]) > .30)
facto10varimax_5 <- which(abs(facto10varimax$loadings[,5]) > .30)
facto10varimax_6 <- which(abs(facto10varimax$loadings[,6]) > .30)
facto10varimax_7 <- which(abs(facto10varimax$loadings[,7]) > .30)
facto10varimax_8 <- which(abs(facto10varimax$loadings[,8]) > .30)
facto10varimax_9 <- which(abs(facto10varimax$loadings[,9]) > .30)
facto10varimax_10 <- which(abs(facto10varimax$loadings[,10]) > .30)

facto10varimax_1.df <- data.frame(facto10varimax_1)
facto10varimax_2.df <- data.frame(facto10varimax_2)
facto10varimax_3.df <- data.frame(facto10varimax_3)
facto10varimax_4.df <- data.frame(facto10varimax_4)
facto10varimax_5.df <- data.frame(facto10varimax_5)
facto10varimax_6.df <- data.frame(facto10varimax_6)
facto10varimax_7.df <- data.frame(facto10varimax_7)
facto10varimax_8.df <- data.frame(facto10varimax_8)
facto10varimax_9.df <- data.frame(facto10varimax_9)
facto10varimax_10.df <- data.frame(facto10varimax_10)

facto10varimax_1vect <- round(as.vector(facto10varimax$loadings[,1][facto10varimax_1]),2)
facto10varimax_2vect <- round(as.vector(facto10varimax$loadings[,2][facto10varimax_2]),2)
facto10varimax_3vect <- round(as.vector(facto10varimax$loadings[,3][facto10varimax_3]),2)
facto10varimax_4vect <- round(as.vector(facto10varimax$loadings[,4][facto10varimax_4]),2)
facto10varimax_5vect <- round(as.vector(facto10varimax$loadings[,5][facto10varimax_5]),2)
facto10varimax_6vect <- round(as.vector(facto10varimax$loadings[,6][facto10varimax_6]),2)
facto10varimax_7vect <- round(as.vector(facto10varimax$loadings[,7][facto10varimax_7]),2)
facto10varimax_8vect <- round(as.vector(facto10varimax$loadings[,8][facto10varimax_8]),2)
facto10varimax_9vect <- round(as.vector(facto10varimax$loadings[,9][facto10varimax_9]),2)
facto10varimax_10vect <- round(as.vector(facto10varimax$loadings[,10][facto10varimax_10]),2)

facto10varimax_1_labels <- apply(facto10varimax_1.df, 1, find_label)
facto10varimax_2_labels <- apply(facto10varimax_2.df, 1, find_label)
facto10varimax_3_labels <- apply(facto10varimax_3.df, 1, find_label)
facto10varimax_4_labels <- apply(facto10varimax_4.df, 1, find_label)
facto10varimax_5_labels <- apply(facto10varimax_5.df, 1, find_label)
facto10varimax_6_labels <- apply(facto10varimax_6.df, 1, find_label)
facto10varimax_7_labels <- apply(facto10varimax_7.df, 1, find_label)
facto10varimax_8_labels <- apply(facto10varimax_8.df, 1, find_label)
facto10varimax_9_labels <- apply(facto10varimax_9.df, 1, find_label)
facto10varimax_10_labels <- apply(facto10varimax_10.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto10varimax_1table <- data.frame(Item=facto10varimax_1, Label=facto10varimax_1_labels, Loading=facto10varimax_1vect)
facto10varimax_1table_ord <- facto10varimax_1table[order(facto10varimax_1vect, decreasing = TRUE),]
#2
facto10varimax_2table <- data.frame(Item=facto10varimax_2, Label=facto10varimax_2_labels, Loading=facto10varimax_2vect)
facto10varimax_2table_ord <- facto10varimax_2table[order(facto10varimax_2vect, decreasing = TRUE),]
#3
facto10varimax_3table <- data.frame(Item=facto10varimax_3, Label=facto10varimax_3_labels, Loading=facto10varimax_3vect)
facto10varimax_3table_ord <- facto10varimax_3table[order(facto10varimax_3vect, decreasing = TRUE),]
#4
facto10varimax_4table <- data.frame(Item=facto10varimax_4, Label=facto10varimax_4_labels, Loading=facto10varimax_4vect)
facto10varimax_4table_ord <- facto10varimax_4table[order(facto10varimax_4vect, decreasing = TRUE),]
#5
facto10varimax_5table <- data.frame(Item=facto10varimax_5, Label=facto10varimax_5_labels, Loading=facto10varimax_5vect)
facto10varimax_5table_ord <- facto10varimax_5table[order(facto10varimax_5vect, decreasing = TRUE),]
#6
facto10varimax_6table <- data.frame(Item=facto10varimax_6, Label=facto10varimax_6_labels, Loading=facto10varimax_6vect)
facto10varimax_6table_ord <- facto10varimax_6table[order(facto10varimax_6vect, decreasing = TRUE),]
#7
facto10varimax_7table <- data.frame(Item=facto10varimax_7, Label=facto10varimax_7_labels, Loading=facto10varimax_7vect)
facto10varimax_7table_ord <- facto10varimax_7table[order(facto10varimax_7vect, decreasing = TRUE),]
#8
facto10varimax_8table <- data.frame(Item=facto10varimax_8, Label=facto10varimax_8_labels, Loading=facto10varimax_8vect)
facto10varimax_8table_ord <- facto10varimax_8table[order(facto10varimax_8vect, decreasing = TRUE),]
#9
facto10varimax_9table <- data.frame(Item=facto10varimax_9, Label=facto10varimax_9_labels, Loading=facto10varimax_9vect)
facto10varimax_9table_ord <- facto10varimax_9table[order(facto10varimax_9vect, decreasing = TRUE),]
#10
facto10varimax_10table <- data.frame(Item=facto10varimax_10, Label=facto10varimax_10_labels, Loading=facto10varimax_10vect)
facto10varimax_10table_ord <- facto10varimax_10table[order(facto10varimax_10vect, decreasing = TRUE),]


# nombre d'items par facteurs
n10_varimax_1 <- length(facto10varimax_1)
n10_varimax_2 <- length(facto10varimax_2)
n10_varimax_3 <- length(facto10varimax_3)
n10_varimax_4 <- length(facto10varimax_4)
n10_varimax_5 <- length(facto10varimax_5)
n10_varimax_6 <- length(facto10varimax_6)
n10_varimax_7 <- length(facto10varimax_7)
n10_varimax_8 <- length(facto10varimax_8)
n10_varimax_9 <- length(facto10varimax_9)
n10_varimax_10 <- length(facto10varimax_10)

n10_varimax <- n4_varimax_1+n4_varimax_2+n4_varimax_3+n4_varimax_4+n9_varimax_5+n9_varimax_6+n9_varimax_7+n9_varimax_8+n9_varimax_9+n10_varimax_10 

# Créer les scores factoriels
scores10_varimax_1 <- facto10varimax$scores[,1]
scores10_varimax_2 <- facto10varimax$scores[,2]
scores10_varimax_3 <- facto10varimax$scores[,3]
scores10_varimax_4 <- facto10varimax$scores[,4]
scores10_varimax_5 <- facto10varimax$scores[,5]
scores10_varimax_6 <- facto10varimax$scores[,6]
scores10_varimax_7 <- facto10varimax$scores[,7]
scores10_varimax_8 <- facto10varimax$scores[,8]
scores10_varimax_9 <- facto10varimax$scores[,9]
scores10_varimax_10 <- facto10varimax$scores[,10]
```

Le RMSEA est égal à `r facto10varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto10varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto10varimaxTLI`.
Le premier facteur explique `r facto10_1varimax_variance` %, le deuxième explique `r facto10_2varimax_variance` %, le troisième `r facto10_3varimax_variance` %, le quatrième `r facto10_4varimax_variance` %, le cinquième `r facto10_5varimax_variance` % , le sixième `r facto10_6varimax_variance` %, le septième `r facto10_7varimax_variance` %, le huitième `r facto10_8varimax_variance` %, le neuvième `r facto10_9varimax_variance` %  de la variance totale pour une variance cumulée égale à `r facto10varimax_variancecum` %.
Le premier facteur compte `r n9_varimax_1` items, le deuxième `r n9_varimax_2` items le troisième `r n9_varimax_3` items, le quatrième `r n9_varimax_4` items, le cinquième `r n9_varimax_5` items, le sixième `r n9_varimax_6` items, le septième `r n9_varimax_7` items, le huitième `r n9_varimax_8` items, le neuvième `r n9_varimax_9` items pour un total de `r n9_varimax` items.

### Facteur 1 : mistreated

```{r}
kable(facto10varimax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2varimax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto10varimax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto10varimax_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto10varimax_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto10varimax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto10varimax_6table_ord)
```

### Facteur 7 : seduction

```{r}
kable(facto10varimax_7table_ord)
```

### Facteur 8 : distrust

```{r}
kable(facto10varimax_8table_ord)
```

### Facteur 9 : overwhelmed

```{r}
kable(facto10varimax_9table_ord)
```

### Facteur 10 : jalousy

```{r}
kable(facto10varimax_10table_ord)
```

## 11 facteurs

```{r}
facto11varimax <- fa(items.df, nfactors=11, rotate="varimax", use="pairwise")
# print(facto11varimax$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto11varimax)
facto11varimaxRMSEA <- round(facto11varimax$RMSEA[["RMSEA"]],2) 
facto11varimaxrmsr <- round(facto11varimax$rms,2)
facto11varimaxTLI <- round(facto11varimax$TLI,2)
facto11_1varimax_variance <- round(facto11varimax[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto11_2varimax_variance <- round(facto11varimax[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto11_3varimax_variance <- round(facto11varimax[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto11_4varimax_variance <- round(facto11varimax[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto11_5varimax_variance <- round(facto11varimax[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto11_6varimax_variance <- round(facto11varimax[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto11_7varimax_variance <- round(facto11varimax[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto11_8varimax_variance <- round(facto11varimax[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8
facto11_9varimax_variance <- round(facto11varimax[["Vaccounted"]][2,9]*100,0) #obtenir la variance expliquée pour le facteur 9
facto11_10varimax_variance <- round(facto11varimax[["Vaccounted"]][2,10]*100,0) #obtenir la variance expliquée pour le facteur 10
facto11_11varimax_variance <- round(facto11varimax[["Vaccounted"]][2,11]*100,0) #obtenir la variance expliquée pour le facteur 11

facto11varimax_variancecum <- facto11_1varimax_variance+facto11_2varimax_variance+facto11_3varimax_variance+ facto11_4varimax_variance+facto11_5varimax_variance+facto11_6varimax_variance+facto11_7varimax_variance+facto11_8varimax_variance+facto11_9varimax_variance+facto11_10varimax_variance+facto11_11varimax_variance 

# Distinguer les facteurs

facto11varimax_1 <- which(abs(facto11varimax$loadings[,1]) > .30)
facto11varimax_2 <- which(abs(facto11varimax$loadings[,2]) > .30)
facto11varimax_3 <- which(abs(facto11varimax$loadings[,3]) > .30)
facto11varimax_4 <- which(abs(facto11varimax$loadings[,4]) > .30)
facto11varimax_5 <- which(abs(facto11varimax$loadings[,5]) > .30)
facto11varimax_6 <- which(abs(facto11varimax$loadings[,6]) > .30)
facto11varimax_7 <- which(abs(facto11varimax$loadings[,7]) > .30)
facto11varimax_8 <- which(abs(facto11varimax$loadings[,8]) > .30)
facto11varimax_9 <- which(abs(facto11varimax$loadings[,9]) > .30)
facto11varimax_10 <- which(abs(facto11varimax$loadings[,10]) > .30)
facto11varimax_11 <- which(abs(facto11varimax$loadings[,11]) > .30)

facto11varimax_1.df <- data.frame(facto11varimax_1)
facto11varimax_2.df <- data.frame(facto11varimax_2)
facto11varimax_3.df <- data.frame(facto11varimax_3)
facto11varimax_4.df <- data.frame(facto11varimax_4)
facto11varimax_5.df <- data.frame(facto11varimax_5)
facto11varimax_6.df <- data.frame(facto11varimax_6)
facto11varimax_7.df <- data.frame(facto11varimax_7)
facto11varimax_8.df <- data.frame(facto11varimax_8)
facto11varimax_9.df <- data.frame(facto11varimax_9)
facto11varimax_10.df <- data.frame(facto11varimax_10)
facto11varimax_11.df <- data.frame(facto11varimax_11)

facto11varimax_1vect <- round(as.vector(facto11varimax$loadings[,1][facto11varimax_1]),2)
facto11varimax_2vect <- round(as.vector(facto11varimax$loadings[,2][facto11varimax_2]),2)
facto11varimax_3vect <- round(as.vector(facto11varimax$loadings[,3][facto11varimax_3]),2)
facto11varimax_4vect <- round(as.vector(facto11varimax$loadings[,4][facto11varimax_4]),2)
facto11varimax_5vect <- round(as.vector(facto11varimax$loadings[,5][facto11varimax_5]),2)
facto11varimax_6vect <- round(as.vector(facto11varimax$loadings[,6][facto11varimax_6]),2)
facto11varimax_7vect <- round(as.vector(facto11varimax$loadings[,7][facto11varimax_7]),2)
facto11varimax_8vect <- round(as.vector(facto11varimax$loadings[,8][facto11varimax_8]),2)
facto11varimax_9vect <- round(as.vector(facto11varimax$loadings[,9][facto11varimax_9]),2)
facto11varimax_10vect <- round(as.vector(facto11varimax$loadings[,10][facto11varimax_10]),2)
facto11varimax_11vect <- round(as.vector(facto11varimax$loadings[,11][facto11varimax_11]),2)

facto11varimax_1_labels <- apply(facto11varimax_1.df, 1, find_label)
facto11varimax_2_labels <- apply(facto11varimax_2.df, 1, find_label)
facto11varimax_3_labels <- apply(facto11varimax_3.df, 1, find_label)
facto11varimax_4_labels <- apply(facto11varimax_4.df, 1, find_label)
facto11varimax_5_labels <- apply(facto11varimax_5.df, 1, find_label)
facto11varimax_6_labels <- apply(facto11varimax_6.df, 1, find_label)
facto11varimax_7_labels <- apply(facto11varimax_7.df, 1, find_label)
facto11varimax_8_labels <- apply(facto11varimax_8.df, 1, find_label)
facto11varimax_9_labels <- apply(facto11varimax_9.df, 1, find_label)
facto11varimax_10_labels <- apply(facto11varimax_10.df, 1, find_label)
facto11varimax_11_labels <- apply(facto11varimax_11.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto11varimax_1table <- data.frame(Item=facto11varimax_1, Label=facto11varimax_1_labels, Loading=facto11varimax_1vect)
facto11varimax_1table_ord <- facto11varimax_1table[order(facto11varimax_1vect, decreasing = TRUE),]
#2
facto11varimax_2table <- data.frame(Item=facto11varimax_2, Label=facto11varimax_2_labels, Loading=facto11varimax_2vect)
facto11varimax_2table_ord <- facto11varimax_2table[order(facto11varimax_2vect, decreasing = TRUE),]
#3
facto11varimax_3table <- data.frame(Item=facto11varimax_3, Label=facto11varimax_3_labels, Loading=facto11varimax_3vect)
facto11varimax_3table_ord <- facto11varimax_3table[order(facto11varimax_3vect, decreasing = TRUE),]
#4
facto11varimax_4table <- data.frame(Item=facto11varimax_4, Label=facto11varimax_4_labels, Loading=facto11varimax_4vect)
facto11varimax_4table_ord <- facto11varimax_4table[order(facto11varimax_4vect, decreasing = TRUE),]
#5
facto11varimax_5table <- data.frame(Item=facto11varimax_5, Label=facto11varimax_5_labels, Loading=facto11varimax_5vect)
facto11varimax_5table_ord <- facto11varimax_5table[order(facto11varimax_5vect, decreasing = TRUE),]
#6
facto11varimax_6table <- data.frame(Item=facto11varimax_6, Label=facto11varimax_6_labels, Loading=facto11varimax_6vect)
facto11varimax_6table_ord <- facto11varimax_6table[order(facto11varimax_6vect, decreasing = TRUE),]
#7
facto11varimax_7table <- data.frame(Item=facto11varimax_7, Label=facto11varimax_7_labels, Loading=facto11varimax_7vect)
facto11varimax_7table_ord <- facto11varimax_7table[order(facto11varimax_7vect, decreasing = TRUE),]
#8
facto11varimax_8table <- data.frame(Item=facto11varimax_8, Label=facto11varimax_8_labels, Loading=facto11varimax_8vect)
facto11varimax_8table_ord <- facto11varimax_8table[order(facto11varimax_8vect, decreasing = TRUE),]
#9
facto11varimax_9table <- data.frame(Item=facto11varimax_9, Label=facto11varimax_9_labels, Loading=facto11varimax_9vect)
facto11varimax_9table_ord <- facto11varimax_9table[order(facto11varimax_9vect, decreasing = TRUE),]
#10
facto11varimax_10table <- data.frame(Item=facto11varimax_10, Label=facto11varimax_10_labels, Loading=facto11varimax_10vect)
facto11varimax_10table_ord <- facto11varimax_10table[order(facto11varimax_10vect, decreasing = TRUE),]
#11
facto11varimax_11table <- data.frame(Item=facto11varimax_11, Label=facto11varimax_11_labels, Loading=facto11varimax_11vect)
facto11varimax_11table_ord <- facto11varimax_11table[order(facto11varimax_11vect, decreasing = TRUE),]


# nombre d'items par facteurs
n11_varimax_1 <- length(facto11varimax_1)
n11_varimax_2 <- length(facto11varimax_2)
n11_varimax_3 <- length(facto11varimax_3)
n11_varimax_4 <- length(facto11varimax_4)
n11_varimax_5 <- length(facto11varimax_5)
n11_varimax_6 <- length(facto11varimax_6)
n11_varimax_7 <- length(facto11varimax_7)
n11_varimax_8 <- length(facto11varimax_8)
n11_varimax_9 <- length(facto11varimax_9)
n11_varimax_10 <- length(facto11varimax_10)
n11_varimax_11 <- length(facto11varimax_11)

n11_varimax <- n4_varimax_1+n4_varimax_2+n4_varimax_3+n4_varimax_4+n9_varimax_5+n9_varimax_6+n9_varimax_7+n9_varimax_8+n9_varimax_9+n11_varimax_10+n11_varimax_11  

# Créer les scores factoriels
scores11_varimax_1 <- facto11varimax$scores[,1]
scores11_varimax_2 <- facto11varimax$scores[,2]
scores11_varimax_3 <- facto11varimax$scores[,3]
scores11_varimax_4 <- facto11varimax$scores[,4]
scores11_varimax_5 <- facto11varimax$scores[,5]
scores11_varimax_6 <- facto11varimax$scores[,6]
scores11_varimax_7 <- facto11varimax$scores[,7]
scores11_varimax_8 <- facto11varimax$scores[,8]
scores11_varimax_9 <- facto11varimax$scores[,9]
scores11_varimax_10 <- facto11varimax$scores[,10]
scores11_varimax_11 <- facto11varimax$scores[,11]
```

Le RMSEA est égal à `r facto11varimaxRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto11varimaxrmsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto11varimaxTLI`.
Le premier facteur explique `r facto11_1varimax_variance` %, le deuxième explique `r facto11_2varimax_variance` %, le troisième `r facto11_3varimax_variance` %, le quatrième `r facto11_4varimax_variance` %, le cinquième `r facto11_5varimax_variance` % , le sixième `r facto11_6varimax_variance` %, le septième `r facto11_7varimax_variance` %, le huitième `r facto11_8varimax_variance` %, le neuvième `r facto11_9varimax_variance` %  de la variance totale pour une variance cumulée égale à `r facto11varimax_variancecum` %.
Le premier facteur compte `r n9_varimax_1` items, le deuxième `r n9_varimax_2` items le troisième `r n9_varimax_3` items, le quatrième `r n9_varimax_4` items, le cinquième `r n9_varimax_5` items, le sixième `r n9_varimax_6` items, le septième `r n9_varimax_7` items, le huitième `r n9_varimax_8` items, le neuvième `r n9_varimax_9` items pour un total de `r n9_varimax` items.

### Facteur 1 : mistreated

```{r}
kable(facto11varimax_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2varimax_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto11varimax_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto11varimax_3table_ord)
```

### Facteur 4 : loss of professional distance

```{r}
kable(facto11varimax_4table_ord)
```

### Facteur 5 : incompetence

```{r}
kable(facto11varimax_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto11varimax_6table_ord)
```

### Facteur 7 : distrust

```{r}
kable(facto11varimax_7table_ord)
```

### Facteur 8 : overwhelmed

```{r}
kable(facto11varimax_8table_ord)
```

### Facteur 9 : sexualized

```{r}
kable(facto11varimax_9table_ord)
```

### Facteur 10 : need to disclose

```{r}
kable(facto11varimax_10table_ord)
```

### Facteur 11 : jalousy

```{r}
kable(facto11varimax_11table_ord)
```


## Comparaison des onze modèles varimax


```{r include=FALSE}
comparaisonvarimax.df <- data.frame(
  Facteurs = c(1,2,3,4,5,6,7,8,9,10,11),
  RMSEA= c(facto1varimaxRMSEA,facto2varimaxRMSEA,facto3varimaxRMSEA,facto4varimaxRMSEA,facto5varimaxRMSEA,facto6varimaxRMSEA,facto7varimaxRMSEA,facto8varimaxRMSEA,facto9varimaxRMSEA,facto10varimaxRMSEA,facto11varimaxRMSEA),
  RMSR = c(facto1varimaxrmsr,facto2varimaxrmsr,facto3varimaxrmsr,facto4varimaxrmsr,facto5varimaxrmsr,facto6varimaxrmsr,facto7varimaxrmsr,facto8varimaxrmsr,facto9varimaxrmsr,facto10varimaxrmsr,facto11varimaxrmsr),
  TLI = c(facto1varimaxTLI,facto2varimaxTLI,facto3varimaxTLI,facto4varimaxTLI,facto5varimaxTLI,facto6varimaxTLI,facto7varimaxTLI,facto8varimaxTLI,facto9varimaxTLI,facto10varimaxTLI,facto11varimaxTLI)
)
```

```{r comparaisonvarimax-tab, tidy=FALSE, echo = FALSE}
knitr::kable(
  comparaisonvarimax.df, caption = 'Comparaison des fits',
  booktabs = TRUE
)
```

```{r}
ggplot(comparaisonvarimax.df) +
 aes(x = Facteurs, y = RMSEA) +
 geom_point(shape = "circle", size = 4L, colour = "#112446") +
 labs(x = "Nombre de facteurs", y = "RMSEA", title = "RMSEA par nombre de facteurs") +
 scale_x_continuous(limits = c(0, 11), breaks = c(1,2,3,4,5,6,7,8,9,10,11)) +
 theme_classic() +
 ylim(0, 0.1)
```

```{r}
ggplot(comparaisonvarimax.df) +
 aes(x = Facteurs, y = RMSR) +
 geom_point(shape = "circle", size = 4L, colour = "#112446") +
 labs(x = "Nombre de facteurs", y = "RMSR", title = "RMSR par nombre de facteurs") +
 scale_x_continuous(limits = c(0, 11), breaks = c(1,2,3,4,5,6,7,8,9,10,11)) +
 theme_classic() +
 ylim(0, 0.15)
```

```{r}
ggplot(comparaisonvarimax.df) +
 aes(x = Facteurs, y = TLI) +
 geom_point(shape = "circle", size = 4L, colour = "#112446") +
 labs(x = "Nombre de facteurs", y = "Tucker Lewis Index", title = "Tucker Lewis Index par nombre de facteurs") +
 scale_x_continuous(limits = c(0, 11), breaks = c(1,2,3,4,5,6,7,8,9,10,11)) +
 theme_classic() +
 ylim(0, 1)
```

## Corrélations entre les facteurs avec variation varimax pour 11 niveaux

```{r}
# 8 niveaux

facto8_varimax_scores.df <- data.frame(scores1_varimax_1, scores2_varimax_1, scores2_varimax_2, scores3_varimax_1, scores3_varimax_2, scores3_varimax_3, scores4_varimax_1, scores4_varimax_2, scores4_varimax_3, scores4_varimax_4, scores5_varimax_1, scores5_varimax_2, scores5_varimax_3, scores5_varimax_4, scores5_varimax_5, scores6_varimax_1, scores6_varimax_2, scores6_varimax_3, scores6_varimax_4, scores6_varimax_5, scores6_varimax_6, scores7_varimax_1, scores7_varimax_2, scores7_varimax_3, scores7_varimax_4, scores7_varimax_5, scores7_varimax_6, scores7_varimax_7, scores8_varimax_1, scores8_varimax_2, scores8_varimax_3, scores8_varimax_4, scores8_varimax_5, scores8_varimax_6, scores8_varimax_7, scores8_varimax_8)

facto8_varimax_cor_scores <- round(cor(facto8_varimax_scores.df, use = "complete.obs"),2)

# 11 niveaux

facto11_varimax_scores.df <- data.frame(scores1_varimax_1, scores2_varimax_1, scores2_varimax_2, scores3_varimax_1, scores3_varimax_2, scores3_varimax_3, scores4_varimax_1, scores4_varimax_2, scores4_varimax_3, scores4_varimax_4, scores5_varimax_1, scores5_varimax_2, scores5_varimax_3, scores5_varimax_4, scores5_varimax_5, scores6_varimax_1, scores6_varimax_2, scores6_varimax_3, scores6_varimax_4, scores6_varimax_5, scores6_varimax_6, scores7_varimax_1, scores7_varimax_2, scores7_varimax_3, scores7_varimax_4, scores7_varimax_5, scores7_varimax_6, scores7_varimax_7, scores8_varimax_1, scores8_varimax_2, scores8_varimax_3, scores8_varimax_4, scores8_varimax_5, scores8_varimax_6, scores8_varimax_7, scores8_varimax_8, scores9_varimax_1, scores9_varimax_2, scores9_varimax_3, scores9_varimax_4, scores9_varimax_5, scores9_varimax_6, scores9_varimax_7, scores9_varimax_8,scores9_varimax_9,scores10_varimax_1, scores10_varimax_2, scores10_varimax_3, scores10_varimax_4, scores10_varimax_5, scores10_varimax_6, scores10_varimax_7, scores10_varimax_8,scores10_varimax_9,scores10_varimax_10,scores11_varimax_1, scores11_varimax_2, scores11_varimax_3, scores11_varimax_4, scores11_varimax_5, scores11_varimax_6, scores11_varimax_7, scores11_varimax_8,scores11_varimax_9,scores11_varimax_10,scores11_varimax_11)

facto11_varimax_cor_scores <- round(cor(facto11_varimax_scores.df, use = "complete.obs"),2)

#kable(facto8_varimax_cor_scores)
 
# Créer un fichier excel avec les corrélations entre chaque facteur
wb_varimax11 <- createWorkbook()
addWorksheet(wb_varimax11, "Correlations")
writeData(wb_varimax11, "Correlations", facto11_varimax_cor_scores, rowNames = TRUE)
#saveWorkbook(wb_varimax11, "correlationsfacto11varimax.xlsx")
```
Ce [fichier excel](https://1drv.ms/x/s!AsF5FHJubO7zum42Toj2tN_djAJN?e=9AKxXo) présente la matrice de corrélations de tous les scores factoriels pour les 11 niveaux.

# Rotation varimax avec items ipsérisés

```{r}
detach(items.df)
itemsipse <- read_sav("C:/Users/Ouriagan/OneDrive/TRQ_article/ct_ipse_8_01_2023.sav")
itemsipse.df <- data.frame(itemsipse)
attach(itemsipse.df)

# Ipsérisation

# trqmean = (mean(trq1)+mean(trq2)+mean(trq3)+mean(trq4)+mean(trq5)+mean(trq6)+mean(trq7)+mean(trq8)+mean(trq9)+mean(trq10)+mean(trq11)+mean(trq12)+mean(trq13)+mean(trq14)+mean(trq15)+mean(trq16)+mean(trq17)+mean(trq18)+mean(trq19)+mean(trq20)+mean(trq21)+mean(trq22)+mean(trq23)+mean(trq24)+mean(trq25)+mean(trq26)+mean(trq27)+mean(trq28)+mean(trq29)+mean(trq30)+mean(trq31)+mean(trq32)+mean(trq33)+mean(trq34)+mean(trq35)+mean(trq36)+mean(trq37)+mean(trq38)+mean(trq39)+mean(trq40)+mean(trq41)+mean(trq42)+mean(trq43)+mean(trq44)+mean(trq45)+mean(trq46)+mean(trq47)+mean(trq48)+mean(trq49)+mean(trq50)+mean(trq51)+mean(trq52)+mean(trq53)+mean(trq54)+mean(trq55)+mean(trq56)+mean(trq57)+mean(trq58)+mean(trq59)+mean(trq60)+mean(trq61)+mean(trq62)+mean(trq63)+mean(trq64)+mean(trq65)+mean(trq66)+mean(trq67)+mean(trq68)+mean(trq69)+mean(trq70)+mean(trq71)+mean(trq72)+mean(trq73)+mean(trq74)+mean(trq75)+mean(trq76)+mean(trq77)+mean(trq78)+mean(trq79))/79
# 
# trqsd = (sd(trq1)+sd(trq2)+sd(trq3)+sd(trq4)+sd(trq5)+sd(trq6)+sd(trq7)+sd(trq8)+sd(trq9)+sd(trq10)+sd(trq11)+sd(trq12)+sd(trq13)+sd(trq14)+sd(trq15)+sd(trq16)+sd(trq17)+sd(trq18)+sd(trq19)+sd(trq20)+sd(trq21)+sd(trq22)+sd(trq23)+sd(trq24)+sd(trq25)+sd(trq26)+sd(trq27)+sd(trq28)+sd(trq29)+sd(trq30)+sd(trq31)+sd(trq32)+sd(trq33)+sd(trq34)+sd(trq35)+sd(trq36)+sd(trq37)+sd(trq38)+sd(trq39)+sd(trq40)+sd(trq41)+sd(trq42)+sd(trq43)+sd(trq44)+sd(trq45)+sd(trq46)+sd(trq47)+sd(trq48)+sd(trq49)+sd(trq50)+sd(trq51)+sd(trq52)+sd(trq53)+sd(trq54)+sd(trq55)+sd(trq56)+sd(trq57)+sd(trq58)+sd(trq59)+sd(trq60)+sd(trq61)+sd(trq62)+sd(trq63)+sd(trq64)+sd(trq65)+sd(trq66)+sd(trq67)+sd(trq68)+sd(trq69)+sd(trq70)+sd(trq71)+sd(trq72)+sd(trq73)+sd(trq74)+sd(trq75)+sd(trq76)+sd(trq77)+sd(trq78)+sd(trq79))/79
# 
# fun <- function(x) {(x-trqmean)/trqsd} #la fonction centre chaque variable sur la moyenne et la réduit par l'écart-type
# z_items.df <- apply(itemscomplete.df, 2, fun) #le 2 signifie que la fonction porte sur chaque colonne
```



N = `r N`

## Very Simple Structure

```{r}
# itemscentres <- scale(itemsipse.df, center = TRUE) #Centre les variables sur 0
vssmodelesfa <- vss(itemsipse.df, rotate = "varimax", use="pairwise")
```

Le Very Simple Structure criterion propose une solution à 3 voire 4 facteurs.


## Method Agreement Procedure

[n_factors](https://easystats.github.io/parameters/reference/n_factors.html) utilise 14 méthodes pour proposer la solution factorielle la plus fréquemment proposée :

```{r}
n_factors_vari_ipse_results <- n_factors(itemsipse.df, type = "FA", rotation = "varimax")
plot(n_factors_vari_ipse_results)
```


## 1 facteur

```{r}
facto1vari_ipse <- fa(itemsipse.df, nfactors=1, rotate="varimax", use="pairwise")
fa.diagram(facto1vari_ipse)
facto1vari_ipseRMSEA <- round(facto1vari_ipse$RMSEA[["RMSEA"]],2) 
facto1vari_ipsermsr <- round(facto1vari_ipse$rms,2)
facto1vari_ipseTLI <- round(facto1vari_ipse$TLI,2)
facto1_1vari_ipse_variance <- round(facto1vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la 

# Distinguer les facteurs

factor1vari_ipse_1 <- which(abs(facto1vari_ipse$loadings[,1]) > .30)
factor1vari_ipse_1.df <- data.frame(factor1vari_ipse_1)
facto1vari_ipse_1vect <- round(as.vector(facto1vari_ipse$loadings[,1][factor1vari_ipse_1]),2)
facto1vari_ipse_1_labels <- apply(factor1vari_ipse_1.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto1vari_ipse_1table <- data.frame(Item=factor1vari_ipse_1, Label=facto1vari_ipse_1_labels, Loading=facto1vari_ipse_1vect)
facto1vari_ipse_1table_ord <- facto1vari_ipse_1table[order(facto1vari_ipse_1vect, decreasing = TRUE),]


# nombre d'items par facteurs
n1_vari_ipse_1 <- length(factor1vari_ipse_1)


# Créer les scores factoriels
scores1_vari_ipse_1 <- facto1vari_ipse$scores[,1]
```

Le RMSEA est égal à `r facto1vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto1vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto1vari_ipseTLI`.
Le premier facteur explique `r facto1_1vari_ipse_variance` %.
Le premier facteur compte `r n1_vari_ipse_1` items.

### Facteur 1 : negative emotions

```{r}
kable(facto1vari_ipse_1table_ord)
```

## 2 facteurs

```{r}
facto2vari_ipse <- fa(itemsipse.df, nfactors=2, rotate="varimax", use="pairwise")
# print(facto2vari_ipse$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto2vari_ipse)
facto2vari_ipseRMSEA <- round(facto2vari_ipse$RMSEA[["RMSEA"]],2) 
facto2vari_ipsermsr <- round(facto2vari_ipse$rms,2)
facto2vari_ipseTLI <- round(facto2vari_ipse$TLI,2)
facto2_1vari_ipse_variance <- round(facto2vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto2_2vari_ipse_variance <- round(facto2vari_ipse[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto2_2vari_ipse_variancecum <- facto2_1vari_ipse_variance+facto2_2vari_ipse_variance

# Distinguer les facteurs

factor2vari_ipse_1 <- which(abs(facto2vari_ipse$loadings[,1]) > .30)
factor2vari_ipse_2 <- which(abs(facto2vari_ipse$loadings[,2]) > .30)
factor2vari_ipse_1.df <- data.frame(factor2vari_ipse_1)
factor2vari_ipse_2.df <- data.frame(factor2vari_ipse_2)
facto2vari_ipse_1vect <- round(as.vector(facto2vari_ipse$loadings[,1][factor2vari_ipse_1]),2)
facto2vari_ipse_2vect <- round(as.vector(facto2vari_ipse$loadings[,2][factor2vari_ipse_2]),2)
facto2vari_ipse_1_labels <- apply(factor2vari_ipse_1.df, 1, find_label)
facto2vari_ipse_2_labels <- apply(factor2vari_ipse_2.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto2vari_ipse_1table <- data.frame(Item=factor2vari_ipse_1, Label=facto2vari_ipse_1_labels, Loading=facto2vari_ipse_1vect)
facto2vari_ipse_1table_ord <- facto2vari_ipse_1table[order(facto2vari_ipse_1vect, decreasing = TRUE),]
#2
facto2vari_ipse_2table <- data.frame(Item=factor2vari_ipse_2, Label=facto2vari_ipse_2_labels, Loading=facto2vari_ipse_2vect)
facto2vari_ipse_2table_ord <- facto2vari_ipse_2table[order(facto2vari_ipse_2vect, decreasing = TRUE),]

# nombre d'items par facteurs
n2_vari_ipse_1 <- length(factor2vari_ipse_1)
n2_vari_ipse_2 <- length(factor2vari_ipse_2)
n2_vari_ipse <- n2_vari_ipse_1+n2_vari_ipse_2

# Créer les scores factoriels
scores2_vari_ipse_1 <- facto2vari_ipse$scores[,1]
scores2_vari_ipse_2 <- facto2vari_ipse$scores[,2]
```

Le RMSEA est égal à `r facto2vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto2vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto2vari_ipseTLI`.
Le premier facteur explique `r facto2_1vari_ipse_variance` %, le deuxième explique `r facto2_2vari_ipse_variance` % de la variance totale pour une variance cumulée égale à `r facto2_2vari_ipse_variancecum` %.
Le premier facteur compte `r n2_vari_ipse_1` items, le deuxième `r n2_vari_ipse_2` items pour un total de `r n2_vari_ipse` items.

### Facteur 1 : negative emotions

```{r}
kable(facto2vari_ipse_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2vari_ipse_1)$total$std.alpha, 2)`
```

### Facteur 2 : excitement

```{r}
kable(facto2vari_ipse_2table_ord)
```



## 3 facteurs

```{r}
facto3vari_ipse <- fa(itemsipse.df, nfactors=3, rotate="varimax", use="pairwise")
# print(facto3vari_ipse$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto3vari_ipse)
facto3vari_ipseRMSEA <- round(facto3vari_ipse$RMSEA[["RMSEA"]],2) 
facto3vari_ipsermsr <- round(facto3vari_ipse$rms,2)
facto3vari_ipseTLI <- round(facto3vari_ipse$TLI,2)
facto3_1vari_ipse_variance <- round(facto3vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto3_2vari_ipse_variance <- round(facto3vari_ipse[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto3_3vari_ipse_variance <- round(facto3vari_ipse[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto3vari_ipse_variancecum <- facto3_1vari_ipse_variance+facto3_2vari_ipse_variance+facto3_3vari_ipse_variance

# Distinguer les facteurs

facto3vari_ipse_1 <- which(abs(facto3vari_ipse$loadings[,1]) > .30)
facto3vari_ipse_2 <- which(abs(facto3vari_ipse$loadings[,2]) > .30)
facto3vari_ipse_3 <- which(abs(facto3vari_ipse$loadings[,3]) > .30)
facto3vari_ipse_1.df <- data.frame(facto3vari_ipse_1)
facto3vari_ipse_2.df <- data.frame(facto3vari_ipse_2)
facto3vari_ipse_3.df <- data.frame(facto3vari_ipse_3)
facto3vari_ipse_1vect <- round(as.vector(facto3vari_ipse$loadings[,1][facto3vari_ipse_1]),2)
facto3vari_ipse_2vect <- round(as.vector(facto3vari_ipse$loadings[,2][facto3vari_ipse_2]),2)
facto3vari_ipse_3vect <- round(as.vector(facto3vari_ipse$loadings[,3][facto3vari_ipse_3]),2)
facto3vari_ipse_1_labels <- apply(facto3vari_ipse_1.df, 1, find_label)
facto3vari_ipse_2_labels <- apply(facto3vari_ipse_2.df, 1, find_label)
facto3vari_ipse_3_labels <- apply(facto3vari_ipse_3.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto3vari_ipse_1table <- data.frame(Item=facto3vari_ipse_1, Label=facto3vari_ipse_1_labels, Loading=facto3vari_ipse_1vect)
facto3vari_ipse_1table_ord <- facto3vari_ipse_1table[order(facto3vari_ipse_1vect, decreasing = TRUE),]
#2
facto3vari_ipse_2table <- data.frame(Item=facto3vari_ipse_2, Label=facto3vari_ipse_2_labels, Loading=facto3vari_ipse_2vect)
facto3vari_ipse_2table_ord <- facto3vari_ipse_2table[order(facto3vari_ipse_2vect, decreasing = TRUE),]
#3
facto3vari_ipse_3table <- data.frame(Item=facto3vari_ipse_3, Label=facto3vari_ipse_3_labels, Loading=facto3vari_ipse_3vect)
facto3vari_ipse_3table_ord <- facto3vari_ipse_3table[order(facto3vari_ipse_3vect, decreasing = TRUE),]

# nombre d'items par facteurs
n3_vari_ipse_1 <- length(facto3vari_ipse_1)
n3_vari_ipse_2 <- length(facto3vari_ipse_2)
n3_vari_ipse_3 <- length(facto3vari_ipse_3)
n3_vari_ipse <- n3_vari_ipse_1+n3_vari_ipse_2+n3_vari_ipse_3

# Créer les scores factoriels
scores3_vari_ipse_1 <- facto3vari_ipse$scores[,1]
scores3_vari_ipse_2 <- facto3vari_ipse$scores[,2]
scores3_vari_ipse_3 <- facto3vari_ipse$scores[,3]
```

Le RMSEA est égal à `r facto3vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto3vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto3vari_ipseTLI`.
Le premier facteur explique `r facto3_1vari_ipse_variance` %, le deuxième explique `r facto3_2vari_ipse_variance` %, le troisième `r facto3_3vari_ipse_variance` % de la variance totale pour une variance cumulée égale à `r facto3vari_ipse_variancecum` %.
Le premier facteur compte `r n3_vari_ipse_1` items, le deuxième `r n3_vari_ipse_2` items le troisième `r n3_vari_ipse_3`  pour un total de `r n3_vari_ipse` items.

### Facteur 1 : excitement

```{r}
kable(facto3vari_ipse_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2vari_ipse_1)$total$std.alpha, 2)`
```

### Facteur 2 : anger

```{r}
kable(facto3vari_ipse_2table_ord)
```

### Facteur 3 : boredom

```{r}
kable(facto3vari_ipse_3table_ord)
```

## 4 facteurs

```{r}
facto4vari_ipse <- fa(itemsipse.df, nfactors=4, rotate="varimax", use="pairwise")
# print(facto4vari_ipse$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto4vari_ipse)
facto4vari_ipseRMSEA <- round(facto4vari_ipse$RMSEA[["RMSEA"]],2) 
facto4vari_ipsermsr <- round(facto4vari_ipse$rms,2)
facto4vari_ipseTLI <- round(facto4vari_ipse$TLI,2)
facto4_1vari_ipse_variance <- round(facto4vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto4_2vari_ipse_variance <- round(facto4vari_ipse[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto4_3vari_ipse_variance <- round(facto4vari_ipse[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto4_4vari_ipse_variance <- round(facto4vari_ipse[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4

facto4vari_ipse_variancecum <- facto4_1vari_ipse_variance+facto4_2vari_ipse_variance+facto4_3vari_ipse_variance+ facto4_4vari_ipse_variance

# Distinguer les facteurs

facto4vari_ipse_1 <- which(abs(facto4vari_ipse$loadings[,1]) > .30)
facto4vari_ipse_2 <- which(abs(facto4vari_ipse$loadings[,2]) > .30)
facto4vari_ipse_3 <- which(abs(facto4vari_ipse$loadings[,3]) > .30)
facto4vari_ipse_4 <- which(abs(facto4vari_ipse$loadings[,4]) > .30)

facto4vari_ipse_1.df <- data.frame(facto4vari_ipse_1)
facto4vari_ipse_2.df <- data.frame(facto4vari_ipse_2)
facto4vari_ipse_3.df <- data.frame(facto4vari_ipse_3)
facto4vari_ipse_4.df <- data.frame(facto4vari_ipse_4)

facto4vari_ipse_1vect <- round(as.vector(facto4vari_ipse$loadings[,1][facto4vari_ipse_1]),2)
facto4vari_ipse_2vect <- round(as.vector(facto4vari_ipse$loadings[,2][facto4vari_ipse_2]),2)
facto4vari_ipse_3vect <- round(as.vector(facto4vari_ipse$loadings[,3][facto4vari_ipse_3]),2)
facto4vari_ipse_4vect <- round(as.vector(facto4vari_ipse$loadings[,4][facto4vari_ipse_4]),2)

facto4vari_ipse_1_labels <- apply(facto4vari_ipse_1.df, 1, find_label)
facto4vari_ipse_2_labels <- apply(facto4vari_ipse_2.df, 1, find_label)
facto4vari_ipse_3_labels <- apply(facto4vari_ipse_3.df, 1, find_label)
facto4vari_ipse_4_labels <- apply(facto4vari_ipse_4.df, 1, find_label)


# Tableaux pour chaque facteur
# 1
facto4vari_ipse_1table <- data.frame(Item=facto4vari_ipse_1, Label=facto4vari_ipse_1_labels, Loading=facto4vari_ipse_1vect)
facto4vari_ipse_1table_ord <- facto4vari_ipse_1table[order(facto4vari_ipse_1vect, decreasing = TRUE),]
#2
facto4vari_ipse_2table <- data.frame(Item=facto4vari_ipse_2, Label=facto4vari_ipse_2_labels, Loading=facto4vari_ipse_2vect)
facto4vari_ipse_2table_ord <- facto4vari_ipse_2table[order(facto4vari_ipse_2vect, decreasing = TRUE),]
#3
facto4vari_ipse_3table <- data.frame(Item=facto4vari_ipse_3, Label=facto4vari_ipse_3_labels, Loading=facto4vari_ipse_3vect)
facto4vari_ipse_3table_ord <- facto4vari_ipse_3table[order(facto4vari_ipse_3vect, decreasing = TRUE),]
#4
facto4vari_ipse_4table <- data.frame(Item=facto4vari_ipse_4, Label=facto4vari_ipse_4_labels, Loading=facto4vari_ipse_4vect)
facto4vari_ipse_4table_ord <- facto4vari_ipse_4table[order(facto4vari_ipse_4vect, decreasing = TRUE),]

# nombre d'items par facteurs
n4_vari_ipse_1 <- length(facto4vari_ipse_1)
n4_vari_ipse_2 <- length(facto4vari_ipse_2)
n4_vari_ipse_3 <- length(facto4vari_ipse_3)
n4_vari_ipse_4 <- length(facto4vari_ipse_4)

n4_vari_ipse <- n4_vari_ipse_1+n4_vari_ipse_2+n4_vari_ipse_3+n4_vari_ipse_4

# Créer les scores factoriels
scores4_vari_ipse_1 <- facto4vari_ipse$scores[,1]
scores4_vari_ipse_2 <- facto4vari_ipse$scores[,2]
scores4_vari_ipse_3 <- facto4vari_ipse$scores[,3]
scores4_vari_ipse_4 <- facto4vari_ipse$scores[,4]

```

Le RMSEA est égal à `r facto4vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto4vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto4vari_ipseTLI`.
Le premier facteur explique `r facto4_1vari_ipse_variance` %, le deuxième explique `r facto4_2vari_ipse_variance` %, le troisième `r facto4_3vari_ipse_variance` % de la variance totale pour une variance cumulée égale à `r facto4vari_ipse_variancecum` %.
Le premier facteur compte `r n4_vari_ipse_1` items, le deuxième `r n4_vari_ipse_2` items le troisième `r n4_vari_ipse_3` , le quatrième `r n4_vari_ipse_4` pour un total de `r n4_vari_ipse` items.

### Facteur 1 : excitement

```{r}
kable(facto4vari_ipse_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2vari_ipse_1)$total$std.alpha, 2)`
```

### Facteur 2 : anger

```{r}
kable(facto4vari_ipse_2table_ord)
```

### Facteur 3 : boredom

```{r}
kable(facto4vari_ipse_3table_ord)
```

### Facteur 4 : loss of professionnal distance

```{r}
kable(facto4vari_ipse_4table_ord)
```


## 5 facteurs

```{r}
facto5vari_ipse <- fa(itemsipse.df, nfactors=5, rotate="varimax", use="pairwise")
# print(facto5vari_ipse$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto5vari_ipse)
facto5vari_ipseRMSEA <- round(facto5vari_ipse$RMSEA[["RMSEA"]],2) 
facto5vari_ipsermsr <- round(facto5vari_ipse$rms,2)
facto5vari_ipseTLI <- round(facto5vari_ipse$TLI,2)
facto5_1vari_ipse_variance <- round(facto5vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto5_2vari_ipse_variance <- round(facto5vari_ipse[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto5_3vari_ipse_variance <- round(facto5vari_ipse[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto5_4vari_ipse_variance <- round(facto5vari_ipse[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto5_5vari_ipse_variance <- round(facto5vari_ipse[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5

facto5vari_ipse_variancecum <- facto5_1vari_ipse_variance+facto5_2vari_ipse_variance+facto5_3vari_ipse_variance+ facto5_4vari_ipse_variance+facto5_5vari_ipse_variance

# Distinguer les facteurs

facto5vari_ipse_1 <- which(abs(facto5vari_ipse$loadings[,1]) > .30)
facto5vari_ipse_2 <- which(abs(facto5vari_ipse$loadings[,2]) > .30)
facto5vari_ipse_3 <- which(abs(facto5vari_ipse$loadings[,3]) > .30)
facto5vari_ipse_4 <- which(abs(facto5vari_ipse$loadings[,4]) > .30)
facto5vari_ipse_5 <- which(abs(facto5vari_ipse$loadings[,5]) > .30)

facto5vari_ipse_1.df <- data.frame(facto5vari_ipse_1)
facto5vari_ipse_2.df <- data.frame(facto5vari_ipse_2)
facto5vari_ipse_3.df <- data.frame(facto5vari_ipse_3)
facto5vari_ipse_4.df <- data.frame(facto5vari_ipse_4)
facto5vari_ipse_5.df <- data.frame(facto5vari_ipse_5)

facto5vari_ipse_1vect <- round(as.vector(facto5vari_ipse$loadings[,1][facto5vari_ipse_1]),2)
facto5vari_ipse_2vect <- round(as.vector(facto5vari_ipse$loadings[,2][facto5vari_ipse_2]),2)
facto5vari_ipse_3vect <- round(as.vector(facto5vari_ipse$loadings[,3][facto5vari_ipse_3]),2)
facto5vari_ipse_4vect <- round(as.vector(facto5vari_ipse$loadings[,4][facto5vari_ipse_4]),2)
facto5vari_ipse_5vect <- round(as.vector(facto5vari_ipse$loadings[,5][facto5vari_ipse_5]),2)

facto5vari_ipse_1_labels <- apply(facto5vari_ipse_1.df, 1, find_label)
facto5vari_ipse_2_labels <- apply(facto5vari_ipse_2.df, 1, find_label)
facto5vari_ipse_3_labels <- apply(facto5vari_ipse_3.df, 1, find_label)
facto5vari_ipse_4_labels <- apply(facto5vari_ipse_4.df, 1, find_label)
facto5vari_ipse_5_labels <- apply(facto5vari_ipse_5.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto5vari_ipse_1table <- data.frame(Item=facto5vari_ipse_1, Label=facto5vari_ipse_1_labels, Loading=facto5vari_ipse_1vect)
facto5vari_ipse_1table_ord <- facto5vari_ipse_1table[order(facto5vari_ipse_1vect, decreasing = TRUE),]
#2
facto5vari_ipse_2table <- data.frame(Item=facto5vari_ipse_2, Label=facto5vari_ipse_2_labels, Loading=facto5vari_ipse_2vect)
facto5vari_ipse_2table_ord <- facto5vari_ipse_2table[order(facto5vari_ipse_2vect, decreasing = TRUE),]
#3
facto5vari_ipse_3table <- data.frame(Item=facto5vari_ipse_3, Label=facto5vari_ipse_3_labels, Loading=facto5vari_ipse_3vect)
facto5vari_ipse_3table_ord <- facto5vari_ipse_3table[order(facto5vari_ipse_3vect, decreasing = TRUE),]
#4
facto5vari_ipse_4table <- data.frame(Item=facto5vari_ipse_4, Label=facto5vari_ipse_4_labels, Loading=facto5vari_ipse_4vect)
facto5vari_ipse_4table_ord <- facto5vari_ipse_4table[order(facto5vari_ipse_4vect, decreasing = TRUE),]
#5
facto5vari_ipse_5table <- data.frame(Item=facto5vari_ipse_5, Label=facto5vari_ipse_5_labels, Loading=facto5vari_ipse_5vect)
facto5vari_ipse_5table_ord <- facto5vari_ipse_5table[order(facto5vari_ipse_5vect, decreasing = TRUE),]

# nombre d'items par facteurs
n5_vari_ipse_1 <- length(facto5vari_ipse_1)
n5_vari_ipse_2 <- length(facto5vari_ipse_2)
n5_vari_ipse_3 <- length(facto5vari_ipse_3)
n5_vari_ipse_4 <- length(facto5vari_ipse_4)
n5_vari_ipse_5 <- length(facto5vari_ipse_5)

n5_vari_ipse <- n4_vari_ipse_1+n4_vari_ipse_2+n4_vari_ipse_3+n4_vari_ipse_4+n5_vari_ipse_5

# Créer les scores factoriels
scores5_vari_ipse_1 <- facto5vari_ipse$scores[,1]
scores5_vari_ipse_2 <- facto5vari_ipse$scores[,2]
scores5_vari_ipse_3 <- facto5vari_ipse$scores[,3]
scores5_vari_ipse_4 <- facto5vari_ipse$scores[,4]
scores5_vari_ipse_5 <- facto5vari_ipse$scores[,5]

```

Le RMSEA est égal à `r facto5vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto5vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto5vari_ipseTLI`.
Le premier facteur explique `r facto5_1vari_ipse_variance` %, le deuxième explique `r facto5_2vari_ipse_variance` %, le troisième `r facto5_3vari_ipse_variance` %, la quatrième `r facto5_4vari_ipse_variance` %, le cinquième `r facto5_5vari_ipse_variance` % de la variance totale pour une variance cumulée égale à `r facto5vari_ipse_variancecum` %.
Le premier facteur compte `r n5_vari_ipse_1` items, le deuxième `r n5_vari_ipse_2` items le troisième `r n5_vari_ipse_3` items, le quatrième `r n5_vari_ipse_4` items, le cinquième `r n5_vari_ipse_5` items, pour un total de `r n5_vari_ipse` items.

### Facteur 1 : mistreated

```{r}
kable(facto5vari_ipse_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2vari_ipse_1)$total$std.alpha, 2)`
```

### Facteur 2 : excitement

```{r}
kable(facto5vari_ipse_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto5vari_ipse_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto5vari_ipse_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto5vari_ipse_5table_ord)
```

## 6 facteurs

```{r}
facto6vari_ipse <- fa(itemsipse.df, nfactors=6, rotate="varimax", use="pairwise")
# print(facto6vari_ipse$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto6vari_ipse)
facto6vari_ipseRMSEA <- round(facto6vari_ipse$RMSEA[["RMSEA"]],2) 
facto6vari_ipsermsr <- round(facto6vari_ipse$rms,2)
facto6vari_ipseTLI <- round(facto6vari_ipse$TLI,2)
facto6_1vari_ipse_variance <- round(facto6vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto6_2vari_ipse_variance <- round(facto6vari_ipse[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto6_3vari_ipse_variance <- round(facto6vari_ipse[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto6_4vari_ipse_variance <- round(facto6vari_ipse[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto6_5vari_ipse_variance <- round(facto6vari_ipse[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto6_6vari_ipse_variance <- round(facto6vari_ipse[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6

facto6vari_ipse_variancecum <- facto6_1vari_ipse_variance+facto6_2vari_ipse_variance+facto6_3vari_ipse_variance+ facto6_4vari_ipse_variance+facto6_5vari_ipse_variance+facto6_6vari_ipse_variance

# Distinguer les facteurs

facto6vari_ipse_1 <- which(abs(facto6vari_ipse$loadings[,1]) > .30)
facto6vari_ipse_2 <- which(abs(facto6vari_ipse$loadings[,2]) > .30)
facto6vari_ipse_3 <- which(abs(facto6vari_ipse$loadings[,3]) > .30)
facto6vari_ipse_4 <- which(abs(facto6vari_ipse$loadings[,4]) > .30)
facto6vari_ipse_5 <- which(abs(facto6vari_ipse$loadings[,5]) > .30)
facto6vari_ipse_6 <- which(abs(facto6vari_ipse$loadings[,6]) > .30)

facto6vari_ipse_1.df <- data.frame(facto6vari_ipse_1)
facto6vari_ipse_2.df <- data.frame(facto6vari_ipse_2)
facto6vari_ipse_3.df <- data.frame(facto6vari_ipse_3)
facto6vari_ipse_4.df <- data.frame(facto6vari_ipse_4)
facto6vari_ipse_5.df <- data.frame(facto6vari_ipse_5)
facto6vari_ipse_6.df <- data.frame(facto6vari_ipse_6)

facto6vari_ipse_1vect <- round(as.vector(facto6vari_ipse$loadings[,1][facto6vari_ipse_1]),2)
facto6vari_ipse_2vect <- round(as.vector(facto6vari_ipse$loadings[,2][facto6vari_ipse_2]),2)
facto6vari_ipse_3vect <- round(as.vector(facto6vari_ipse$loadings[,3][facto6vari_ipse_3]),2)
facto6vari_ipse_4vect <- round(as.vector(facto6vari_ipse$loadings[,4][facto6vari_ipse_4]),2)
facto6vari_ipse_5vect <- round(as.vector(facto6vari_ipse$loadings[,5][facto6vari_ipse_5]),2)
facto6vari_ipse_6vect <- round(as.vector(facto6vari_ipse$loadings[,6][facto6vari_ipse_6]),2)

facto6vari_ipse_1_labels <- apply(facto6vari_ipse_1.df, 1, find_label)
facto6vari_ipse_2_labels <- apply(facto6vari_ipse_2.df, 1, find_label)
facto6vari_ipse_3_labels <- apply(facto6vari_ipse_3.df, 1, find_label)
facto6vari_ipse_4_labels <- apply(facto6vari_ipse_4.df, 1, find_label)
facto6vari_ipse_5_labels <- apply(facto6vari_ipse_5.df, 1, find_label)
facto6vari_ipse_6_labels <- apply(facto6vari_ipse_6.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto6vari_ipse_1table <- data.frame(Item=facto6vari_ipse_1, Label=facto6vari_ipse_1_labels, Loading=facto6vari_ipse_1vect)
facto6vari_ipse_1table_ord <- facto6vari_ipse_1table[order(facto6vari_ipse_1vect, decreasing = TRUE),]
#2
facto6vari_ipse_2table <- data.frame(Item=facto6vari_ipse_2, Label=facto6vari_ipse_2_labels, Loading=facto6vari_ipse_2vect)
facto6vari_ipse_2table_ord <- facto6vari_ipse_2table[order(facto6vari_ipse_2vect, decreasing = TRUE),]
#3
facto6vari_ipse_3table <- data.frame(Item=facto6vari_ipse_3, Label=facto6vari_ipse_3_labels, Loading=facto6vari_ipse_3vect)
facto6vari_ipse_3table_ord <- facto6vari_ipse_3table[order(facto6vari_ipse_3vect, decreasing = TRUE),]
#4
facto6vari_ipse_4table <- data.frame(Item=facto6vari_ipse_4, Label=facto6vari_ipse_4_labels, Loading=facto6vari_ipse_4vect)
facto6vari_ipse_4table_ord <- facto6vari_ipse_4table[order(facto6vari_ipse_4vect, decreasing = TRUE),]
#5
facto6vari_ipse_5table <- data.frame(Item=facto6vari_ipse_5, Label=facto6vari_ipse_5_labels, Loading=facto6vari_ipse_5vect)
facto6vari_ipse_5table_ord <- facto6vari_ipse_5table[order(facto6vari_ipse_5vect, decreasing = TRUE),]
#6
facto6vari_ipse_6table <- data.frame(Item=facto6vari_ipse_6, Label=facto6vari_ipse_6_labels, Loading=facto6vari_ipse_6vect)
facto6vari_ipse_6table_ord <- facto6vari_ipse_6table[order(facto6vari_ipse_6vect, decreasing = TRUE),]


# nombre d'items par facteurs
n6_vari_ipse_1 <- length(facto6vari_ipse_1)
n6_vari_ipse_2 <- length(facto6vari_ipse_2)
n6_vari_ipse_3 <- length(facto6vari_ipse_3)
n6_vari_ipse_4 <- length(facto6vari_ipse_4)
n6_vari_ipse_5 <- length(facto6vari_ipse_5)
n6_vari_ipse_6 <- length(facto6vari_ipse_6)

n6_vari_ipse <- n4_vari_ipse_1+n4_vari_ipse_2+n4_vari_ipse_3+n4_vari_ipse_4+n6_vari_ipse_5+n6_vari_ipse_6

# Créer les scores factoriels
scores6_vari_ipse_1 <- facto6vari_ipse$scores[,1]
scores6_vari_ipse_2 <- facto6vari_ipse$scores[,2]
scores6_vari_ipse_3 <- facto6vari_ipse$scores[,3]
scores6_vari_ipse_4 <- facto6vari_ipse$scores[,4]
scores6_vari_ipse_5 <- facto6vari_ipse$scores[,5]
scores6_vari_ipse_6 <- facto6vari_ipse$scores[,6]
```

Le RMSEA est égal à `r facto6vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto6vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto6vari_ipseTLI`.
Le premier facteur explique `r facto6_1vari_ipse_variance` %, le deuxième explique `r facto6_2vari_ipse_variance` %, le troisième `r facto6_3vari_ipse_variance` %, le quatrième `r facto6_4vari_ipse_variance` %, le cinquième `r facto6_5vari_ipse_variance` % , le sixième `r facto6_6vari_ipse_variance` % de la variance totale pour une variance cumulée égale à `r facto6vari_ipse_variancecum` %.
Le premier facteur compte `r n6_vari_ipse_1` items, le deuxième `r n6_vari_ipse_2` items le troisième `r n6_vari_ipse_3` items, le quatrième `r n6_vari_ipse_4` items, le cinquième `r n6_vari_ipse_5` items, le sixième `r n6_vari_ipse_6` items pour un total de `r n6_vari_ipse` items.

### Facteur 1 : mistreated

```{r}
kable(facto6vari_ipse_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2vari_ipse_1)$total$std.alpha, 2)`
```

### Facteur 2 : excitement

```{r}
kable(facto6vari_ipse_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto6vari_ipse_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto6vari_ipse_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto6vari_ipse_5table_ord)
```

### Facteur 6 : laxity

```{r}
kable(facto6vari_ipse_6table_ord)
```

## 7 facteurs

```{r}
facto7vari_ipse <- fa(itemsipse.df, nfactors=7, rotate="varimax", use="pairwise")
# print(facto7vari_ipse$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto7vari_ipse)
facto7vari_ipseRMSEA <- round(facto7vari_ipse$RMSEA[["RMSEA"]],2) 
facto7vari_ipsermsr <- round(facto7vari_ipse$rms,2)
facto7vari_ipseTLI <- round(facto7vari_ipse$TLI,2)
facto7_1vari_ipse_variance <- round(facto7vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto7_2vari_ipse_variance <- round(facto7vari_ipse[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto7_3vari_ipse_variance <- round(facto7vari_ipse[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto7_4vari_ipse_variance <- round(facto7vari_ipse[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto7_5vari_ipse_variance <- round(facto7vari_ipse[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto7_6vari_ipse_variance <- round(facto7vari_ipse[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto7_7vari_ipse_variance <- round(facto7vari_ipse[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7

facto7vari_ipse_variancecum <- facto7_1vari_ipse_variance+facto7_2vari_ipse_variance+facto7_3vari_ipse_variance+ facto7_4vari_ipse_variance+facto7_5vari_ipse_variance+facto7_6vari_ipse_variance+facto7_7vari_ipse_variance

# Distinguer les facteurs

facto7vari_ipse_1 <- which(abs(facto7vari_ipse$loadings[,1]) > .30)
facto7vari_ipse_2 <- which(abs(facto7vari_ipse$loadings[,2]) > .30)
facto7vari_ipse_3 <- which(abs(facto7vari_ipse$loadings[,3]) > .30)
facto7vari_ipse_4 <- which(abs(facto7vari_ipse$loadings[,4]) > .30)
facto7vari_ipse_5 <- which(abs(facto7vari_ipse$loadings[,5]) > .30)
facto7vari_ipse_6 <- which(abs(facto7vari_ipse$loadings[,6]) > .30)
facto7vari_ipse_7 <- which(abs(facto7vari_ipse$loadings[,7]) > .30)

facto7vari_ipse_1.df <- data.frame(facto7vari_ipse_1)
facto7vari_ipse_2.df <- data.frame(facto7vari_ipse_2)
facto7vari_ipse_3.df <- data.frame(facto7vari_ipse_3)
facto7vari_ipse_4.df <- data.frame(facto7vari_ipse_4)
facto7vari_ipse_5.df <- data.frame(facto7vari_ipse_5)
facto7vari_ipse_6.df <- data.frame(facto7vari_ipse_6)
facto7vari_ipse_7.df <- data.frame(facto7vari_ipse_7)

facto7vari_ipse_1vect <- round(as.vector(facto7vari_ipse$loadings[,1][facto7vari_ipse_1]),2)
facto7vari_ipse_2vect <- round(as.vector(facto7vari_ipse$loadings[,2][facto7vari_ipse_2]),2)
facto7vari_ipse_3vect <- round(as.vector(facto7vari_ipse$loadings[,3][facto7vari_ipse_3]),2)
facto7vari_ipse_4vect <- round(as.vector(facto7vari_ipse$loadings[,4][facto7vari_ipse_4]),2)
facto7vari_ipse_5vect <- round(as.vector(facto7vari_ipse$loadings[,5][facto7vari_ipse_5]),2)
facto7vari_ipse_6vect <- round(as.vector(facto7vari_ipse$loadings[,6][facto7vari_ipse_6]),2)
facto7vari_ipse_7vect <- round(as.vector(facto7vari_ipse$loadings[,7][facto7vari_ipse_7]),2)

facto7vari_ipse_1_labels <- apply(facto7vari_ipse_1.df, 1, find_label)
facto7vari_ipse_2_labels <- apply(facto7vari_ipse_2.df, 1, find_label)
facto7vari_ipse_3_labels <- apply(facto7vari_ipse_3.df, 1, find_label)
facto7vari_ipse_4_labels <- apply(facto7vari_ipse_4.df, 1, find_label)
facto7vari_ipse_5_labels <- apply(facto7vari_ipse_5.df, 1, find_label)
facto7vari_ipse_6_labels <- apply(facto7vari_ipse_6.df, 1, find_label)
facto7vari_ipse_7_labels <- apply(facto7vari_ipse_7.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto7vari_ipse_1table <- data.frame(Item=facto7vari_ipse_1, Label=facto7vari_ipse_1_labels, Loading=facto7vari_ipse_1vect)
facto7vari_ipse_1table_ord <- facto7vari_ipse_1table[order(facto7vari_ipse_1vect, decreasing = TRUE),]
#2
facto7vari_ipse_2table <- data.frame(Item=facto7vari_ipse_2, Label=facto7vari_ipse_2_labels, Loading=facto7vari_ipse_2vect)
facto7vari_ipse_2table_ord <- facto7vari_ipse_2table[order(facto7vari_ipse_2vect, decreasing = TRUE),]
#3
facto7vari_ipse_3table <- data.frame(Item=facto7vari_ipse_3, Label=facto7vari_ipse_3_labels, Loading=facto7vari_ipse_3vect)
facto7vari_ipse_3table_ord <- facto7vari_ipse_3table[order(facto7vari_ipse_3vect, decreasing = TRUE),]
#4
facto7vari_ipse_4table <- data.frame(Item=facto7vari_ipse_4, Label=facto7vari_ipse_4_labels, Loading=facto7vari_ipse_4vect)
facto7vari_ipse_4table_ord <- facto7vari_ipse_4table[order(facto7vari_ipse_4vect, decreasing = TRUE),]
#5
facto7vari_ipse_5table <- data.frame(Item=facto7vari_ipse_5, Label=facto7vari_ipse_5_labels, Loading=facto7vari_ipse_5vect)
facto7vari_ipse_5table_ord <- facto7vari_ipse_5table[order(facto7vari_ipse_5vect, decreasing = TRUE),]
#6
facto7vari_ipse_6table <- data.frame(Item=facto7vari_ipse_6, Label=facto7vari_ipse_6_labels, Loading=facto7vari_ipse_6vect)
facto7vari_ipse_6table_ord <- facto7vari_ipse_6table[order(facto7vari_ipse_6vect, decreasing = TRUE),]
#7
facto7vari_ipse_7table <- data.frame(Item=facto7vari_ipse_7, Label=facto7vari_ipse_7_labels, Loading=facto7vari_ipse_7vect)
facto7vari_ipse_7table_ord <- facto7vari_ipse_7table[order(facto7vari_ipse_7vect, decreasing = TRUE),]


# nombre d'items par facteurs
n7_vari_ipse_1 <- length(facto7vari_ipse_1)
n7_vari_ipse_2 <- length(facto7vari_ipse_2)
n7_vari_ipse_3 <- length(facto7vari_ipse_3)
n7_vari_ipse_4 <- length(facto7vari_ipse_4)
n7_vari_ipse_5 <- length(facto7vari_ipse_5)
n7_vari_ipse_6 <- length(facto7vari_ipse_6)
n7_vari_ipse_7 <- length(facto7vari_ipse_7)

n7_vari_ipse <- n4_vari_ipse_1+n4_vari_ipse_2+n4_vari_ipse_3+n4_vari_ipse_4+n7_vari_ipse_5+n7_vari_ipse_6+n7_vari_ipse_7

# Créer les scores factoriels
scores7_vari_ipse_1 <- facto7vari_ipse$scores[,1]
scores7_vari_ipse_2 <- facto7vari_ipse$scores[,2]
scores7_vari_ipse_3 <- facto7vari_ipse$scores[,3]
scores7_vari_ipse_4 <- facto7vari_ipse$scores[,4]
scores7_vari_ipse_5 <- facto7vari_ipse$scores[,5]
scores7_vari_ipse_6 <- facto7vari_ipse$scores[,6]
scores7_vari_ipse_7 <- facto7vari_ipse$scores[,7]
```

Le RMSEA est égal à `r facto7vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto7vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto7vari_ipseTLI`.
Le premier facteur explique `r facto7_1vari_ipse_variance` %, le deuxième explique `r facto7_2vari_ipse_variance` %, le troisième `r facto7_3vari_ipse_variance` %, le quatrième `r facto7_4vari_ipse_variance` %, le cinquième `r facto7_5vari_ipse_variance` % , le sixième `r facto7_6vari_ipse_variance` %, le septième `r facto7_7vari_ipse_variance` % de la variance totale pour une variance cumulée égale à `r facto7vari_ipse_variancecum` %.
Le premier facteur compte `r n7_vari_ipse_1` items, le deuxième `r n7_vari_ipse_2` items le troisième `r n7_vari_ipse_3` items, le quatrième `r n7_vari_ipse_4` items, le cinquième `r n7_vari_ipse_5` items, le sixième `r n7_vari_ipse_6` items, le septième `r n7_vari_ipse_7` items pour un total de `r n7_vari_ipse` items.

### Facteur 1 : anger

```{r}
kable(facto7vari_ipse_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2vari_ipse_1)$total$std.alpha, 2)`
```

### Facteur 2 : mistreated

```{r}
kable(facto7vari_ipse_2table_ord)
```

### Facteur 3 : sexual tension

```{r}
kable(facto7vari_ipse_3table_ord)
```

### Facteur 4 : incompetence

```{r}
kable(facto7vari_ipse_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto7vari_ipse_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto7vari_ipse_6table_ord)
```

### Facteur 7 : overwhelmed

```{r}
kable(facto7vari_ipse_7table_ord)
```

## 8 facteurs

```{r}
facto8vari_ipse <- fa(itemsipse.df, nfactors=8, rotate="varimax", use="pairwise")
# print(facto8vari_ipse$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto8vari_ipse)
facto8vari_ipseRMSEA <- round(facto8vari_ipse$RMSEA[["RMSEA"]],2) 
facto8vari_ipsermsr <- round(facto8vari_ipse$rms,2)
facto8vari_ipseTLI <- round(facto8vari_ipse$TLI,2)
facto8_1vari_ipse_variance <- round(facto8vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto8_2vari_ipse_variance <- round(facto8vari_ipse[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto8_3vari_ipse_variance <- round(facto8vari_ipse[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto8_4vari_ipse_variance <- round(facto8vari_ipse[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto8_5vari_ipse_variance <- round(facto8vari_ipse[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto8_6vari_ipse_variance <- round(facto8vari_ipse[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto8_7vari_ipse_variance <- round(facto8vari_ipse[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto8_8vari_ipse_variance <- round(facto8vari_ipse[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8

facto8vari_ipse_variancecum <- facto8_1vari_ipse_variance+facto8_2vari_ipse_variance+facto8_3vari_ipse_variance+ facto8_4vari_ipse_variance+facto8_5vari_ipse_variance+facto8_6vari_ipse_variance+facto8_7vari_ipse_variance+facto8_8vari_ipse_variance

# Distinguer les facteurs

facto8vari_ipse_1 <- which(abs(facto8vari_ipse$loadings[,1]) > .30)
facto8vari_ipse_2 <- which(abs(facto8vari_ipse$loadings[,2]) > .30)
facto8vari_ipse_3 <- which(abs(facto8vari_ipse$loadings[,3]) > .30)
facto8vari_ipse_4 <- which(abs(facto8vari_ipse$loadings[,4]) > .30)
facto8vari_ipse_5 <- which(abs(facto8vari_ipse$loadings[,5]) > .30)
facto8vari_ipse_6 <- which(abs(facto8vari_ipse$loadings[,6]) > .30)
facto8vari_ipse_7 <- which(abs(facto8vari_ipse$loadings[,7]) > .30)
facto8vari_ipse_8 <- which(abs(facto8vari_ipse$loadings[,8]) > .30)

facto8vari_ipse_1.df <- data.frame(facto8vari_ipse_1)
facto8vari_ipse_2.df <- data.frame(facto8vari_ipse_2)
facto8vari_ipse_3.df <- data.frame(facto8vari_ipse_3)
facto8vari_ipse_4.df <- data.frame(facto8vari_ipse_4)
facto8vari_ipse_5.df <- data.frame(facto8vari_ipse_5)
facto8vari_ipse_6.df <- data.frame(facto8vari_ipse_6)
facto8vari_ipse_7.df <- data.frame(facto8vari_ipse_7)
facto8vari_ipse_8.df <- data.frame(facto8vari_ipse_8)

facto8vari_ipse_1vect <- round(as.vector(facto8vari_ipse$loadings[,1][facto8vari_ipse_1]),2)
facto8vari_ipse_2vect <- round(as.vector(facto8vari_ipse$loadings[,2][facto8vari_ipse_2]),2)
facto8vari_ipse_3vect <- round(as.vector(facto8vari_ipse$loadings[,3][facto8vari_ipse_3]),2)
facto8vari_ipse_4vect <- round(as.vector(facto8vari_ipse$loadings[,4][facto8vari_ipse_4]),2)
facto8vari_ipse_5vect <- round(as.vector(facto8vari_ipse$loadings[,5][facto8vari_ipse_5]),2)
facto8vari_ipse_6vect <- round(as.vector(facto8vari_ipse$loadings[,6][facto8vari_ipse_6]),2)
facto8vari_ipse_7vect <- round(as.vector(facto8vari_ipse$loadings[,7][facto8vari_ipse_7]),2)
facto8vari_ipse_8vect <- round(as.vector(facto8vari_ipse$loadings[,8][facto8vari_ipse_8]),2)

facto8vari_ipse_1_labels <- apply(facto8vari_ipse_1.df, 1, find_label)
facto8vari_ipse_2_labels <- apply(facto8vari_ipse_2.df, 1, find_label)
facto8vari_ipse_3_labels <- apply(facto8vari_ipse_3.df, 1, find_label)
facto8vari_ipse_4_labels <- apply(facto8vari_ipse_4.df, 1, find_label)
facto8vari_ipse_5_labels <- apply(facto8vari_ipse_5.df, 1, find_label)
facto8vari_ipse_6_labels <- apply(facto8vari_ipse_6.df, 1, find_label)
facto8vari_ipse_7_labels <- apply(facto8vari_ipse_7.df, 1, find_label)
facto8vari_ipse_8_labels <- apply(facto8vari_ipse_8.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto8vari_ipse_1table <- data.frame(Item=facto8vari_ipse_1, Label=facto8vari_ipse_1_labels, Loading=facto8vari_ipse_1vect)
facto8vari_ipse_1table_ord <- facto8vari_ipse_1table[order(facto8vari_ipse_1vect, decreasing = TRUE),]
#2
facto8vari_ipse_2table <- data.frame(Item=facto8vari_ipse_2, Label=facto8vari_ipse_2_labels, Loading=facto8vari_ipse_2vect)
facto8vari_ipse_2table_ord <- facto8vari_ipse_2table[order(facto8vari_ipse_2vect, decreasing = TRUE),]
#3
facto8vari_ipse_3table <- data.frame(Item=facto8vari_ipse_3, Label=facto8vari_ipse_3_labels, Loading=facto8vari_ipse_3vect)
facto8vari_ipse_3table_ord <- facto8vari_ipse_3table[order(facto8vari_ipse_3vect, decreasing = TRUE),]
#4
facto8vari_ipse_4table <- data.frame(Item=facto8vari_ipse_4, Label=facto8vari_ipse_4_labels, Loading=facto8vari_ipse_4vect)
facto8vari_ipse_4table_ord <- facto8vari_ipse_4table[order(facto8vari_ipse_4vect, decreasing = TRUE),]
#5
facto8vari_ipse_5table <- data.frame(Item=facto8vari_ipse_5, Label=facto8vari_ipse_5_labels, Loading=facto8vari_ipse_5vect)
facto8vari_ipse_5table_ord <- facto8vari_ipse_5table[order(facto8vari_ipse_5vect, decreasing = TRUE),]
#6
facto8vari_ipse_6table <- data.frame(Item=facto8vari_ipse_6, Label=facto8vari_ipse_6_labels, Loading=facto8vari_ipse_6vect)
facto8vari_ipse_6table_ord <- facto8vari_ipse_6table[order(facto8vari_ipse_6vect, decreasing = TRUE),]
#7
facto8vari_ipse_7table <- data.frame(Item=facto8vari_ipse_7, Label=facto8vari_ipse_7_labels, Loading=facto8vari_ipse_7vect)
facto8vari_ipse_7table_ord <- facto8vari_ipse_7table[order(facto8vari_ipse_7vect, decreasing = TRUE),]
#8
facto8vari_ipse_8table <- data.frame(Item=facto8vari_ipse_8, Label=facto8vari_ipse_8_labels, Loading=facto8vari_ipse_8vect)
facto8vari_ipse_8table_ord <- facto8vari_ipse_8table[order(facto8vari_ipse_8vect, decreasing = TRUE),]


# nombre d'items par facteurs
n8_vari_ipse_1 <- length(facto8vari_ipse_1)
n8_vari_ipse_2 <- length(facto8vari_ipse_2)
n8_vari_ipse_3 <- length(facto8vari_ipse_3)
n8_vari_ipse_4 <- length(facto8vari_ipse_4)
n8_vari_ipse_5 <- length(facto8vari_ipse_5)
n8_vari_ipse_6 <- length(facto8vari_ipse_6)
n8_vari_ipse_7 <- length(facto8vari_ipse_7)
n8_vari_ipse_8 <- length(facto8vari_ipse_8)

n8_vari_ipse <- n4_vari_ipse_1+n4_vari_ipse_2+n4_vari_ipse_3+n4_vari_ipse_4+n8_vari_ipse_5+n8_vari_ipse_6+n8_vari_ipse_7+n8_vari_ipse_8

# Créer les scores factoriels
scores8_vari_ipse_1 <- facto8vari_ipse$scores[,1]
scores8_vari_ipse_2 <- facto8vari_ipse$scores[,2]
scores8_vari_ipse_3 <- facto8vari_ipse$scores[,3]
scores8_vari_ipse_4 <- facto8vari_ipse$scores[,4]
scores8_vari_ipse_5 <- facto8vari_ipse$scores[,5]
scores8_vari_ipse_6 <- facto8vari_ipse$scores[,6]
scores8_vari_ipse_7 <- facto8vari_ipse$scores[,7]
scores8_vari_ipse_8 <- facto8vari_ipse$scores[,8]
```

Le RMSEA est égal à `r facto8vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto8vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto8vari_ipseTLI`.
Le premier facteur explique `r facto8_1vari_ipse_variance` %, le deuxième explique `r facto8_2vari_ipse_variance` %, le troisième `r facto8_3vari_ipse_variance` %, le quatrième `r facto8_4vari_ipse_variance` %, le cinquième `r facto8_5vari_ipse_variance` % , le sixième `r facto8_6vari_ipse_variance` %, le septième `r facto8_7vari_ipse_variance` %, le huitième `r facto8_8vari_ipse_variance` %  de la variance totale pour une variance cumulée égale à `r facto8vari_ipse_variancecum` %.
Le premier facteur compte `r n8_vari_ipse_1` items, le deuxième `r n8_vari_ipse_2` items le troisième `r n8_vari_ipse_3` items, le quatrième `r n8_vari_ipse_4` items, le cinquième `r n8_vari_ipse_5` items, le sixième `r n8_vari_ipse_6` items, le septième `r n8_vari_ipse_7` items, le huitième `r n8_vari_ipse_8` items pour un total de `r n8_vari_ipse` items.

### Facteur 1 : incompetence

```{r}
kable(facto8vari_ipse_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2vari_ipse_1)$total$std.alpha, 2)`
```

### Facteur 2 : mistreated

```{r}
kable(facto8vari_ipse_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto8vari_ipse_3table_ord)
```

### Facteur 4 : disengaged

```{r}
kable(facto8vari_ipse_4table_ord)
```

### Facteur 5 : distrust

```{r}
kable(facto8vari_ipse_5table_ord)
```

### Facteur 6 : loss of professional distance

```{r}
kable(facto8vari_ipse_6table_ord)
```

### Facteur 7 : seduction

```{r}
kable(facto8vari_ipse_7table_ord)
```

### Facteur 8 : overwhelmed

```{r}
kable(facto8vari_ipse_8table_ord)
```

## 9 facteurs

```{r}
facto9vari_ipse <- fa(itemsipse.df, nfactors=9, rotate="varimax", use="pairwise")
# print(facto9vari_ipse$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto9vari_ipse)
facto9vari_ipseRMSEA <- round(facto9vari_ipse$RMSEA[["RMSEA"]],2) 
facto9vari_ipsermsr <- round(facto9vari_ipse$rms,2)
facto9vari_ipseTLI <- round(facto9vari_ipse$TLI,2)
facto9_1vari_ipse_variance <- round(facto9vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto9_2vari_ipse_variance <- round(facto9vari_ipse[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto9_3vari_ipse_variance <- round(facto9vari_ipse[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto9_4vari_ipse_variance <- round(facto9vari_ipse[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto9_5vari_ipse_variance <- round(facto9vari_ipse[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto9_6vari_ipse_variance <- round(facto9vari_ipse[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto9_7vari_ipse_variance <- round(facto9vari_ipse[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto9_8vari_ipse_variance <- round(facto9vari_ipse[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8
facto9_9vari_ipse_variance <- round(facto9vari_ipse[["Vaccounted"]][2,9]*100,0) #obtenir la variance expliquée pour le facteur 9

facto9vari_ipse_variancecum <- facto9_1vari_ipse_variance+facto9_2vari_ipse_variance+facto9_3vari_ipse_variance+ facto9_4vari_ipse_variance+facto9_5vari_ipse_variance+facto9_6vari_ipse_variance+facto9_7vari_ipse_variance+facto9_8vari_ipse_variance+facto9_9vari_ipse_variance 

# Distinguer les facteurs

facto9vari_ipse_1 <- which(abs(facto9vari_ipse$loadings[,1]) > .30)
facto9vari_ipse_2 <- which(abs(facto9vari_ipse$loadings[,2]) > .30)
facto9vari_ipse_3 <- which(abs(facto9vari_ipse$loadings[,3]) > .30)
facto9vari_ipse_4 <- which(abs(facto9vari_ipse$loadings[,4]) > .30)
facto9vari_ipse_5 <- which(abs(facto9vari_ipse$loadings[,5]) > .30)
facto9vari_ipse_6 <- which(abs(facto9vari_ipse$loadings[,6]) > .30)
facto9vari_ipse_7 <- which(abs(facto9vari_ipse$loadings[,7]) > .30)
facto9vari_ipse_8 <- which(abs(facto9vari_ipse$loadings[,8]) > .30)
facto9vari_ipse_9 <- which(abs(facto9vari_ipse$loadings[,9]) > .30)

facto9vari_ipse_1.df <- data.frame(facto9vari_ipse_1)
facto9vari_ipse_2.df <- data.frame(facto9vari_ipse_2)
facto9vari_ipse_3.df <- data.frame(facto9vari_ipse_3)
facto9vari_ipse_4.df <- data.frame(facto9vari_ipse_4)
facto9vari_ipse_5.df <- data.frame(facto9vari_ipse_5)
facto9vari_ipse_6.df <- data.frame(facto9vari_ipse_6)
facto9vari_ipse_7.df <- data.frame(facto9vari_ipse_7)
facto9vari_ipse_8.df <- data.frame(facto9vari_ipse_8)
facto9vari_ipse_9.df <- data.frame(facto9vari_ipse_9)

facto9vari_ipse_1vect <- round(as.vector(facto9vari_ipse$loadings[,1][facto9vari_ipse_1]),2)
facto9vari_ipse_2vect <- round(as.vector(facto9vari_ipse$loadings[,2][facto9vari_ipse_2]),2)
facto9vari_ipse_3vect <- round(as.vector(facto9vari_ipse$loadings[,3][facto9vari_ipse_3]),2)
facto9vari_ipse_4vect <- round(as.vector(facto9vari_ipse$loadings[,4][facto9vari_ipse_4]),2)
facto9vari_ipse_5vect <- round(as.vector(facto9vari_ipse$loadings[,5][facto9vari_ipse_5]),2)
facto9vari_ipse_6vect <- round(as.vector(facto9vari_ipse$loadings[,6][facto9vari_ipse_6]),2)
facto9vari_ipse_7vect <- round(as.vector(facto9vari_ipse$loadings[,7][facto9vari_ipse_7]),2)
facto9vari_ipse_8vect <- round(as.vector(facto9vari_ipse$loadings[,8][facto9vari_ipse_8]),2)
facto9vari_ipse_9vect <- round(as.vector(facto9vari_ipse$loadings[,9][facto9vari_ipse_9]),2)

facto9vari_ipse_1_labels <- apply(facto9vari_ipse_1.df, 1, find_label)
facto9vari_ipse_2_labels <- apply(facto9vari_ipse_2.df, 1, find_label)
facto9vari_ipse_3_labels <- apply(facto9vari_ipse_3.df, 1, find_label)
facto9vari_ipse_4_labels <- apply(facto9vari_ipse_4.df, 1, find_label)
facto9vari_ipse_5_labels <- apply(facto9vari_ipse_5.df, 1, find_label)
facto9vari_ipse_6_labels <- apply(facto9vari_ipse_6.df, 1, find_label)
facto9vari_ipse_7_labels <- apply(facto9vari_ipse_7.df, 1, find_label)
facto9vari_ipse_8_labels <- apply(facto9vari_ipse_8.df, 1, find_label)
facto9vari_ipse_9_labels <- apply(facto9vari_ipse_9.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto9vari_ipse_1table <- data.frame(Item=facto9vari_ipse_1, Label=facto9vari_ipse_1_labels, Loading=facto9vari_ipse_1vect)
facto9vari_ipse_1table_ord <- facto9vari_ipse_1table[order(facto9vari_ipse_1vect, decreasing = TRUE),]
#2
facto9vari_ipse_2table <- data.frame(Item=facto9vari_ipse_2, Label=facto9vari_ipse_2_labels, Loading=facto9vari_ipse_2vect)
facto9vari_ipse_2table_ord <- facto9vari_ipse_2table[order(facto9vari_ipse_2vect, decreasing = TRUE),]
#3
facto9vari_ipse_3table <- data.frame(Item=facto9vari_ipse_3, Label=facto9vari_ipse_3_labels, Loading=facto9vari_ipse_3vect)
facto9vari_ipse_3table_ord <- facto9vari_ipse_3table[order(facto9vari_ipse_3vect, decreasing = TRUE),]
#4
facto9vari_ipse_4table <- data.frame(Item=facto9vari_ipse_4, Label=facto9vari_ipse_4_labels, Loading=facto9vari_ipse_4vect)
facto9vari_ipse_4table_ord <- facto9vari_ipse_4table[order(facto9vari_ipse_4vect, decreasing = TRUE),]
#5
facto9vari_ipse_5table <- data.frame(Item=facto9vari_ipse_5, Label=facto9vari_ipse_5_labels, Loading=facto9vari_ipse_5vect)
facto9vari_ipse_5table_ord <- facto9vari_ipse_5table[order(facto9vari_ipse_5vect, decreasing = TRUE),]
#6
facto9vari_ipse_6table <- data.frame(Item=facto9vari_ipse_6, Label=facto9vari_ipse_6_labels, Loading=facto9vari_ipse_6vect)
facto9vari_ipse_6table_ord <- facto9vari_ipse_6table[order(facto9vari_ipse_6vect, decreasing = TRUE),]
#7
facto9vari_ipse_7table <- data.frame(Item=facto9vari_ipse_7, Label=facto9vari_ipse_7_labels, Loading=facto9vari_ipse_7vect)
facto9vari_ipse_7table_ord <- facto9vari_ipse_7table[order(facto9vari_ipse_7vect, decreasing = TRUE),]
#8
facto9vari_ipse_8table <- data.frame(Item=facto9vari_ipse_8, Label=facto9vari_ipse_8_labels, Loading=facto9vari_ipse_8vect)
facto9vari_ipse_8table_ord <- facto9vari_ipse_8table[order(facto9vari_ipse_8vect, decreasing = TRUE),]
#9
facto9vari_ipse_9table <- data.frame(Item=facto9vari_ipse_9, Label=facto9vari_ipse_9_labels, Loading=facto9vari_ipse_9vect)
facto9vari_ipse_9table_ord <- facto9vari_ipse_9table[order(facto9vari_ipse_9vect, decreasing = TRUE),]


# nombre d'items par facteurs
n9_vari_ipse_1 <- length(facto9vari_ipse_1)
n9_vari_ipse_2 <- length(facto9vari_ipse_2)
n9_vari_ipse_3 <- length(facto9vari_ipse_3)
n9_vari_ipse_4 <- length(facto9vari_ipse_4)
n9_vari_ipse_5 <- length(facto9vari_ipse_5)
n9_vari_ipse_6 <- length(facto9vari_ipse_6)
n9_vari_ipse_7 <- length(facto9vari_ipse_7)
n9_vari_ipse_8 <- length(facto9vari_ipse_8)
n9_vari_ipse_9 <- length(facto9vari_ipse_9)

n9_vari_ipse <- n4_vari_ipse_1+n4_vari_ipse_2+n4_vari_ipse_3+n4_vari_ipse_4+n9_vari_ipse_5+n9_vari_ipse_6+n9_vari_ipse_7+n9_vari_ipse_8+n9_vari_ipse_9 

# Créer les scores factoriels
scores9_vari_ipse_1 <- facto9vari_ipse$scores[,1]
scores9_vari_ipse_2 <- facto9vari_ipse$scores[,2]
scores9_vari_ipse_3 <- facto9vari_ipse$scores[,3]
scores9_vari_ipse_4 <- facto9vari_ipse$scores[,4]
scores9_vari_ipse_5 <- facto9vari_ipse$scores[,5]
scores9_vari_ipse_6 <- facto9vari_ipse$scores[,6]
scores9_vari_ipse_7 <- facto9vari_ipse$scores[,7]
scores9_vari_ipse_8 <- facto9vari_ipse$scores[,8]
scores9_vari_ipse_9 <- facto9vari_ipse$scores[,9]
```

Le RMSEA est égal à `r facto9vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto9vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto9vari_ipseTLI`.
Le premier facteur explique `r facto9_1vari_ipse_variance` %, le deuxième explique `r facto9_2vari_ipse_variance` %, le troisième `r facto9_3vari_ipse_variance` %, le quatrième `r facto9_4vari_ipse_variance` %, le cinquième `r facto9_5vari_ipse_variance` % , le sixième `r facto9_6vari_ipse_variance` %, le septième `r facto9_7vari_ipse_variance` %, le huitième `r facto9_8vari_ipse_variance` %, le neuvième `r facto9_9vari_ipse_variance` %  de la variance totale pour une variance cumulée égale à `r facto9vari_ipse_variancecum` %.
Le premier facteur compte `r n9_vari_ipse_1` items, le deuxième `r n9_vari_ipse_2` items le troisième `r n9_vari_ipse_3` items, le quatrième `r n9_vari_ipse_4` items, le cinquième `r n9_vari_ipse_5` items, le sixième `r n9_vari_ipse_6` items, le septième `r n9_vari_ipse_7` items, le huitième `r n9_vari_ipse_8` items, le neuvième `r n9_vari_ipse_9` items pour un total de `r n9_vari_ipse` items.

### Facteur 1 : incompetence

```{r}
kable(facto9vari_ipse_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2vari_ipse_1)$total$std.alpha, 2)`
```

### Facteur 2 : mistreated

```{r}
kable(facto9vari_ipse_2table_ord)
```

### Facteur 3 : loss of professional distance

```{r}
kable(facto9vari_ipse_3table_ord)
```

### Facteur 4 : anger

```{r}
kable(facto9vari_ipse_4table_ord)
```

### Facteur 5 : seduction

```{r}
kable(facto9vari_ipse_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto9vari_ipse_6table_ord)
```

### Facteur 7 : sadeness

```{r}
kable(facto9vari_ipse_7table_ord)
```

### Facteur 8 : overwhelmed

```{r}
kable(facto9vari_ipse_8table_ord)
```

### Facteur 9 : dislike

```{r}
kable(facto9vari_ipse_9table_ord)
```

## 10 facteurs

```{r}
facto10vari_ipse <- fa(items.df, nfactors=10, rotate="varimax", use="pairwise")
# print(facto10vari_ipse$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto10vari_ipse)
facto10vari_ipseRMSEA <- round(facto10vari_ipse$RMSEA[["RMSEA"]],2) 
facto10vari_ipsermsr <- round(facto10vari_ipse$rms,2)
facto10vari_ipseTLI <- round(facto10vari_ipse$TLI,2)
facto10_1vari_ipse_variance <- round(facto10vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto10_2vari_ipse_variance <- round(facto10vari_ipse[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto10_3vari_ipse_variance <- round(facto10vari_ipse[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto10_4vari_ipse_variance <- round(facto10vari_ipse[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto10_5vari_ipse_variance <- round(facto10vari_ipse[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto10_6vari_ipse_variance <- round(facto10vari_ipse[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto10_7vari_ipse_variance <- round(facto10vari_ipse[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto10_8vari_ipse_variance <- round(facto10vari_ipse[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8
facto10_9vari_ipse_variance <- round(facto10vari_ipse[["Vaccounted"]][2,9]*100,0) #obtenir la variance expliquée pour le facteur 9
facto10_10vari_ipse_variance <- round(facto10vari_ipse[["Vaccounted"]][2,10]*100,0) #obtenir la variance expliquée pour le facteur 10

facto10vari_ipse_variancecum <- facto10_1vari_ipse_variance+facto10_2vari_ipse_variance+facto10_3vari_ipse_variance+ facto10_4vari_ipse_variance+facto10_5vari_ipse_variance+facto10_6vari_ipse_variance+facto10_7vari_ipse_variance+facto10_8vari_ipse_variance+facto10_9vari_ipse_variance+facto10_10vari_ipse_variance 

# Distinguer les facteurs

facto10vari_ipse_1 <- which(abs(facto10vari_ipse$loadings[,1]) > .30)
facto10vari_ipse_2 <- which(abs(facto10vari_ipse$loadings[,2]) > .30)
facto10vari_ipse_3 <- which(abs(facto10vari_ipse$loadings[,3]) > .30)
facto10vari_ipse_4 <- which(abs(facto10vari_ipse$loadings[,4]) > .30)
facto10vari_ipse_5 <- which(abs(facto10vari_ipse$loadings[,5]) > .30)
facto10vari_ipse_6 <- which(abs(facto10vari_ipse$loadings[,6]) > .30)
facto10vari_ipse_7 <- which(abs(facto10vari_ipse$loadings[,7]) > .30)
facto10vari_ipse_8 <- which(abs(facto10vari_ipse$loadings[,8]) > .30)
facto10vari_ipse_9 <- which(abs(facto10vari_ipse$loadings[,9]) > .30)
facto10vari_ipse_10 <- which(abs(facto10vari_ipse$loadings[,10]) > .30)

facto10vari_ipse_1.df <- data.frame(facto10vari_ipse_1)
facto10vari_ipse_2.df <- data.frame(facto10vari_ipse_2)
facto10vari_ipse_3.df <- data.frame(facto10vari_ipse_3)
facto10vari_ipse_4.df <- data.frame(facto10vari_ipse_4)
facto10vari_ipse_5.df <- data.frame(facto10vari_ipse_5)
facto10vari_ipse_6.df <- data.frame(facto10vari_ipse_6)
facto10vari_ipse_7.df <- data.frame(facto10vari_ipse_7)
facto10vari_ipse_8.df <- data.frame(facto10vari_ipse_8)
facto10vari_ipse_9.df <- data.frame(facto10vari_ipse_9)
facto10vari_ipse_10.df <- data.frame(facto10vari_ipse_10)

facto10vari_ipse_1vect <- round(as.vector(facto10vari_ipse$loadings[,1][facto10vari_ipse_1]),2)
facto10vari_ipse_2vect <- round(as.vector(facto10vari_ipse$loadings[,2][facto10vari_ipse_2]),2)
facto10vari_ipse_3vect <- round(as.vector(facto10vari_ipse$loadings[,3][facto10vari_ipse_3]),2)
facto10vari_ipse_4vect <- round(as.vector(facto10vari_ipse$loadings[,4][facto10vari_ipse_4]),2)
facto10vari_ipse_5vect <- round(as.vector(facto10vari_ipse$loadings[,5][facto10vari_ipse_5]),2)
facto10vari_ipse_6vect <- round(as.vector(facto10vari_ipse$loadings[,6][facto10vari_ipse_6]),2)
facto10vari_ipse_7vect <- round(as.vector(facto10vari_ipse$loadings[,7][facto10vari_ipse_7]),2)
facto10vari_ipse_8vect <- round(as.vector(facto10vari_ipse$loadings[,8][facto10vari_ipse_8]),2)
facto10vari_ipse_9vect <- round(as.vector(facto10vari_ipse$loadings[,9][facto10vari_ipse_9]),2)
facto10vari_ipse_10vect <- round(as.vector(facto10vari_ipse$loadings[,10][facto10vari_ipse_10]),2)

facto10vari_ipse_1_labels <- apply(facto10vari_ipse_1.df, 1, find_label)
facto10vari_ipse_2_labels <- apply(facto10vari_ipse_2.df, 1, find_label)
facto10vari_ipse_3_labels <- apply(facto10vari_ipse_3.df, 1, find_label)
facto10vari_ipse_4_labels <- apply(facto10vari_ipse_4.df, 1, find_label)
facto10vari_ipse_5_labels <- apply(facto10vari_ipse_5.df, 1, find_label)
facto10vari_ipse_6_labels <- apply(facto10vari_ipse_6.df, 1, find_label)
facto10vari_ipse_7_labels <- apply(facto10vari_ipse_7.df, 1, find_label)
facto10vari_ipse_8_labels <- apply(facto10vari_ipse_8.df, 1, find_label)
facto10vari_ipse_9_labels <- apply(facto10vari_ipse_9.df, 1, find_label)
facto10vari_ipse_10_labels <- apply(facto10vari_ipse_10.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto10vari_ipse_1table <- data.frame(Item=facto10vari_ipse_1, Label=facto10vari_ipse_1_labels, Loading=facto10vari_ipse_1vect)
facto10vari_ipse_1table_ord <- facto10vari_ipse_1table[order(facto10vari_ipse_1vect, decreasing = TRUE),]
#2
facto10vari_ipse_2table <- data.frame(Item=facto10vari_ipse_2, Label=facto10vari_ipse_2_labels, Loading=facto10vari_ipse_2vect)
facto10vari_ipse_2table_ord <- facto10vari_ipse_2table[order(facto10vari_ipse_2vect, decreasing = TRUE),]
#3
facto10vari_ipse_3table <- data.frame(Item=facto10vari_ipse_3, Label=facto10vari_ipse_3_labels, Loading=facto10vari_ipse_3vect)
facto10vari_ipse_3table_ord <- facto10vari_ipse_3table[order(facto10vari_ipse_3vect, decreasing = TRUE),]
#4
facto10vari_ipse_4table <- data.frame(Item=facto10vari_ipse_4, Label=facto10vari_ipse_4_labels, Loading=facto10vari_ipse_4vect)
facto10vari_ipse_4table_ord <- facto10vari_ipse_4table[order(facto10vari_ipse_4vect, decreasing = TRUE),]
#5
facto10vari_ipse_5table <- data.frame(Item=facto10vari_ipse_5, Label=facto10vari_ipse_5_labels, Loading=facto10vari_ipse_5vect)
facto10vari_ipse_5table_ord <- facto10vari_ipse_5table[order(facto10vari_ipse_5vect, decreasing = TRUE),]
#6
facto10vari_ipse_6table <- data.frame(Item=facto10vari_ipse_6, Label=facto10vari_ipse_6_labels, Loading=facto10vari_ipse_6vect)
facto10vari_ipse_6table_ord <- facto10vari_ipse_6table[order(facto10vari_ipse_6vect, decreasing = TRUE),]
#7
facto10vari_ipse_7table <- data.frame(Item=facto10vari_ipse_7, Label=facto10vari_ipse_7_labels, Loading=facto10vari_ipse_7vect)
facto10vari_ipse_7table_ord <- facto10vari_ipse_7table[order(facto10vari_ipse_7vect, decreasing = TRUE),]
#8
facto10vari_ipse_8table <- data.frame(Item=facto10vari_ipse_8, Label=facto10vari_ipse_8_labels, Loading=facto10vari_ipse_8vect)
facto10vari_ipse_8table_ord <- facto10vari_ipse_8table[order(facto10vari_ipse_8vect, decreasing = TRUE),]
#9
facto10vari_ipse_9table <- data.frame(Item=facto10vari_ipse_9, Label=facto10vari_ipse_9_labels, Loading=facto10vari_ipse_9vect)
facto10vari_ipse_9table_ord <- facto10vari_ipse_9table[order(facto10vari_ipse_9vect, decreasing = TRUE),]
#10
facto10vari_ipse_10table <- data.frame(Item=facto10vari_ipse_10, Label=facto10vari_ipse_10_labels, Loading=facto10vari_ipse_10vect)
facto10vari_ipse_10table_ord <- facto10vari_ipse_10table[order(facto10vari_ipse_10vect, decreasing = TRUE),]


# nombre d'items par facteurs
n10_vari_ipse_1 <- length(facto10vari_ipse_1)
n10_vari_ipse_2 <- length(facto10vari_ipse_2)
n10_vari_ipse_3 <- length(facto10vari_ipse_3)
n10_vari_ipse_4 <- length(facto10vari_ipse_4)
n10_vari_ipse_5 <- length(facto10vari_ipse_5)
n10_vari_ipse_6 <- length(facto10vari_ipse_6)
n10_vari_ipse_7 <- length(facto10vari_ipse_7)
n10_vari_ipse_8 <- length(facto10vari_ipse_8)
n10_vari_ipse_9 <- length(facto10vari_ipse_9)
n10_vari_ipse_10 <- length(facto10vari_ipse_10)

n10_vari_ipse <- n4_vari_ipse_1+n4_vari_ipse_2+n4_vari_ipse_3+n4_vari_ipse_4+n9_vari_ipse_5+n9_vari_ipse_6+n9_vari_ipse_7+n9_vari_ipse_8+n9_vari_ipse_9+n10_vari_ipse_10 

# Créer les scores factoriels
scores10_vari_ipse_1 <- facto10vari_ipse$scores[,1]
scores10_vari_ipse_2 <- facto10vari_ipse$scores[,2]
scores10_vari_ipse_3 <- facto10vari_ipse$scores[,3]
scores10_vari_ipse_4 <- facto10vari_ipse$scores[,4]
scores10_vari_ipse_5 <- facto10vari_ipse$scores[,5]
scores10_vari_ipse_6 <- facto10vari_ipse$scores[,6]
scores10_vari_ipse_7 <- facto10vari_ipse$scores[,7]
scores10_vari_ipse_8 <- facto10vari_ipse$scores[,8]
scores10_vari_ipse_9 <- facto10vari_ipse$scores[,9]
scores10_vari_ipse_10 <- facto10vari_ipse$scores[,10]
```

Le RMSEA est égal à `r facto10vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto10vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto10vari_ipseTLI`.
Le premier facteur explique `r facto10_1vari_ipse_variance` %, le deuxième explique `r facto10_2vari_ipse_variance` %, le troisième `r facto10_3vari_ipse_variance` %, le quatrième `r facto10_4vari_ipse_variance` %, le cinquième `r facto10_5vari_ipse_variance` % , le sixième `r facto10_6vari_ipse_variance` %, le septième `r facto10_7vari_ipse_variance` %, le huitième `r facto10_8vari_ipse_variance` %, le neuvième `r facto10_9vari_ipse_variance` %  de la variance totale pour une variance cumulée égale à `r facto10vari_ipse_variancecum` %.
Le premier facteur compte `r n9_vari_ipse_1` items, le deuxième `r n9_vari_ipse_2` items le troisième `r n9_vari_ipse_3` items, le quatrième `r n9_vari_ipse_4` items, le cinquième `r n9_vari_ipse_5` items, le sixième `r n9_vari_ipse_6` items, le septième `r n9_vari_ipse_7` items, le huitième `r n9_vari_ipse_8` items, le neuvième `r n9_vari_ipse_9` items pour un total de `r n9_vari_ipse` items.

### Facteur 1 : mistreated

```{r}
kable(facto10vari_ipse_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2vari_ipse_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto10vari_ipse_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto10vari_ipse_3table_ord)
```

### Facteur 4 : boredom

```{r}
kable(facto10vari_ipse_4table_ord)
```

### Facteur 5 : loss of professional distance

```{r}
kable(facto10vari_ipse_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto10vari_ipse_6table_ord)
```

### Facteur 7 : seduction

```{r}
kable(facto10vari_ipse_7table_ord)
```

### Facteur 8 : distrust

```{r}
kable(facto10vari_ipse_8table_ord)
```

### Facteur 9 : overwhelmed

```{r}
kable(facto10vari_ipse_9table_ord)
```

### Facteur 10 : jalousy

```{r}
kable(facto10vari_ipse_10table_ord)
```

## 11 facteurs

```{r}
facto11vari_ipse <- fa(items.df, nfactors=11, rotate="varimax", use="pairwise")
# print(facto11vari_ipse$loadings,sort=TRUE,digits=2,cutoff=0.4)
fa.diagram(facto11vari_ipse)
facto11vari_ipseRMSEA <- round(facto11vari_ipse$RMSEA[["RMSEA"]],2) 
facto11vari_ipsermsr <- round(facto11vari_ipse$rms,2)
facto11vari_ipseTLI <- round(facto11vari_ipse$TLI,2)
facto11_1vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,1]*100,0) #obtenir la variance expliquée pour le facteur 1
facto11_2vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,2]*100,0) #obtenir la variance expliquée pour le facteur 2
facto11_3vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,3]*100,0) #obtenir la variance expliquée pour le facteur 3
facto11_4vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,4]*100,0) #obtenir la variance expliquée pour le facteur 4
facto11_5vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,5]*100,0) #obtenir la variance expliquée pour le facteur 5
facto11_6vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,6]*100,0) #obtenir la variance expliquée pour le facteur 6
facto11_7vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,7]*100,0) #obtenir la variance expliquée pour le facteur 7
facto11_8vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,8]*100,0) #obtenir la variance expliquée pour le facteur 8
facto11_9vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,9]*100,0) #obtenir la variance expliquée pour le facteur 9
facto11_10vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,10]*100,0) #obtenir la variance expliquée pour le facteur 10
facto11_11vari_ipse_variance <- round(facto11vari_ipse[["Vaccounted"]][2,11]*100,0) #obtenir la variance expliquée pour le facteur 11

facto11vari_ipse_variancecum <- facto11_1vari_ipse_variance+facto11_2vari_ipse_variance+facto11_3vari_ipse_variance+ facto11_4vari_ipse_variance+facto11_5vari_ipse_variance+facto11_6vari_ipse_variance+facto11_7vari_ipse_variance+facto11_8vari_ipse_variance+facto11_9vari_ipse_variance+facto11_10vari_ipse_variance+facto11_11vari_ipse_variance 

# Distinguer les facteurs

facto11vari_ipse_1 <- which(abs(facto11vari_ipse$loadings[,1]) > .30)
facto11vari_ipse_2 <- which(abs(facto11vari_ipse$loadings[,2]) > .30)
facto11vari_ipse_3 <- which(abs(facto11vari_ipse$loadings[,3]) > .30)
facto11vari_ipse_4 <- which(abs(facto11vari_ipse$loadings[,4]) > .30)
facto11vari_ipse_5 <- which(abs(facto11vari_ipse$loadings[,5]) > .30)
facto11vari_ipse_6 <- which(abs(facto11vari_ipse$loadings[,6]) > .30)
facto11vari_ipse_7 <- which(abs(facto11vari_ipse$loadings[,7]) > .30)
facto11vari_ipse_8 <- which(abs(facto11vari_ipse$loadings[,8]) > .30)
facto11vari_ipse_9 <- which(abs(facto11vari_ipse$loadings[,9]) > .30)
facto11vari_ipse_10 <- which(abs(facto11vari_ipse$loadings[,10]) > .30)
facto11vari_ipse_11 <- which(abs(facto11vari_ipse$loadings[,11]) > .30)

facto11vari_ipse_1.df <- data.frame(facto11vari_ipse_1)
facto11vari_ipse_2.df <- data.frame(facto11vari_ipse_2)
facto11vari_ipse_3.df <- data.frame(facto11vari_ipse_3)
facto11vari_ipse_4.df <- data.frame(facto11vari_ipse_4)
facto11vari_ipse_5.df <- data.frame(facto11vari_ipse_5)
facto11vari_ipse_6.df <- data.frame(facto11vari_ipse_6)
facto11vari_ipse_7.df <- data.frame(facto11vari_ipse_7)
facto11vari_ipse_8.df <- data.frame(facto11vari_ipse_8)
facto11vari_ipse_9.df <- data.frame(facto11vari_ipse_9)
facto11vari_ipse_10.df <- data.frame(facto11vari_ipse_10)
facto11vari_ipse_11.df <- data.frame(facto11vari_ipse_11)

facto11vari_ipse_1vect <- round(as.vector(facto11vari_ipse$loadings[,1][facto11vari_ipse_1]),2)
facto11vari_ipse_2vect <- round(as.vector(facto11vari_ipse$loadings[,2][facto11vari_ipse_2]),2)
facto11vari_ipse_3vect <- round(as.vector(facto11vari_ipse$loadings[,3][facto11vari_ipse_3]),2)
facto11vari_ipse_4vect <- round(as.vector(facto11vari_ipse$loadings[,4][facto11vari_ipse_4]),2)
facto11vari_ipse_5vect <- round(as.vector(facto11vari_ipse$loadings[,5][facto11vari_ipse_5]),2)
facto11vari_ipse_6vect <- round(as.vector(facto11vari_ipse$loadings[,6][facto11vari_ipse_6]),2)
facto11vari_ipse_7vect <- round(as.vector(facto11vari_ipse$loadings[,7][facto11vari_ipse_7]),2)
facto11vari_ipse_8vect <- round(as.vector(facto11vari_ipse$loadings[,8][facto11vari_ipse_8]),2)
facto11vari_ipse_9vect <- round(as.vector(facto11vari_ipse$loadings[,9][facto11vari_ipse_9]),2)
facto11vari_ipse_10vect <- round(as.vector(facto11vari_ipse$loadings[,10][facto11vari_ipse_10]),2)
facto11vari_ipse_11vect <- round(as.vector(facto11vari_ipse$loadings[,11][facto11vari_ipse_11]),2)

facto11vari_ipse_1_labels <- apply(facto11vari_ipse_1.df, 1, find_label)
facto11vari_ipse_2_labels <- apply(facto11vari_ipse_2.df, 1, find_label)
facto11vari_ipse_3_labels <- apply(facto11vari_ipse_3.df, 1, find_label)
facto11vari_ipse_4_labels <- apply(facto11vari_ipse_4.df, 1, find_label)
facto11vari_ipse_5_labels <- apply(facto11vari_ipse_5.df, 1, find_label)
facto11vari_ipse_6_labels <- apply(facto11vari_ipse_6.df, 1, find_label)
facto11vari_ipse_7_labels <- apply(facto11vari_ipse_7.df, 1, find_label)
facto11vari_ipse_8_labels <- apply(facto11vari_ipse_8.df, 1, find_label)
facto11vari_ipse_9_labels <- apply(facto11vari_ipse_9.df, 1, find_label)
facto11vari_ipse_10_labels <- apply(facto11vari_ipse_10.df, 1, find_label)
facto11vari_ipse_11_labels <- apply(facto11vari_ipse_11.df, 1, find_label)

# Tableaux pour chaque facteur
# 1
facto11vari_ipse_1table <- data.frame(Item=facto11vari_ipse_1, Label=facto11vari_ipse_1_labels, Loading=facto11vari_ipse_1vect)
facto11vari_ipse_1table_ord <- facto11vari_ipse_1table[order(facto11vari_ipse_1vect, decreasing = TRUE),]
#2
facto11vari_ipse_2table <- data.frame(Item=facto11vari_ipse_2, Label=facto11vari_ipse_2_labels, Loading=facto11vari_ipse_2vect)
facto11vari_ipse_2table_ord <- facto11vari_ipse_2table[order(facto11vari_ipse_2vect, decreasing = TRUE),]
#3
facto11vari_ipse_3table <- data.frame(Item=facto11vari_ipse_3, Label=facto11vari_ipse_3_labels, Loading=facto11vari_ipse_3vect)
facto11vari_ipse_3table_ord <- facto11vari_ipse_3table[order(facto11vari_ipse_3vect, decreasing = TRUE),]
#4
facto11vari_ipse_4table <- data.frame(Item=facto11vari_ipse_4, Label=facto11vari_ipse_4_labels, Loading=facto11vari_ipse_4vect)
facto11vari_ipse_4table_ord <- facto11vari_ipse_4table[order(facto11vari_ipse_4vect, decreasing = TRUE),]
#5
facto11vari_ipse_5table <- data.frame(Item=facto11vari_ipse_5, Label=facto11vari_ipse_5_labels, Loading=facto11vari_ipse_5vect)
facto11vari_ipse_5table_ord <- facto11vari_ipse_5table[order(facto11vari_ipse_5vect, decreasing = TRUE),]
#6
facto11vari_ipse_6table <- data.frame(Item=facto11vari_ipse_6, Label=facto11vari_ipse_6_labels, Loading=facto11vari_ipse_6vect)
facto11vari_ipse_6table_ord <- facto11vari_ipse_6table[order(facto11vari_ipse_6vect, decreasing = TRUE),]
#7
facto11vari_ipse_7table <- data.frame(Item=facto11vari_ipse_7, Label=facto11vari_ipse_7_labels, Loading=facto11vari_ipse_7vect)
facto11vari_ipse_7table_ord <- facto11vari_ipse_7table[order(facto11vari_ipse_7vect, decreasing = TRUE),]
#8
facto11vari_ipse_8table <- data.frame(Item=facto11vari_ipse_8, Label=facto11vari_ipse_8_labels, Loading=facto11vari_ipse_8vect)
facto11vari_ipse_8table_ord <- facto11vari_ipse_8table[order(facto11vari_ipse_8vect, decreasing = TRUE),]
#9
facto11vari_ipse_9table <- data.frame(Item=facto11vari_ipse_9, Label=facto11vari_ipse_9_labels, Loading=facto11vari_ipse_9vect)
facto11vari_ipse_9table_ord <- facto11vari_ipse_9table[order(facto11vari_ipse_9vect, decreasing = TRUE),]
#10
facto11vari_ipse_10table <- data.frame(Item=facto11vari_ipse_10, Label=facto11vari_ipse_10_labels, Loading=facto11vari_ipse_10vect)
facto11vari_ipse_10table_ord <- facto11vari_ipse_10table[order(facto11vari_ipse_10vect, decreasing = TRUE),]
#11
facto11vari_ipse_11table <- data.frame(Item=facto11vari_ipse_11, Label=facto11vari_ipse_11_labels, Loading=facto11vari_ipse_11vect)
facto11vari_ipse_11table_ord <- facto11vari_ipse_11table[order(facto11vari_ipse_11vect, decreasing = TRUE),]


# nombre d'items par facteurs
n11_vari_ipse_1 <- length(facto11vari_ipse_1)
n11_vari_ipse_2 <- length(facto11vari_ipse_2)
n11_vari_ipse_3 <- length(facto11vari_ipse_3)
n11_vari_ipse_4 <- length(facto11vari_ipse_4)
n11_vari_ipse_5 <- length(facto11vari_ipse_5)
n11_vari_ipse_6 <- length(facto11vari_ipse_6)
n11_vari_ipse_7 <- length(facto11vari_ipse_7)
n11_vari_ipse_8 <- length(facto11vari_ipse_8)
n11_vari_ipse_9 <- length(facto11vari_ipse_9)
n11_vari_ipse_10 <- length(facto11vari_ipse_10)
n11_vari_ipse_11 <- length(facto11vari_ipse_11)

n11_vari_ipse <- n4_vari_ipse_1+n4_vari_ipse_2+n4_vari_ipse_3+n4_vari_ipse_4+n9_vari_ipse_5+n9_vari_ipse_6+n9_vari_ipse_7+n9_vari_ipse_8+n9_vari_ipse_9+n11_vari_ipse_10+n11_vari_ipse_11  

# Créer les scores factoriels
scores11_vari_ipse_1 <- facto11vari_ipse$scores[,1]
scores11_vari_ipse_2 <- facto11vari_ipse$scores[,2]
scores11_vari_ipse_3 <- facto11vari_ipse$scores[,3]
scores11_vari_ipse_4 <- facto11vari_ipse$scores[,4]
scores11_vari_ipse_5 <- facto11vari_ipse$scores[,5]
scores11_vari_ipse_6 <- facto11vari_ipse$scores[,6]
scores11_vari_ipse_7 <- facto11vari_ipse$scores[,7]
scores11_vari_ipse_8 <- facto11vari_ipse$scores[,8]
scores11_vari_ipse_9 <- facto11vari_ipse$scores[,9]
scores11_vari_ipse_10 <- facto11vari_ipse$scores[,10]
scores11_vari_ipse_11 <- facto11vari_ipse$scores[,11]
```

Le RMSEA est égal à `r facto11vari_ipseRMSEA`, le root mean square of the residuals (RMSR) est égal à `r facto11vari_ipsermsr` (de préférence < .08) et le Tucker Lewis Index est égal à `r facto11vari_ipseTLI`.
Le premier facteur explique `r facto11_1vari_ipse_variance` %, le deuxième explique `r facto11_2vari_ipse_variance` %, le troisième `r facto11_3vari_ipse_variance` %, le quatrième `r facto11_4vari_ipse_variance` %, le cinquième `r facto11_5vari_ipse_variance` % , le sixième `r facto11_6vari_ipse_variance` %, le septième `r facto11_7vari_ipse_variance` %, le huitième `r facto11_8vari_ipse_variance` %, le neuvième `r facto11_9vari_ipse_variance` %  de la variance totale pour une variance cumulée égale à `r facto11vari_ipse_variancecum` %.
Le premier facteur compte `r n9_vari_ipse_1` items, le deuxième `r n9_vari_ipse_2` items le troisième `r n9_vari_ipse_3` items, le quatrième `r n9_vari_ipse_4` items, le cinquième `r n9_vari_ipse_5` items, le sixième `r n9_vari_ipse_6` items, le septième `r n9_vari_ipse_7` items, le huitième `r n9_vari_ipse_8` items, le neuvième `r n9_vari_ipse_9` items pour un total de `r n9_vari_ipse` items.

### Facteur 1 : mistreated

```{r}
kable(facto11vari_ipse_1table_ord)

# L'alpha de Cronbach est égal à `r round(psych::alpha(factor2vari_ipse_1)$total$std.alpha, 2)`
```

### Facteur 2 : protective

```{r}
kable(facto11vari_ipse_2table_ord)
```

### Facteur 3 : anger

```{r}
kable(facto11vari_ipse_3table_ord)
```

### Facteur 4 : loss of professional distance

```{r}
kable(facto11vari_ipse_4table_ord)
```

### Facteur 5 : incompetencee

```{r}
kable(facto11vari_ipse_5table_ord)
```

### Facteur 6 : disengaged

```{r}
kable(facto11vari_ipse_6table_ord)
```

### Facteur 7 : distrust

```{r}
kable(facto11vari_ipse_7table_ord)
```

### Facteur 8 : overwhelmed

```{r}
kable(facto11vari_ipse_8table_ord)
```

### Facteur 9 : sexualized

```{r}
kable(facto11vari_ipse_9table_ord)
```

### Facteur 10 : need to disclose

```{r}
kable(facto11vari_ipse_10table_ord)
```

### Facteur 11 : jalousy

```{r}
kable(facto11vari_ipse_11table_ord)
```

## Comparaison des onze modèles vari_ipse


```{r include=FALSE}
comparaisonvari_ipse.df <- data.frame(
  Facteurs = c(1,2,3,4,5,6,7,8,9,10,11),
  RMSEA= c(facto1vari_ipseRMSEA,facto2vari_ipseRMSEA,facto3vari_ipseRMSEA,facto4vari_ipseRMSEA,facto5vari_ipseRMSEA,facto6vari_ipseRMSEA,facto7vari_ipseRMSEA,facto8vari_ipseRMSEA,facto9vari_ipseRMSEA,facto10vari_ipseRMSEA,facto11vari_ipseRMSEA),
  RMSR = c(facto1vari_ipsermsr,facto2vari_ipsermsr,facto3vari_ipsermsr,facto4vari_ipsermsr,facto5vari_ipsermsr,facto6vari_ipsermsr,facto7vari_ipsermsr,facto8vari_ipsermsr,facto9vari_ipsermsr,facto10vari_ipsermsr,facto11vari_ipsermsr),
  TLI = c(facto1vari_ipseTLI,facto2vari_ipseTLI,facto3vari_ipseTLI,facto4vari_ipseTLI,facto5vari_ipseTLI,facto6vari_ipseTLI,facto7vari_ipseTLI,facto8vari_ipseTLI,facto9vari_ipseTLI,facto10vari_ipseTLI,facto11vari_ipseTLI)
)
```

```{r comparaisonvari_ipse-tab, tidy=FALSE, echo = FALSE}
knitr::kable(
  comparaisonvari_ipse.df, caption = 'Comparaison des fits',
  booktabs = TRUE
)
```

```{r}
ggplot(comparaisonvari_ipse.df) +
 aes(x = Facteurs, y = RMSEA) +
 geom_point(shape = "circle", size = 4L, colour = "#112446") +
 labs(x = "Nombre de facteurs", y = "RMSEA", title = "RMSEA par nombre de facteurs") +
 scale_x_continuous(limits = c(0, 11), breaks = c(1,2,3,4,5,6,7,8,9,10,11)) +
 theme_classic() +
 ylim(0, 0.1)
```

```{r}
ggplot(comparaisonvari_ipse.df) +
 aes(x = Facteurs, y = RMSR) +
 geom_point(shape = "circle", size = 4L, colour = "#112446") +
 labs(x = "Nombre de facteurs", y = "RMSR", title = "RMSR par nombre de facteurs") +
 scale_x_continuous(limits = c(0, 11), breaks = c(1,2,3,4,5,6,7,8,9,10,11)) +
 theme_classic() +
 ylim(0, 0.15)
```

```{r}
ggplot(comparaisonvari_ipse.df) +
 aes(x = Facteurs, y = TLI) +
 geom_point(shape = "circle", size = 4L, colour = "#112446") +
 labs(x = "Nombre de facteurs", y = "Tucker Lewis Index", title = "Tucker Lewis Index par nombre de facteurs") +
 scale_x_continuous(limits = c(0, 11), breaks = c(1,2,3,4,5,6,7,8,9,10,11)) +
 theme_classic() +
 ylim(0, 1)
```


## Corrélations entre les facteurs avec variation vari_ipse pour les 11 niveaux

```{r}
# 8 niveaux

facto8_vari_ipse_scores.df <- data.frame(scores1_vari_ipse_1, scores2_vari_ipse_1, scores2_vari_ipse_2, scores3_vari_ipse_1, scores3_vari_ipse_2, scores3_vari_ipse_3, scores4_vari_ipse_1, scores4_vari_ipse_2, scores4_vari_ipse_3, scores4_vari_ipse_4, scores5_vari_ipse_1, scores5_vari_ipse_2, scores5_vari_ipse_3, scores5_vari_ipse_4, scores5_vari_ipse_5, scores6_vari_ipse_1, scores6_vari_ipse_2, scores6_vari_ipse_3, scores6_vari_ipse_4, scores6_vari_ipse_5, scores6_vari_ipse_6, scores7_vari_ipse_1, scores7_vari_ipse_2, scores7_vari_ipse_3, scores7_vari_ipse_4, scores7_vari_ipse_5, scores7_vari_ipse_6, scores7_vari_ipse_7, scores8_vari_ipse_1, scores8_vari_ipse_2, scores8_vari_ipse_3, scores8_vari_ipse_4, scores8_vari_ipse_5, scores8_vari_ipse_6, scores8_vari_ipse_7, scores8_vari_ipse_8)

facto8_vari_ipse_cor_scores <- round(cor(facto8_vari_ipse_scores.df, use = "complete.obs"),2)

# 11 niveaux

facto11_vari_ipse_scores.df <- data.frame(scores1_vari_ipse_1, scores2_vari_ipse_1, scores2_vari_ipse_2, scores3_vari_ipse_1, scores3_vari_ipse_2, scores3_vari_ipse_3, scores4_vari_ipse_1, scores4_vari_ipse_2, scores4_vari_ipse_3, scores4_vari_ipse_4, scores5_vari_ipse_1, scores5_vari_ipse_2, scores5_vari_ipse_3, scores5_vari_ipse_4, scores5_vari_ipse_5, scores6_vari_ipse_1, scores6_vari_ipse_2, scores6_vari_ipse_3, scores6_vari_ipse_4, scores6_vari_ipse_5, scores6_vari_ipse_6, scores7_vari_ipse_1, scores7_vari_ipse_2, scores7_vari_ipse_3, scores7_vari_ipse_4, scores7_vari_ipse_5, scores7_vari_ipse_6, scores7_vari_ipse_7, scores8_vari_ipse_1, scores8_vari_ipse_2, scores8_vari_ipse_3, scores8_vari_ipse_4, scores8_vari_ipse_5, scores8_vari_ipse_6, scores8_vari_ipse_7, scores8_vari_ipse_8, scores9_vari_ipse_1, scores9_vari_ipse_2, scores9_vari_ipse_3, scores9_vari_ipse_4, scores9_vari_ipse_5, scores9_vari_ipse_6, scores9_vari_ipse_7, scores9_vari_ipse_8,scores9_vari_ipse_9,scores10_vari_ipse_1, scores10_vari_ipse_2, scores10_vari_ipse_3, scores10_vari_ipse_4, scores10_vari_ipse_5, scores10_vari_ipse_6, scores10_vari_ipse_7, scores10_vari_ipse_8,scores10_vari_ipse_9,scores10_vari_ipse_10,scores11_vari_ipse_1, scores11_vari_ipse_2, scores11_vari_ipse_3, scores11_vari_ipse_4, scores11_vari_ipse_5, scores11_vari_ipse_6, scores11_vari_ipse_7, scores11_vari_ipse_8,scores11_vari_ipse_9,scores11_vari_ipse_10,scores11_vari_ipse_11)

facto11_vari_ipse_cor_scores <- round(cor(facto11_vari_ipse_scores.df, use = "complete.obs"),2)

#kable(facto8_vari_ipse_cor_scores)
 
# Créer un fichier excel avec les corrélations entre chaque facteur
wb_vari_ipse11 <- createWorkbook()
addWorksheet(wb_vari_ipse11, "Correlations")
writeData(wb_vari_ipse11, "Correlations", facto11_vari_ipse_cor_scores, rowNames = TRUE)
# saveWorkbook(wb_vari_ipse11, "correlationsfacto11vari_ipse.xlsx")
```

Ce [fichier excel](https://1drv.ms/x/s!AsF5FHJubO7zum2aP-vnrv97C5Xk?e=XwiBHU) présente la matrice de corrélations de tous les scores factoriels pour les 11 niveaux.

```{r}
detach(itemsipse.df)
```

# Congruence entre la modèle 11 varimax et le modèle 11 varimax ipsérisé

```{r}
#factor.congruence(facto11varimax,facto11vari_ipse)
factorcongruence.df <- as.data.frame(factor.congruence(facto11varimax,facto11vari_ipse))
kable(factorcongruence.df)
```


<!-- # Diagramme -->

```{r}
# mermaid("
# graph TD
# 
#     A[APEX] -->|.99| B(Neg CT)
# 
#     A --> C(Pos CT)
# 
#     B -->|.99| D(Neg CT)
# 
#     B -->|.63| E(Loss of neutrality boundaries)
# 
#     C -->|.97| F(Pos CT)
# 
#     D -->|.98| G(Neg CT)
# 
#     D -->|.77| H(Anger)
# 
#     E -->|.77| H
# 
#     E -->|.99| I(Loss of neutrality boundaries)
# 
#     F -->|.99| J(Pos CT)
# 
#     G -->|.95| K(Neg CT)
# 
#     G -->|.86| L(Bored-depressed)
# 
#     H --> M(Anger)
# 
#     I -->|.99| N(Loss of neutrality boundaries)
# 
#     J -->|.96| O(Pos CT)
# 
#     K -->|.99| P(Neg CT)
# 
#     L -->|.99| Q(Bored-depressed)
# 
#     M -->|.99| R(Anger)
# 
#     N -->|.55| S(Loss of neutrality boundaries)
# 
#     N -->|.91| T(Sexual tension)
# 
#     O -->|.99| U(Pos CT)
# 
#     P -->|.99| V(Neg CT)
# 
#     Q -->|.99| W(Bored-depressed)
# 
#     R -->|.99| X(Anger)
# 
#     S -->|.99| Y(Loss of neutrality boundaries)
# 
#     T -->|.66| Z(Sexual tension)
# 
#     T -->|.71| AA(Avoiding)
# 
#     U -->|.99| AB(Pos CT)
# 
#     V -->|.99| AC(Neg CT)
# 
#     W -->|.99| AD(Bored-depressed)
# 
#     V -->|.53| AE(Distrust)
# 
#     X -->|.97| AF(Anger)
# 
#     X -->|.66| AE
# 
#     Y -->|.99| AG(Loss of neutrality boundaries)
# 
#     Z -->|.99| AH(Sexual tension)
# 
#     AA -->|.99| AI(Avoiding)
# 
#     AB -->|.99| AJ(Pos CT)
# 
#     AC -->|.99| AK(Neg CT)
# 
#     AD -->|.99| AL(Bored-depressed)
# 
#     AD -->|.50| AM(Overly concerned)
# 
#     AE -->|.99| AN(Distrust)
# 
#     AF -->|.99| AO(Anger)
# 
#     AG -->|.95| AQ(Loss of neutrality boundaries)
# 
#     AG -->|.99| AM
# 
#     AH -->|.97| AS(Sexual tension)
# 
#     AI -->|.98| AT(Avoiding)
# 
#     AJ -->|.99| AU(Pos CT)
# 
#     AK -->|.99| AV(Neg CT)
# 
#     AL -->|.99| AW(Bored-depressed)
# 
#     AM -->|.77| AX(Overwhelmed)
# 
#     AN -->|.97| AY(Distrust)
# 
#     AO -->|.99| AZ(Anger)
# 
#     AQ -->|.99| BA(Loss of neutrality boundaries)
# 
#     AS -->|.99| BB(Sexual tension)
# 
#     AT -->|.99| BC(Avoiding)
# 
#     AT -->|.85| BD(Affected)
# 
#     AU -->|.99| BE(Pos CT)
# ")
```
